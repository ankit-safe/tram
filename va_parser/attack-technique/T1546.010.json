{
    "id": "T1546.010",
    "name": "AppInit DLLs",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by AppInit DLLs loaded into processes. Dynamic-link libraries (DLLs) that are specified in the <code>AppInit_DLLs</code> value in the Registry keys <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> or <code>HKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> are loaded by user32.dll into every process that loads user32.dll. In practice this is nearly every program, since user32.dll is a very common library. (Citation: Elastic Process Injection July 2017)\n\nSimilar to Process Injection, these values can be abused to obtain elevated privileges by causing a malicious DLL to be loaded and run in the context of separate processes on the computer. (Citation: AppInit Registry) Malicious AppInit DLLs may also provide persistence by continuously being triggered by API activity. \n\nThe AppInit DLL functionality is disabled in Windows 8 and later versions when secure boot is enabled. (Citation: AppInit Secure Boot)",
    "x_mitre_platforms": [
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1546/010",
            "external_id": "T1546.010"
        },
        {
            "source_name": "Elastic Process Injection July 2017",
            "description": "Hosseini, A. (2017, July 18). Ten Process Injection Techniques: A Technical Survey Of Common And Trending Process Injection Techniques. Retrieved December 7, 2017.",
            "url": "https://www.endgame.com/blog/technical-blog/ten-process-injection-techniques-technical-survey-common-and-trending-process"
        },
        {
            "source_name": "AppInit Registry",
            "description": "Microsoft. (2006, October). Working with the AppInit_DLLs registry value. Retrieved July 15, 2015.",
            "url": "https://support.microsoft.com/en-us/kb/197571"
        },
        {
            "source_name": "AppInit Secure Boot",
            "description": "Microsoft. (n.d.). AppInit DLLs and Secure Boot. Retrieved July 15, 2015.",
            "url": "https://msdn.microsoft.com/en-us/library/dn280412"
        },
        {
            "source_name": "TechNet Autoruns",
            "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.",
            "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "privilege-escalation"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "persistence"
        }
    ],
    "tactic": [
        "privilege-escalation",
        "persistence"
    ],
    "x_mitre_detection": "Monitor DLL loads by processes that load user32.dll and look for DLLs that are not recognized or not normally loaded into a process. Monitor the AppInit_DLLs Registry values for modifications that do not correlate with known software, patch cycles, etc. Monitor and analyze application programming interface (API) calls that are indicative of Registry edits such as <code>RegCreateKeyEx</code> and <code>RegSetValueEx</code>. (Citation: Elastic Process Injection July 2017)\n\nTools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing current AppInit DLLs. (Citation: TechNet Autoruns) \n\nLook for abnormal process behavior that may be due to a process loading a malicious DLL. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as making network connections for Command and Control, learning details about the environment through Discovery, and conducting Lateral Movement.",
    "x_mitre_data_sources": [
        "Module: Module Load",
        "Windows Registry: Windows Registry Key Modification",
        "Command: Command Execution",
        "Process: OS API Execution",
        "Process: Process Creation"
    ],
    "x_mitre_permissions_required": [
        "Administrator"
    ],
    "x_mitre_effective_permissions": [
        "Administrator",
        "SYSTEM"
    ],
    "x_mitre_system_requirements": [
        "Secure boot disabled on systems running Windows 8 and later"
    ],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Execution Prevention",
                "description": "Block execution of code on a system through application control, and/or script blocking.",
                "type": "course-of-action",
                "id": "M1038"
            },
            {
                "name": "Update Software",
                "description": "Perform regular software updates to mitigate exploitation risk.",
                "type": "course-of-action",
                "id": "M1051"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that application whitelisting tools are configured to Identify and block potentially malicious software executed through AppInitDLLs functionality",
                "acid": "98580697"
            },
            {
                "description": "Ensure that Software Restriction Policies are implemented to Identify and block potentially malicious software executed through AppInitDLLs functionality",
                "acid": "98580698"
            },
            {
                "description": "Ensure that Windows Defender Application Control is configured to identify and block potentially malicious software executed through AppInitDLLs functionality",
                "acid": "98580699"
            },
            {
                "description": "Ensure that AppLocker is configured to identify and block potentially malicious software executed through AppInitDLLs functionality",
                "acid": "98580700"
            },
            {
                "description": "Ensure that OS is upgraded to Windows 8 or later and enable secure boot",
                "acid": "98580701"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that DLL Loads by processes are monitored for unrecognized or unfamiliar DLL loads",
                "acid": "98580692"
            },
            {
                "description": "Ensure that processes loading user32.dll are monitored for abnormal activity",
                "acid": "98580693"
            },
            {
                "description": "Ensure that changes to AppInit DLLs Registry value that does not correlate with known software, patch cycles are monitored",
                "acid": "98580694"
            },
            {
                "description": "Ensure that API calls for registry edits are monitored and analyzed",
                "acid": "98580695"
            },
            {
                "description": "Ensure that process loading DLLs must be monitored for malicious DLLs",
                "acid": "98580696"
            }
        ]
    },
    "cspcontrolIds": [
        "40000117",
        "40000521",
        "40000522"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [],
    "technologycontrolIds": [],
    "cveIds": []
}
