{
    "id": "T1078.002",
    "name": "Domain Accounts",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may obtain and abuse credentials of a domain account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.(Citation: TechNet Credential Theft) Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover users, administrators, and services.(Citation: Microsoft AD Accounts)\n\nAdversaries may compromise domain accounts, some with a high level of privileges, through various means such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) or password reuse, allowing access to privileged resources of the domain.",
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1078/002",
            "external_id": "T1078.002"
        },
        {
            "source_name": "TechNet Credential Theft",
            "description": "Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016.",
            "url": "https://technet.microsoft.com/en-us/library/dn535501.aspx"
        },
        {
            "source_name": "TechNet Audit Policy",
            "description": "Microsoft. (2016, April 15). Audit Policy Recommendations. Retrieved June 3, 2016.",
            "url": "https://technet.microsoft.com/en-us/library/dn487457.aspx"
        },
        {
            "source_name": "Microsoft AD Accounts",
            "description": "Microsoft. (2019, August 23). Active Directory Accounts. Retrieved March 13, 2020.",
            "url": "https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/active-directory-accounts"
        },
        {
            "source_name": "Ubuntu SSSD Docs",
            "description": "Ubuntu. (n.d.). SSSD. Retrieved September 23, 2021.",
            "url": "https://ubuntu.com/server/docs/service-sssd"
        },
        {
            "source_name": "capec",
            "url": "https://capec.mitre.org/data/definitions/560.html",
            "external_id": "CAPEC-560"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "defense-evasion"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "persistence"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "privilege-escalation"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "initial-access"
        }
    ],
    "tactic": [
        "defense-evasion",
        "persistence",
        "privilege-escalation",
        "initial-access"
    ],
    "x_mitre_detection": "Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services.(Citation: TechNet Audit Policy) Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).\n\nOn Linux, check logs and other artifacts created by use of domain authentication services, such as the System Security Services Daemon (sssd).(Citation: Ubuntu SSSD Docs) \n\nPerform regular audits of domain accounts to detect accounts that may have been created by an adversary for persistence.",
    "x_mitre_data_sources": [
        "User Account: User Account Authentication",
        "Logon Session: Logon Session Metadata",
        "Logon Session: Logon Session Creation"
    ],
    "x_mitre_permissions_required": [
        "User",
        "Administrator"
    ],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Multi-factor Authentication",
                "description": "Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.",
                "type": "course-of-action",
                "id": "M1032"
            },
            {
                "name": "Privileged Account Management",
                "description": "Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.",
                "type": "course-of-action",
                "id": "M1026"
            },
            {
                "name": "User Training",
                "description": "Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.",
                "type": "course-of-action",
                "id": "M1017"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that MFA is implemented to restrict access to cloud resources and APIs",
                "acid": "98580126"
            },
            {
                "description": "Ensure that domain account permission levels are audited regularly to identify suspicious behavior",
                "acid": "98580127"
            },
            {
                "description": "Ensure that user or admin domain accounts are not kept in the local administrator groups across systems",
                "acid": "98580128"
            },
            {
                "description": "Ensure that best practices are followed for the design and administration of an enterprise network to limit privileged account use",
                "acid": "98580129"
            },
            {
                "description": "Ensure that credential overlap(same password for multiple accounts ) across systems is limited",
                "acid": "98580130"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that robust and consistent account activity audit policies are configured across the enterprise and with externally accessible services",
                "acid": "98580119"
            },
            {
                "description": "Ensure that systems sharing user, admin, or service accounts should be monitored for suspicious account behavior",
                "acid": "98580120"
            },
            {
                "description": "Ensure that an account should be monitored if logged into multiple systems simultaneously",
                "acid": "98580121"
            },
            {
                "description": "Ensure that behavior for multiple accounts logged into the same machine simultaneously is monitored",
                "acid": "98580122"
            },
            {
                "description": "Ensure that accounts should be monitored if logged in at odd times or outside of business hours",
                "acid": "98580123"
            },
            {
                "description": "Ensure that security systems (other) are correlated with login information to detect suspicious activity.",
                "acid": "98580124"
            },
            {
                "description": "Ensure that regular audits are performed for domain system accounts to detect accounts created by adversaries",
                "acid": "98580125"
            }
        ]
    },
    "cspcontrolIds": [
        "40000205",
        "40000499",
        "40000509"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [
        "PACR00001"
    ],
    "policycontrolIds": [
        "50100283",
        "50100568",
        "50101185",
        "50101970",
        "50102686",
        "50104298"
    ],
    "technologycontrolIds": [
        "11470009",
        "11470013",
        "11470015",
        "11480001",
        "11480003",
        "11480005",
        "14050032",
        "14050033",
        "14110034",
        "14110035",
        "14120040",
        "14120041",
        "14130030",
        "14130031",
        "14170041",
        "14170042",
        "15010064",
        "15020065",
        "15030065",
        "15040130",
        "15180060",
        "15200064",
        "16010068",
        "16020068",
        "16100069",
        "16110068",
        "16120069",
        "16140060",
        "16360070",
        "16460068",
        "16460395",
        "18380011",
        "18410015",
        "18410016",
        "18410017",
        "18550003",
        "18640005",
        "19920415",
        "19920444"
    ],
    "cveIds": []
}
