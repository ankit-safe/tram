{
    "id": "T1552.004",
    "name": "Private Keys",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may search for private key certificate files on compromised systems for insecurely stored credentials. Private cryptographic keys and certificates are used for authentication, encryption/decryption, and digital signatures.(Citation: Wikipedia Public Key Crypto) Common key and certificate file extensions include: .key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc. \n\nAdversaries may also look in common key directories, such as <code>~/.ssh</code> for SSH keys on * nix-based systems or <code>C:&#92;Users&#92;(username)&#92;.ssh&#92;</code> on Windows. These private keys can be used to authenticate to [Remote Services](https://attack.mitre.org/techniques/T1021) like SSH or for use in decrypting other collected files such as email.\n\nAdversary tools have been discovered that search compromised systems for file extensions relating to cryptographic keys and certificates.(Citation: Kaspersky Careto)(Citation: Palo Alto Prince of Persia)\n\nSome private keys require a password or passphrase for operation, so an adversary may also use [Input Capture](https://attack.mitre.org/techniques/T1056) for keylogging or attempt to [Brute Force](https://attack.mitre.org/techniques/T1110) the passphrase off-line.",
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1552/004",
            "external_id": "T1552.004"
        },
        {
            "source_name": "Wikipedia Public Key Crypto",
            "description": "Wikipedia. (2017, June 29). Public-key cryptography. Retrieved July 5, 2017.",
            "url": "https://en.wikipedia.org/wiki/Public-key_cryptography"
        },
        {
            "source_name": "Kaspersky Careto",
            "description": "Kaspersky Labs. (2014, February 11). Unveiling \u201cCareto\u201d - The Masked APT. Retrieved July 5, 2017.",
            "url": "https://kasperskycontenthub.com/wp-content/uploads/sites/43/vlpdfs/unveilingthemask_v1.0.pdf"
        },
        {
            "source_name": "Palo Alto Prince of Persia",
            "description": "Bar, T., Conant, S., Efraim, L. (2016, June 28). Prince of Persia \u2013 Game Over. Retrieved July 5, 2017.",
            "url": "https://researchcenter.paloaltonetworks.com/2016/06/unit42-prince-of-persia-game-over/"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "credential-access"
        }
    ],
    "tactic": [
        "credential-access"
    ],
    "x_mitre_detection": "Monitor access to files and directories related to cryptographic keys and certificates as a means for potentially detecting access patterns that may indicate collection and exfiltration activity. Collect authentication logs and look for potentially abnormal activity that may indicate improper use of keys or certificates for remote authentication.",
    "x_mitre_data_sources": [
        "Command: Command Execution",
        "File: File Access"
    ],
    "x_mitre_permissions_required": [
        "User"
    ],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Password Policies",
                "description": "Set and enforce secure password policies for accounts.",
                "type": "course-of-action",
                "id": "M1027"
            },
            {
                "name": "Restrict File and Directory Permissions",
                "description": "Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.",
                "type": "course-of-action",
                "id": "M1022"
            },
            {
                "name": "Private Keys Mitigation",
                "description": "Use strong passphrases for private keys to make cracking difficult. When possible, store keys on separate cryptographic hardware instead of on the local system. Ensure only authorized keys are allowed access to critical resources and audit access lists regularly. Ensure permissions are properly set on folders containing sensitive private keys to prevent unintended access. Use separate infrastructure for managing critical systems to prevent overlap of credentials and permissions on systems that could be used as vectors for lateral movement. Follow other best practices for mitigating access through use of [Valid Accounts](https://attack.mitre.org/techniques/T1078).",
                "type": "course-of-action",
                "id": "T1145"
            },
            {
                "name": "Audit",
                "description": "Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.",
                "type": "course-of-action",
                "id": "M1047"
            },
            {
                "name": "Encrypt Sensitive Information",
                "description": "Protect sensitive information with strong encryption.",
                "type": "course-of-action",
                "id": "M1041"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that only authorized keys are allowed access to critical resources.",
                "acid": "98582082"
            },
            {
                "description": "Ensure that access lists are audited regularly.",
                "acid": "98582083"
            },
            {
                "description": "Ensure that keys are stored on separate cryptographic hardware instead of on the local system.",
                "acid": "98582084"
            },
            {
                "description": "Ensure that strong passphrases are used for private keys to make cracking difficult.",
                "acid": "98582085"
            },
            {
                "description": "Ensure that permissions are properly set on folders containing sensitive private keys to prevent unintended access.",
                "acid": "98582086"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that access to files and directories related to cryptographic keys and certificates are monitored to detect access patterns indicating collection and exfiltration activity.",
                "acid": "98582080"
            },
            {
                "description": "Ensure that authentication logs are collected and inspected for suspicious activity indicating improper use of keys or certificates for remote authentication.",
                "acid": "98582081"
            }
        ]
    },
    "cspcontrolIds": [],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [
        "50100280",
        "50100301",
        "50100302",
        "50100556",
        "50101814"
    ],
    "technologycontrolIds": [
        "11480006",
        "11480009",
        "11480012",
        "11480013",
        "11480015",
        "16460380",
        "18330005",
        "18330006",
        "18330007",
        "18330008",
        "18330009",
        "18330010",
        "18400001",
        "18890001",
        "18900001",
        "19360003",
        "19360004",
        "19360005",
        "19360006",
        "19390001",
        "19480001",
        "19540001",
        "19540002",
        "19920464"
    ],
    "cveIds": [
        "CVE-2018-7506"
    ]
}
