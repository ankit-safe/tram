{
    "id": "T1059.001",
    "name": "PowerShell",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may abuse PowerShell commands and scripts for execution. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system.(Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the <code>Start-Process</code> cmdlet which can be used to run an executable and the <code>Invoke-Command</code> cmdlet which runs a command locally or on a remote computer (though administrator permissions are required to use PowerShell to connect to remote systems).\n\nPowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.\n\nA number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363),  [PowerSploit](https://attack.mitre.org/software/S0194), [PoshC2](https://attack.mitre.org/software/S0378), and PSAttack.(Citation: Github PSAttack)\n\nPowerShell commands/scripts can also be executed without directly invoking the <code>powershell.exe</code> binary through interfaces to PowerShell's underlying <code>System.Management.Automation</code> assembly DLL exposed through the .NET framework and Windows Common Language Interface (CLI).(Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)(Citation: Microsoft PSfromCsharp APR 2014)",
    "x_mitre_platforms": [
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1059/001",
            "external_id": "T1059.001"
        },
        {
            "source_name": "Microsoft PSfromCsharp APR 2014",
            "description": "Babinec, K. (2014, April 28). Executing PowerShell scripts from C#. Retrieved April 22, 2019.",
            "url": "https://blogs.msdn.microsoft.com/kebab/2014/04/28/executing-powershell-scripts-from-c/"
        },
        {
            "source_name": "SilentBreak Offensive PS Dec 2015",
            "description": "Christensen, L.. (2015, December 28). The Evolution of Offensive PowerShell Invocation. Retrieved December 8, 2018.",
            "url": "https://silentbreaksecurity.com/powershell-jobs-without-powershell-exe/"
        },
        {
            "source_name": "FireEye PowerShell Logging 2016",
            "description": "Dunwoody, M. (2016, February 11). GREATER VISIBILITY THROUGH POWERSHELL LOGGING. Retrieved February 16, 2016.",
            "url": "https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html"
        },
        {
            "source_name": "Github PSAttack",
            "description": "Haight, J. (2016, April 21). PS>Attack. Retrieved June 1, 2016.",
            "url": "https://github.com/jaredhaight/PSAttack"
        },
        {
            "source_name": "inv_ps_attacks",
            "description": "Hastings, M. (2014, July 16). Investigating PowerShell Attacks. Retrieved December 1, 2021.",
            "url": "https://powershellmagazine.com/2014/07/16/investigating-powershell-attacks/"
        },
        {
            "source_name": "Malware Archaeology PowerShell Cheat Sheet",
            "description": "Malware Archaeology. (2016, June). WINDOWS POWERSHELL LOGGING CHEAT SHEET - Win 7/Win 2008 or later. Retrieved June 24, 2016.",
            "url": "http://www.malwarearchaeology.com/s/Windows-PowerShell-Logging-Cheat-Sheet-ver-June-2016-v2.pdf"
        },
        {
            "source_name": "TechNet PowerShell",
            "description": "Microsoft. (n.d.). Windows PowerShell Scripting. Retrieved April 28, 2016.",
            "url": "https://technet.microsoft.com/en-us/scriptcenter/dd742419.aspx"
        },
        {
            "source_name": "Sixdub PowerPick Jan 2016",
            "description": "Warner, J.. (2015, January 6). Inexorable PowerShell \u2013 A Red Teamer\u2019s Tale of Overcoming Simple AppLocker Policies. Retrieved December 8, 2018.",
            "url": "http://www.sixdub.net/?p=367"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "execution"
        }
    ],
    "tactic": [
        "execution"
    ],
    "x_mitre_detection": "If proper execution policy is set, adversaries will likely be able to define their own execution policy if they obtain administrator or system access, either through the Registry or at the command line. This change in policy on a system may be a way to detect malicious use of PowerShell. If PowerShell is not used in an environment, then simply looking for PowerShell execution may detect malicious activity.\n\nMonitor for loading and/or execution of artifacts associated with PowerShell specific assemblies, such as System.Management.Automation.dll (especially to unusual process names/locations).(Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)\n\nIt is also beneficial to turn on PowerShell logging to gain increased fidelity in what occurs during execution (which is applied to .NET invocations). (Citation: Malware Archaeology PowerShell Cheat Sheet) PowerShell 5.0 introduced enhanced logging capabilities, and some of those features have since been added to PowerShell 4.0. Earlier versions of PowerShell do not have many logging features.(Citation: FireEye PowerShell Logging 2016) An organization can gather PowerShell execution details in a data analytic platform to supplement it with other data.\n\nConsider monitoring for Windows event ID (EID) 400, which shows the version of PowerShell executing in the <code>EngineVersion</code> field (which may also be relevant to detecting a potential [Downgrade Attack](https://attack.mitre.org/techniques/T1562/010)) as well as if PowerShell is running locally or remotely in the <code>HostName</code> field. Furthermore, EID 400 may indicate the start time and EID 403 indicates the end time of a PowerShell session.(Citation: inv_ps_attacks)",
    "x_mitre_data_sources": [
        "Module: Module Load",
        "Process: Process Metadata",
        "Process: Process Creation",
        "Script: Script Execution",
        "Command: Command Execution"
    ],
    "x_mitre_permissions_required": [],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": true,
    "relation": {
        "mitigates": [
            {
                "name": "Disable or Remove Feature or Program",
                "description": "Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.",
                "type": "course-of-action",
                "id": "M1042"
            },
            {
                "name": "Antivirus/Antimalware",
                "description": "Use signatures or heuristics to detect malicious software.",
                "type": "course-of-action",
                "id": "M1049"
            },
            {
                "name": "Code Signing",
                "description": "Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.",
                "type": "course-of-action",
                "id": "M1045"
            },
            {
                "name": "Privileged Account Management",
                "description": "Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.",
                "type": "course-of-action",
                "id": "M1026"
            },
            {
                "name": "Execution Prevention",
                "description": "Block execution of code on a system through application control, and/or script blocking.",
                "type": "course-of-action",
                "id": "M1038"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that Anti-virus solutions are configured to automatically quarantine suspicious files",
                "acid": "98580162"
            },
            {
                "description": "Ensure that the PowerShell execution policy is configured to execute only signed scripts",
                "acid": "98580163"
            },
            {
                "description": "Ensure that PowerShell from systems is removed is it is not required for any legitimate purposes and administrative functions",
                "acid": "98580164"
            },
            {
                "description": "Ensure that the WinRM Service is disabled/restricted to prevent uses of PowerShell for remote execution",
                "acid": "98580165"
            },
            {
                "description": "Ensure that the PowerShell execution policy is restricted to administrators for making changes",
                "acid": "98580166"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that change in execution policy on a system is monitored to detect malicious use of PowerShell",
                "acid": "98580157"
            },
            {
                "description": "Ensure that PowerShell execution in an environment where it is not required should be monitored",
                "acid": "98580158"
            },
            {
                "description": "Ensure that loading and/or execution of artifacts associated with PowerShell specific assemblies is monitored",
                "acid": "98580159"
            },
            {
                "description": "Ensure that loading and/or execution of artifacts associated with System.Management.Automation.dll is monitored for unusual process names/locations",
                "acid": "98580160"
            },
            {
                "description": "Ensure that the logging feature for PowerShell is enabled to gather execution event details",
                "acid": "98580161"
            }
        ]
    },
    "cspcontrolIds": [
        "40000205",
        "40000499"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [
        "50100523",
        "50101358"
    ],
    "technologycontrolIds": [
        "16010479",
        "16020489",
        "16100531",
        "16110466",
        "16120484",
        "16460389",
        "16460390",
        "16460391",
        "19920418",
        "19920419",
        "19920451",
        "19920497"
    ],
    "cveIds": [
        "CVE-2014-0295"
    ]
}
