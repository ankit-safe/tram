{
    "id": "T1562.001",
    "name": "Disable or Modify Tools",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems.(Citation: SCADAfence_ransomware)\n\nAdversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls)\n\nIn cloud environments, tools disabled by adversaries may include cloud monitoring agents that report back to services such as AWS CloudWatch or Google Cloud Monitor.\n\nFurthermore, although defensive tools may have anti-tampering mechanisms, adversaries may abuse tools such as legitimate rootkit removal kits to impair and/or disable these tools.(Citation: chasing_avaddon_ransomware)(Citation: dharma_ransomware)(Citation: demystifying_ryuk)(Citation: doppelpaymer_crowdstrike) For example, adversaries have used tools such as GMER to find and shut down hidden processes and antivirus software on infected systems.(Citation: demystifying_ryuk)\n\nAdditionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to kernel space (i.e. [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)), which may lead to bypassing anti-tampering features.(Citation: avoslocker_ransomware)",
    "x_mitre_platforms": [
        "Windows",
        "macOS",
        "Linux",
        "Containers",
        "IaaS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [
        "Anti-virus",
        "Log analysis",
        "Signature-based detection",
        "Host intrusion prevention systems",
        "File monitoring"
    ],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1562/001",
            "external_id": "T1562.001"
        },
        {
            "source_name": "OutFlank System Calls",
            "description": "de Plaa, C. (2019, June 19). Red Team Tactics: Combining Direct System Calls and sRDI to bypass AV/EDR. Retrieved September 29, 2021.",
            "url": "https://outflank.nl/blog/2019/06/19/red-team-tactics-combining-direct-system-calls-and-srdi-to-bypass-av-edr/"
        },
        {
            "source_name": "chasing_avaddon_ransomware",
            "description": "Hernandez, A. S. Tarter, P. Ocamp, E. J. (2022, January 19). One Source to Rule Them All: Chasing AVADDON Ransomware. Retrieved January 26, 2022.",
            "url": "https://www.mandiant.com/resources/chasing-avaddon-ransomware"
        },
        {
            "source_name": "doppelpaymer_crowdstrike",
            "description": "Hurley, S. (2021, December 7). Critical Hit: How DoppelPaymer Hunts and Kills Windows Processes. Retrieved January 26, 2022.",
            "url": "https://www.crowdstrike.com/blog/how-doppelpaymer-hunts-and-kills-windows-processes/"
        },
        {
            "source_name": "avoslocker_ransomware",
            "description": "Lakshmanan, R. (2022, May 2). AvosLocker Ransomware Variant Using New Trick to Disable Antivirus Protection. Retrieved May 17, 2022.",
            "url": "https://thehackernews.com/2022/05/avoslocker-ransomware-variant-using-new.html"
        },
        {
            "source_name": "dharma_ransomware",
            "description": "Loui, E. Scheuerman, K. et al. (2020, April 16). Targeted Dharma Ransomware Intrusions Exhibit Consistent Techniques. Retrieved January 26, 2022.",
            "url": "https://www.crowdstrike.com/blog/targeted-dharma-ransomware-intrusions-exhibit-consistent-techniques/"
        },
        {
            "source_name": "MDSec System Calls",
            "description": "MDSec Research. (2020, December). Bypassing User-Mode Hooks and Direct Invocation of System Calls for Red Teams. Retrieved September 29, 2021.",
            "url": "https://www.mdsec.co.uk/2020/12/bypassing-user-mode-hooks-and-direct-invocation-of-system-calls-for-red-teams/"
        },
        {
            "source_name": "SCADAfence_ransomware",
            "description": "Shaked, O. (2020, January 20). Anatomy of a Targeted Ransomware Attack. Retrieved June 18, 2022.",
            "url": "https://cdn.logic-control.com/docs/scadafence/Anatomy-Of-A-Targeted-Ransomware-Attack-WP.pdf"
        },
        {
            "source_name": "demystifying_ryuk",
            "description": "Tran, T. (2020, November 24). Demystifying Ransomware Attacks Against Microsoft Defender Solution. Retrieved January 26, 2022.",
            "url": "https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/demystifying-ransomware-attacks-against-microsoft-defender/ba-p/1928947"
        },
        {
            "source_name": "capec",
            "url": "https://capec.mitre.org/data/definitions/578.html",
            "external_id": "CAPEC-578"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "defense-evasion"
        }
    ],
    "tactic": [
        "defense-evasion"
    ],
    "x_mitre_detection": "Monitor processes and command-line arguments to see if security tools/services are killed or stop running. Monitor Registry edits for modifications to services and startup programs that correspond to security tools. Monitoring for changes to other known features used by deployed security tools may also expose malicious activity.\n\nLack of expected log events may be suspicious.",
    "x_mitre_data_sources": [
        "Process: Process Termination",
        "Sensor Health: Host Status",
        "Windows Registry: Windows Registry Key Modification",
        "Driver: Driver Load",
        "Windows Registry: Windows Registry Key Deletion",
        "Service: Service Metadata",
        "Command: Command Execution"
    ],
    "x_mitre_permissions_required": [],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Execution Prevention",
                "description": "Block execution of code on a system through application control, and/or script blocking.",
                "type": "course-of-action",
                "id": "M1038"
            },
            {
                "name": "Restrict Registry Permissions",
                "description": "Restrict the ability to modify certain hives or keys in the Windows Registry.",
                "type": "course-of-action",
                "id": "M1024"
            },
            {
                "name": "User Account Management",
                "description": "Manage the creation, modification, use, and permissions associated to user accounts.",
                "type": "course-of-action",
                "id": "M1018"
            },
            {
                "name": "Restrict File and Directory Permissions",
                "description": "Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.",
                "type": "course-of-action",
                "id": "M1022"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that process permissions are properly implemented to prevent disabling of security/logging services.",
                "acid": "98581280"
            },
            {
                "description": "Ensure that file permissions are properly implemented to prevent disabling of security/logging services.",
                "acid": "98581281"
            },
            {
                "description": "Ensure that Registry permissions are properly implemented to prevent disabling or interfering with security/logging services.",
                "acid": "98581282"
            },
            {
                "description": "Ensure that user permissions are properly implemented to prevent disabling or interfering with security/logging services.",
                "acid": "98581283"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that processes are monitored to check if security tools/services are killed or stop running.",
                "acid": "98581275"
            },
            {
                "description": "Ensure that command-line arguments are monitored to check if logging services are killed or stop running.",
                "acid": "98581276"
            },
            {
                "description": "Ensure that Registry edits are monitored for any modifications related to security tools services.",
                "acid": "98581277"
            },
            {
                "description": "Ensure that Registry edits are monitored for any modifications to startup programs related to security tools.",
                "acid": "98581278"
            },
            {
                "description": "Ensure that service-related log events are present and not deleted from the system.",
                "acid": "98581279"
            }
        ]
    },
    "cspcontrolIds": [
        "40000097",
        "40000490"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [],
    "technologycontrolIds": [
        "14010007",
        "14010037",
        "14010039",
        "14020025",
        "14020031",
        "14020086",
        "14020096",
        "14030037",
        "14030038",
        "14030039",
        "14030040",
        "14030041",
        "14030042",
        "14030043",
        "14030044",
        "14030045",
        "14030046",
        "14030047",
        "14030048",
        "14030049",
        "14030050",
        "14030051",
        "14030052",
        "14030053",
        "14030054",
        "14030055",
        "14030056",
        "14030057",
        "14030058",
        "14030059",
        "14030060",
        "14030061",
        "14030062",
        "14030063",
        "14030064",
        "14030065",
        "14030066",
        "14030067",
        "14030068",
        "14030069",
        "14030070",
        "14030072",
        "14030074",
        "14030075",
        "14030076",
        "14030077",
        "14030078",
        "14030079",
        "14030080",
        "14030081",
        "14030082",
        "14030083",
        "14030084",
        "14030085",
        "14030086",
        "14030087",
        "14030089",
        "14030090",
        "14030093",
        "14030096",
        "14030097",
        "14030101",
        "14030102",
        "14030103",
        "14030104",
        "14030105",
        "14030106",
        "14030107",
        "14030108",
        "14030109",
        "14030110",
        "14030111",
        "14030112",
        "14030113",
        "14030114",
        "14030115",
        "14030116",
        "14030118",
        "14030119",
        "14030120",
        "14030121",
        "14030122",
        "14040037",
        "14040038",
        "14040039",
        "14040040",
        "14040041",
        "14040042",
        "14040043",
        "14040044",
        "14040045",
        "14040046",
        "14040047",
        "14040048",
        "14040049",
        "14040050",
        "14040051",
        "14040052",
        "14040053",
        "14040054",
        "14040055",
        "14040056",
        "14040057",
        "14040058",
        "14040059",
        "14040060",
        "14040061",
        "14040062",
        "14040063",
        "14040064",
        "14040065",
        "14040066",
        "14040067",
        "14040068",
        "14040069",
        "14040070",
        "14040071",
        "14040072",
        "14040074",
        "14040075",
        "14040076",
        "14040077",
        "14040078",
        "14040079",
        "14040080",
        "14040081",
        "14040082",
        "14040083",
        "14040084",
        "14040085",
        "14040086",
        "14040087",
        "14040089",
        "14040090",
        "14040096",
        "14040097",
        "14040101",
        "14040102",
        "14040103",
        "14040104",
        "14040105",
        "14040106",
        "14040107",
        "14040108",
        "14040109",
        "14040110",
        "14040111",
        "14040112",
        "14040113",
        "14040114",
        "14040115",
        "14040116",
        "14040118",
        "14040119",
        "14040120",
        "14040121",
        "14040122",
        "14040123",
        "14040124",
        "14040125",
        "14040126",
        "14040127",
        "14040128",
        "14040129",
        "14040130",
        "14040131",
        "14040132",
        "14040133",
        "14040134",
        "14040135",
        "14040136",
        "14040137",
        "14040138",
        "14040139",
        "14040141",
        "14040146",
        "14040147",
        "14040148",
        "14040149",
        "14050029",
        "14050031",
        "14050034",
        "14080034",
        "14080039",
        "14080045",
        "14080047",
        "14080070",
        "14080071",
        "14080072",
        "14080073",
        "14080074",
        "14080075",
        "14110029",
        "14110033",
        "14110036",
        "14120033",
        "14120039",
        "14120042",
        "14130029",
        "14130032",
        "14130043",
        "14170036",
        "14170040",
        "14170043",
        "16410043",
        "16410044",
        "16410045",
        "16410046",
        "16410047",
        "16410048",
        "16410049",
        "16410050",
        "16410051",
        "16410052",
        "16410053",
        "16410054",
        "16410055",
        "16410056",
        "16410057",
        "16410058",
        "16410059",
        "16410060",
        "16410061",
        "16410062",
        "16410063",
        "16410064",
        "16410065",
        "16410066",
        "16410067",
        "16410068",
        "16410069",
        "16410070",
        "16410071",
        "16410072",
        "16410073",
        "16410102",
        "16410103",
        "16410104",
        "16420047",
        "16420048",
        "16420049",
        "16420050",
        "16420051",
        "16420052",
        "16420053",
        "16420054",
        "16420055",
        "16420056",
        "16420057",
        "16420058",
        "16420059",
        "16420060",
        "16420061",
        "16420062",
        "16420063",
        "16420064",
        "16420065",
        "16420066",
        "16420067",
        "16420068",
        "16420069",
        "16420070",
        "16420071",
        "16420072",
        "16420073",
        "16420074",
        "16420075",
        "16420076",
        "16420077",
        "16420096",
        "16420097",
        "16420098"
    ],
    "cveIds": []
}
