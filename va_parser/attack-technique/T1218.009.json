{
    "id": "T1218.009",
    "name": "Regsvcs/Regasm",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may abuse Regsvcs and Regasm to proxy execution of code through a trusted Windows utility. Regsvcs and Regasm are Windows command-line utilities that are used to register .NET [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) assemblies. Both are binaries that may be digitally signed by Microsoft. (Citation: MSDN Regsvcs) (Citation: MSDN Regasm)\n\nBoth utilities may be used to bypass application control through use of attributes within the binary to specify code that should be run before registration or unregistration: <code>[ComRegisterFunction]</code> or <code>[ComUnregisterFunction]</code> respectively. The code with the registration and unregistration attributes will be executed even if the process is run under insufficient privileges and fails to execute. (Citation: LOLBAS Regsvcs)(Citation: LOLBAS Regasm)",
    "x_mitre_platforms": [
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [
        "Digital Certificate Validation",
        "Application control"
    ],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1218/009",
            "external_id": "T1218.009"
        },
        {
            "source_name": "MSDN Regsvcs",
            "description": "Microsoft. (n.d.). Regsvcs.exe (.NET Services Installation Tool). Retrieved July 1, 2016.",
            "url": "https://msdn.microsoft.com/en-us/library/04za0hca.aspx"
        },
        {
            "source_name": "MSDN Regasm",
            "description": "Microsoft. (n.d.). Regasm.exe (Assembly Registration Tool). Retrieved July 1, 2016.",
            "url": "https://msdn.microsoft.com/en-us/library/tzat5yw6.aspx"
        },
        {
            "source_name": "LOLBAS Regsvcs",
            "description": "LOLBAS. (n.d.). Regsvcs.exe. Retrieved July 31, 2019.",
            "url": "https://lolbas-project.github.io/lolbas/Binaries/Regsvcs/"
        },
        {
            "source_name": "LOLBAS Regasm",
            "description": "LOLBAS. (n.d.). Regasm.exe. Retrieved July 31, 2019.",
            "url": "https://lolbas-project.github.io/lolbas/Binaries/Regasm/"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "defense-evasion"
        }
    ],
    "tactic": [
        "defense-evasion"
    ],
    "x_mitre_detection": "Use process monitoring to monitor the execution and arguments of Regsvcs.exe and Regasm.exe. Compare recent invocations of Regsvcs.exe and Regasm.exe with prior history of known good arguments and executed binaries to determine anomalous and potentially adversarial activity. Command arguments used before and after Regsvcs.exe or Regasm.exe invocation may also be useful in determining the origin and purpose of the binary being executed.",
    "x_mitre_data_sources": [
        "Command: Command Execution",
        "Process: Process Creation"
    ],
    "x_mitre_permissions_required": [
        "User",
        "Administrator"
    ],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Execution Prevention",
                "description": "Block execution of code on a system through application control, and/or script blocking.",
                "type": "course-of-action",
                "id": "M1038"
            },
            {
                "name": "Disable or Remove Feature or Program",
                "description": "Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.",
                "type": "course-of-action",
                "id": "M1042"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that Regsvcs and Regasm are disabled or removed if not necessary within a given environment.",
                "acid": "98581647"
            },
            {
                "description": "Ensure that the execution of Regsvcs.exe and Regasm.exe are blocked (if not required for a given system or network) to prevent potential abuse.",
                "acid": "98581648"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that process monitoring is used to monitor the execution and arguments of Regsvcs.exe and Regasm.exe.",
                "acid": "98581640"
            },
            {
                "description": "Ensure that recent invocations of Regsvcs.exe are compared with the history of known good arguments to determine anomalous activity.",
                "acid": "98581641"
            },
            {
                "description": "Ensure that recent invocations of Regsvcs.exe are compared with the history of executed binaries to determine anomalous activity.",
                "acid": "98581642"
            },
            {
                "description": "Ensure that recent invocations of Regasm.exe are compared with the history of known good arguments to determine anomalous activity.",
                "acid": "98581643"
            },
            {
                "description": "Ensure that recent invocations of Regasm.exe are compared with history executed binaries to determine anomalous activity.",
                "acid": "98581644"
            },
            {
                "description": "Ensure that Command arguments used before and after the Regsvcs.exe invocation are inspected to determine the (origin and purpose) execution of binary.",
                "acid": "98581645"
            },
            {
                "description": "Ensure that Command arguments used before and after the Regasm.exe invocation are inspected to determine the (origin and purpose) execution of binary.",
                "acid": "98581646"
            }
        ]
    },
    "cspcontrolIds": [],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [],
    "technologycontrolIds": [],
    "cveIds": []
}
