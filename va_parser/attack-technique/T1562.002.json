{
    "id": "T1562.002",
    "name": "Disable Windows Event Logging",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may disable Windows event logging to limit data that can be leveraged for detections and audits. Windows event logs record user and system activity such as login attempts, process creation, and much more.(Citation: Windows Log Events) This data is used by security tools and analysts to generate detections.\n\nThe EventLog service maintains event logs from various system components and applications.(Citation: EventLog_Core_Technologies) By default, the service automatically starts when a system powers on. An audit policy, maintained by the Local Security Policy (secpol.msc), defines which system events the EventLog service logs. Security audit policy settings can be changed by running secpol.msc, then navigating to <code>Security Settings\\Local Policies\\Audit Policy</code> for basic audit policy settings or <code>Security Settings\\Advanced Audit Policy Configuration</code> for advanced audit policy settings.(Citation: Audit_Policy_Microsoft)(Citation: Advanced_sec_audit_policy_settings) <code>auditpol.exe</code> may also be used to set audit policies.(Citation: auditpol)\n\nAdversaries may target system-wide logging or just that of a particular application. For example, the EventLog service may be disabled using the following PowerShell line: <code>Stop-Service -Name EventLog</code>.(Citation: Disable_Win_Event_Logging) Additionally, adversaries may use <code>auditpol</code> and its sub-commands in a command prompt to disable auditing or clear the audit policy. To enable or disable a specified setting or audit category, adversaries may use the <code>/success</code> or <code>/failure</code> parameters. For example, <code>auditpol /set /category:\u201dAccount Logon\u201d /success:disable /failure:disable</code> turns off auditing for the Account Logon category.(Citation: auditpol.exe_STRONTIC)(Citation: T1562.002_redcanaryco) To clear the audit policy, adversaries may run the following lines: <code>auditpol /clear /y</code> or <code>auditpol /remove /allusers</code>.(Citation: T1562.002_redcanaryco)\n\nBy disabling Windows event logging, adversaries can operate while leaving less evidence of a compromise behind.",
    "x_mitre_platforms": [
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [
        "Log analysis"
    ],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1562/002",
            "external_id": "T1562.002"
        },
        {
            "source_name": "Windows Log Events",
            "description": "Franklin Smith. (n.d.). Windows Security Log Events. Retrieved February 21, 2020.",
            "url": "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/"
        },
        {
            "source_name": "EventLog_Core_Technologies",
            "description": "Core Technologies. (2021, May 24). Essential Windows Services: EventLog / Windows Event Log. Retrieved September 14, 2021.",
            "url": "https://www.coretechnologies.com/blog/windows-services/eventlog/"
        },
        {
            "source_name": "Audit_Policy_Microsoft",
            "description": "Daniel Simpson. (2017, April 19). Audit Policy. Retrieved September 13, 2021.",
            "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/audit-policy"
        },
        {
            "source_name": "Advanced_sec_audit_policy_settings",
            "description": "Simpson, D. et al. (2017, April 19). Advanced security audit policy settings. Retrieved September 14, 2021.",
            "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/advanced-security-audit-policy-settings"
        },
        {
            "source_name": "auditpol",
            "description": "Jason Gerend, et al. (2017, October 16). auditpol. Retrieved September 1, 2021.",
            "url": "https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/auditpol"
        },
        {
            "source_name": "Disable_Win_Event_Logging",
            "description": " dmcxblue. (n.d.). Disable Windows Event Logging. Retrieved September 10, 2021.",
            "url": "https://dmcxblue.gitbook.io/red-team-notes-2-0/red-team-techniques/defense-evasion/t1562-impair-defenses/disable-windows-event-logging"
        },
        {
            "source_name": "auditpol.exe_STRONTIC",
            "description": "STRONTIC. (n.d.). auditpol.exe. Retrieved September 9, 2021.",
            "url": "https://strontic.github.io/xcyclopedia/library/auditpol.exe-214E0EA1F7F7C27C82D23F183F9D23F1.html"
        },
        {
            "source_name": "T1562.002_redcanaryco",
            "description": "redcanaryco. (2021, September 3). T1562.002 - Disable Windows Event Logging. Retrieved September 13, 2021.",
            "url": "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.002/T1562.002.md"
        },
        {
            "source_name": "def_ev_win_event_logging",
            "description": "Chandel, R. (2021, April 22). Defense Evasion: Windows Event Logging (T1562.002). Retrieved September 14, 2021.",
            "url": "https://www.hackingarticles.in/defense-evasion-windows-event-logging-t1562-002/"
        },
        {
            "source_name": "evt_log_tampering",
            "description": "svch0st. (2020, September 30). Event Log Tampering Part 1: Disrupting the EventLog Service. Retrieved September 14, 2021.",
            "url": "https://svch0st.medium.com/event-log-tampering-part-1-disrupting-the-eventlog-service-8d4b7d67335c"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "defense-evasion"
        }
    ],
    "tactic": [
        "defense-evasion"
    ],
    "x_mitre_detection": "Monitor processes and command-line arguments for commands that can be used to disable logging. For example, [Wevtutil](https://attack.mitre.org/software/S0645), `auditpol`, `sc stop EventLog`, and offensive tooling (such as [Mimikatz](https://attack.mitre.org/software/S0002) and `Invoke-Phant0m`) may be used to clear logs.(Citation: def_ev_win_event_logging)(Citation: evt_log_tampering)  \n\nIn Event Viewer, Event ID 1102 under the \u201cSecurity\u201d Windows Log and Event ID 104 under the \u201cSystem\u201d Windows Log both indicate logs have been cleared.(Citation: def_ev_win_event_logging) `Service Control Manager Event ID 7035` in Event Viewer may indicate the termination of the EventLog service.(Citation: evt_log_tampering) Additionally, gaps in the logs, e.g. non-sequential Event Record IDs, may indicate that the logs may have been tampered.\n\nMonitor the addition of the MiniNT registry key in `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control`, which may disable Event Viewer.(Citation: def_ev_win_event_logging)",
    "x_mitre_data_sources": [
        "Application Log: Application Log Content",
        "Process: Process Creation",
        "Windows Registry: Windows Registry Key Creation",
        "Script: Script Execution",
        "Sensor Health: Host Status",
        "Command: Command Execution"
    ],
    "x_mitre_permissions_required": [
        "Administrator"
    ],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Restrict File and Directory Permissions",
                "description": "Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.",
                "type": "course-of-action",
                "id": "M1022"
            },
            {
                "name": "Restrict Registry Permissions",
                "description": "Restrict the ability to modify certain hives or keys in the Windows Registry.",
                "type": "course-of-action",
                "id": "M1024"
            },
            {
                "name": "Audit",
                "description": "Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.",
                "type": "course-of-action",
                "id": "M1047"
            },
            {
                "name": "User Account Management",
                "description": "Manage the creation, modification, use, and permissions associated to user accounts.",
                "type": "course-of-action",
                "id": "M1018"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that process permissions are applied properly to prevent disabling or interfering logging.",
                "acid": "98581287"
            },
            {
                "description": "Ensure that file permissions are applied properly to prevent disabling or interfering logging.",
                "acid": "98581288"
            },
            {
                "description": "Ensure that Registry permissions are applied properly to prevent disabling or interfering logging.",
                "acid": "98581289"
            },
            {
                "description": "Ensure that user permissions are applied properly to prevent disabling or interfering with logging services.",
                "acid": "98581290"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that the Monitoring Solution is configured to monitor system processes.",
                "acid": "98581284"
            },
            {
                "description": "Ensure that command-line arguments (for commands) used to disable Windows event logging are monitored.",
                "acid": "98581285"
            },
            {
                "description": "Ensure that sufficient System event logs are configured and monitored.",
                "acid": "98581286"
            }
        ]
    },
    "cspcontrolIds": [
        "40000097",
        "40000490"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [],
    "technologycontrolIds": [
        "15010118",
        "15010119",
        "15010120",
        "15010121",
        "15010128",
        "15010129",
        "15010130",
        "15010131",
        "15010138",
        "15010139",
        "15010140",
        "15010141",
        "15020121",
        "15020122",
        "15020123",
        "15020124",
        "15020131",
        "15020132",
        "15020133",
        "15020134",
        "15020366",
        "15020367",
        "15020368",
        "15020369",
        "15030121",
        "15030122",
        "15030123",
        "15030124",
        "15030131",
        "15030132",
        "15030133",
        "15030134",
        "15030141",
        "15030142",
        "15030143",
        "15030144",
        "15040183",
        "15040184",
        "15040189",
        "15040190",
        "15040192",
        "15040193",
        "15040196",
        "15040200",
        "15200118",
        "15200119",
        "15200120",
        "15200121",
        "15200128",
        "15200129",
        "15200130",
        "15200131",
        "15200138",
        "15200139",
        "15200140",
        "15200141",
        "16010124",
        "16010125",
        "16010126",
        "16010127",
        "16010134",
        "16010135",
        "16010136",
        "16010137",
        "16010144",
        "16010145",
        "16010146",
        "16010147",
        "16020123",
        "16020124",
        "16020125",
        "16020126",
        "16020133",
        "16020134",
        "16020135",
        "16020136",
        "16020143",
        "16020144",
        "16020145",
        "16020146",
        "16100125",
        "16100126",
        "16100127",
        "16100128",
        "16100135",
        "16100136",
        "16100137",
        "16100138",
        "16100145",
        "16100146",
        "16100147",
        "16100148",
        "16110122",
        "16110123",
        "16110124",
        "16110125",
        "16110132",
        "16110133",
        "16110134",
        "16110135",
        "16110142",
        "16110143",
        "16110144",
        "16110145",
        "16120126",
        "16120127",
        "16120128",
        "16120129",
        "16120136",
        "16120137",
        "16120138",
        "16120139",
        "16120146",
        "16120147",
        "16120148",
        "16120149",
        "16360123",
        "16360124",
        "16360125",
        "16360126",
        "16360131",
        "16360132",
        "16360133",
        "16360134",
        "16360141",
        "16360142",
        "16360143",
        "16360144",
        "16460122",
        "16460123",
        "16460124",
        "16460125",
        "16460130",
        "16460131",
        "16460132",
        "16460133",
        "16460140",
        "16460141",
        "16460142",
        "16460143",
        "19920114",
        "19920115",
        "19920116",
        "19920117",
        "19920122",
        "19920123",
        "19920124",
        "19920125",
        "19920132",
        "19920133",
        "19920134",
        "19920135",
        "19920412",
        "19920430",
        "19920442"
    ],
    "cveIds": []
}
