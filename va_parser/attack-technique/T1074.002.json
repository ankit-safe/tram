{
    "id": "T1074.002",
    "name": "Remote Data Staging",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may stage data collected from multiple systems in a central location or directory on one system prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as [Archive Collected Data](https://attack.mitre.org/techniques/T1560). Interactive command shells may be used, and common functionality within [cmd](https://attack.mitre.org/software/S0106) and bash may be used to copy data into a staging location.\n\nIn cloud environments, adversaries may stage data within a particular instance or virtual machine before exfiltration. An adversary may [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002) and stage data in that instance.(Citation: Mandiant M-Trends 2020)\n\nBy staging data on one system prior to Exfiltration, adversaries can minimize the number of connections made to their C2 server and better evade detection.",
    "x_mitre_platforms": [
        "Windows",
        "IaaS",
        "Linux",
        "macOS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1074/002",
            "external_id": "T1074.002"
        },
        {
            "source_name": "Mandiant M-Trends 2020",
            "description": "Mandiant. (2020, February). M-Trends 2020. Retrieved April 24, 2020.",
            "url": "https://content.fireeye.com/m-trends/rpt-m-trends-2020"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "collection"
        }
    ],
    "tactic": [
        "collection"
    ],
    "x_mitre_detection": "Processes that appear to be reading files from disparate locations and writing them to the same directory or file may be an indication of data being staged, especially if they are suspected of performing encryption or compression on the files, such as 7zip, RAR, ZIP, or zlib. Monitor publicly writeable directories, central locations, and commonly used staging directories (recycle bin, temp folders, etc.) to regularly check for compressed or encrypted data that may be indicative of staging.\n\nMonitor processes and command-line arguments for actions that could be taken to collect and combine files. Remote access tools with built-in features may interact directly with the Windows API to gather and copy to a location. Data may also be acquired and staged through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
    "x_mitre_data_sources": [
        "File: File Access",
        "File: File Creation",
        "Command: Command Execution"
    ],
    "x_mitre_permissions_required": [],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": []
    },
    "mitigationRequirements": {
        "requirements": []
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that processes reading files from disparate locations and writing them to the same directory or file should be monitored.",
                "acid": "98582397"
            },
            {
                "description": "Ensure that process should be monitored if they are performing encryption or compression on the files, such as 7zip, RAR, ZIP, or zlib.",
                "acid": "98582398"
            },
            {
                "description": "Ensure that publicly writable directories are monitored regularly for compressed or encrypted data indicating staging.",
                "acid": "98582399"
            },
            {
                "description": "Ensure that central locations are monitored regularly for compressed or encrypted data indicating staging.",
                "acid": "98582400"
            },
            {
                "description": "Ensure that commonly used staging directories (recycle bin, temp folders, etc.) are monitored regularly for compressed or encrypted data indicating staging.",
                "acid": "98582401"
            },
            {
                "description": "Ensure that processes and command-line arguments are monitored for actions taken to collect files from a system.",
                "acid": "98582402"
            },
            {
                "description": "Ensure that system is monitored for remote access tools interacting directly with the Windows API to gather data.",
                "acid": "98582403"
            },
            {
                "description": "Ensure that system is monitored if data is acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.",
                "acid": "98582404"
            }
        ]
    },
    "cspcontrolIds": [],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [],
    "technologycontrolIds": [],
    "cveIds": []
}
