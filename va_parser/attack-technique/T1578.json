{
    "id": "T1578",
    "name": "Modify Cloud Compute Infrastructure",
    "x_mitre_is_subtechnique": false,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "An adversary may attempt to modify a cloud account's compute service infrastructure to evade defenses. A modification to the compute service infrastructure can include the creation, deletion, or modification of one or more components such as compute instances, virtual machines, and snapshots.\n\nPermissions gained from the modification of infrastructure components may bypass restrictions that prevent access to existing infrastructure. Modifying infrastructure components may also allow an adversary to evade detection and remove evidence of their presence.(Citation: Mandiant M-Trends 2020)",
    "x_mitre_platforms": [
        "IaaS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1578",
            "external_id": "T1578"
        },
        {
            "source_name": "Mandiant M-Trends 2020",
            "description": "Mandiant. (2020, February). M-Trends 2020. Retrieved April 24, 2020.",
            "url": "https://content.fireeye.com/m-trends/rpt-m-trends-2020"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "defense-evasion"
        }
    ],
    "tactic": [
        "defense-evasion"
    ],
    "x_mitre_detection": "Establish centralized logging for the activity of cloud compute infrastructure components. Monitor for suspicious sequences of events, such as the creation of multiple snapshots within a short period of time or the mount of a snapshot to a new instance by a new or unexpected user. To reduce false positives, valid change management procedures could introduce a known identifier that is logged with the change (e.g., tag or header) if supported by the cloud provider, to help distinguish valid, expected actions from malicious ones.",
    "x_mitre_data_sources": [
        "Instance: Instance Metadata",
        "Instance: Instance Modification",
        "Instance: Instance Stop",
        "Volume: Volume Modification",
        "Instance: Instance Start",
        "Volume: Volume Metadata",
        "Volume: Volume Deletion",
        "Snapshot: Snapshot Modification",
        "Instance: Instance Deletion",
        "Snapshot: Snapshot Creation",
        "Snapshot: Snapshot Metadata",
        "Instance: Instance Creation",
        "Snapshot: Snapshot Deletion",
        "Volume: Volume Creation"
    ],
    "x_mitre_permissions_required": [
        "User"
    ],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "User Account Management",
                "description": "Manage the creation, modification, use, and permissions associated to user accounts.",
                "type": "course-of-action",
                "id": "M1018"
            },
            {
                "name": "Audit",
                "description": "Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.",
                "type": "course-of-action",
                "id": "M1047"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that user permissions regularly to monitored.",
                "acid": "98581456"
            },
            {
                "description": "Ensure that permissions are implemented properly so that only expected users can modify cloud compute infrastructure components.",
                "acid": "98581457"
            },
            {
                "description": "Ensure that the least privileges are in place by limiting permissions for creating, deleting, and altering compute components.",
                "acid": "98581458"
            },
            {
                "description": "Ensure that the IAM role is implemented to limit the number of users in the organization.",
                "acid": "98581459"
            },
            {
                "description": "Ensure that the IAM role is implemented to reduce all permanent privileged role assignments.",
                "acid": "98581460"
            },
            {
                "description": "Ensure that periodic entitlement reviews are conducted on IAM users, roles, and policies.",
                "acid": "98581461"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that centralized logging for the activity of cloud compute infrastructure components is configured for monitoring.",
                "acid": "98581451"
            },
            {
                "description": "Ensure that centralized logging is used to monitor suspicious sequences of events, e.g. the creation of multiple snapshots within a short period.",
                "acid": "98581452"
            },
            {
                "description": "Ensure that centralized logging is used to monitor suspicious sequences of events, e.g. the mount of a snapshot to a new instance by a new or unexpected user.",
                "acid": "98581453"
            },
            {
                "description": "Ensure that valid change management procedures are implemented to distinguish valid, expected actions from malicious ones (by introducing a known identifier that is logged with tag or header).",
                "acid": "98581454"
            },
            {
                "description": "Ensure that valid change management procedures are implemented to reduce false positive (by introducing a known identifier that is logged with tag or header).",
                "acid": "98581455"
            }
        ]
    },
    "cspcontrolIds": [
        "40000097",
        "40000121",
        "40000490",
        "40000504"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [
        "50106002"
    ],
    "technologycontrolIds": [
        "18380013",
        "18400004",
        "18410021",
        "19290001"
    ],
    "cveIds": [],
    "subTechniques": [
        "T1578.001",
        "T1578.002",
        "T1578.003",
        "T1578.004"
    ]
}
