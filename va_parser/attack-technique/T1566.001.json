{
    "id": "T1566.001",
    "name": "Spearphishing Attachment",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [User Execution](https://attack.mitre.org/techniques/T1204) to gain execution. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.\n\nThere are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one. ",
    "x_mitre_platforms": [
        "macOS",
        "Windows",
        "Linux"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1566/001",
            "external_id": "T1566.001"
        },
        {
            "source_name": "capec",
            "url": "https://capec.mitre.org/data/definitions/163.html",
            "external_id": "CAPEC-163"
        },
        {
            "source_name": "Microsoft Anti Spoofing",
            "description": "Microsoft. (2020, October 13). Anti-spoofing protection in EOP. Retrieved October 19, 2020.",
            "url": "https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-spoofing-protection?view=o365-worldwide"
        },
        {
            "source_name": "ACSC Email Spoofing",
            "description": "Australian Cyber Security Centre. (2012, December). Mitigating Spoofed Emails Using Sender Policy Framework. Retrieved October 19, 2020.",
            "url": "https://www.cyber.gov.au/sites/default/files/2019-03/spoof_email_sender_policy_framework.pdf"
        },
        {
            "source_name": "Elastic - Koadiac Detection with EQL",
            "description": "Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 30, 2020.",
            "url": "https://www.elastic.co/blog/embracing-offensive-tooling-building-detections-against-koadic-using-eql"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "initial-access"
        }
    ],
    "tactic": [
        "initial-access"
    ],
    "x_mitre_detection": "Network intrusion detection systems and email gateways can be used to detect spearphishing with malicious attachments in transit. Detonation chambers may also be used to identify malicious attachments. Solutions can be signature and behavior based, but adversaries may construct attachments in a way to avoid these systems.\n\nFiltering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed.(Citation: Microsoft Anti Spoofing)(Citation: ACSC Email Spoofing)\n\nAnti-virus can potentially detect malicious documents and attachments as they're scanned to be stored on the email server or on the user's computer. Endpoint sensing or network sensing can potentially detect malicious events once the attachment is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning Powershell.exe) for techniques such as [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203) or usage of malicious scripts.\n\nMonitor for suspicious descendant process spawning from Microsoft Office and other productivity software.(Citation: Elastic - Koadiac Detection with EQL)",
    "x_mitre_data_sources": [
        "Network Traffic: Network Traffic Content",
        "Network Traffic: Network Traffic Flow",
        "Application Log: Application Log Content",
        "File: File Creation"
    ],
    "x_mitre_permissions_required": [],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Antivirus/Antimalware",
                "description": "Use signatures or heuristics to detect malicious software.",
                "type": "course-of-action",
                "id": "M1049"
            },
            {
                "name": "Network Intrusion Prevention",
                "description": "Use intrusion detection signatures to block traffic at network boundaries.",
                "type": "course-of-action",
                "id": "M1031"
            },
            {
                "name": "Software Configuration",
                "description": "Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.",
                "type": "course-of-action",
                "id": "M1054"
            },
            {
                "name": "User Training",
                "description": "Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.",
                "type": "course-of-action",
                "id": "M1017"
            },
            {
                "name": "Restrict Web-Based Content",
                "description": "Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.",
                "type": "course-of-action",
                "id": "M1021"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that anti-malware solutions are configured to automatically quarantine malicious files",
                "acid": "98580054"
            },
            {
                "description": "Ensure that network intrusion prevention systems are configured to block malicious email attachments",
                "acid": "98580055"
            },
            {
                "description": "Ensure that email gateway security solutions (systems) are configured to block malicious email attachments",
                "acid": "98580056"
            },
            {
                "description": "Ensure that email attachments containing extensions such as .exe, .scr, .pif, .cpl, etc. are blocked for delivery",
                "acid": "98580057"
            },
            {
                "description": "Ensure that users are trained to identify social engineering techniques and spearphishing emails & links",
                "acid": "98580058"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that network intrusion system is configured to detect spearphishing emails with malicious attachment in transit",
                "acid": "98580049"
            },
            {
                "description": "Ensure that email gateway security solution is configured scan and analyze email attachments to identify malicious emails or email attachments",
                "acid": "98580050"
            },
            {
                "description": "Ensure that sandboxing environment (detonation chambers) is configured (to identify malicious email attachment)",
                "acid": "98580051"
            },
            {
                "description": "Ensure that anti-malware solutions are configured to scan email attachments",
                "acid": "98580052"
            },
            {
                "description": "Ensure that endpoint security solution(s) is configured to detect potentially malicious events once the attachment (i.e. PDF) is opened/ accessed",
                "acid": "98580053"
            }
        ]
    },
    "cspcontrolIds": [
        "40000182",
        "40000208"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [
        "PACR00004",
        "PACR00008"
    ],
    "policycontrolIds": [
        "50100527",
        "50100613",
        "50101358",
        "50101933",
        "50102405",
        "50104151",
        "50104301",
        "50104353"
    ],
    "technologycontrolIds": [
        "11490022",
        "16460388",
        "19120016",
        "19120017",
        "19120018",
        "19120019",
        "19120020",
        "19120023",
        "19120024",
        "19120025",
        "19120030",
        "19120031",
        "19120032",
        "19120033",
        "19120034",
        "19120035",
        "19120036",
        "19120037",
        "19120038",
        "19920438"
    ],
    "cveIds": [
        "CVE-2019-6340",
        "CVE-2020-3133"
    ]
}
