{
    "id": "T1578.002",
    "name": "Create Cloud Instance",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "An adversary may create a new instance or virtual machine (VM) within the compute service of a cloud account to evade defenses. Creating a new instance may allow an adversary to bypass firewall rules and permissions that exist on instances currently residing within an account. An adversary may [Create Snapshot](https://attack.mitre.org/techniques/T1578/001) of one or more volumes in an account, create a new instance, mount the snapshots, and then apply a less restrictive security policy to collect [Data from Local System](https://attack.mitre.org/techniques/T1005) or for [Remote Data Staging](https://attack.mitre.org/techniques/T1074/002).(Citation: Mandiant M-Trends 2020)\n\nCreating a new instance may also allow an adversary to carry out malicious activity within an environment without affecting the execution of current running instances.",
    "x_mitre_platforms": [
        "IaaS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1578/002",
            "external_id": "T1578.002"
        },
        {
            "source_name": "Mandiant M-Trends 2020",
            "description": "Mandiant. (2020, February). M-Trends 2020. Retrieved April 24, 2020.",
            "url": "https://content.fireeye.com/m-trends/rpt-m-trends-2020"
        },
        {
            "source_name": "AWS CloudTrail Search",
            "description": "Amazon. (n.d.). Search CloudTrail logs for API calls to EC2 Instances. Retrieved June 17, 2020.",
            "url": "https://aws.amazon.com/premiumsupport/knowledge-center/cloudtrail-search-api-calls/"
        },
        {
            "source_name": "Azure Activity Logs",
            "description": "Microsoft. (n.d.). View Azure activity logs. Retrieved June 17, 2020.",
            "url": "https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/view-activity-logs"
        },
        {
            "source_name": "Cloud Audit Logs",
            "description": "Google. (n.d.). Audit Logs. Retrieved June 1, 2020.",
            "url": "https://cloud.google.com/logging/docs/audit#admin-activity"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "defense-evasion"
        }
    ],
    "tactic": [
        "defense-evasion"
    ],
    "x_mitre_detection": "The creation of a new instance or VM is a common part of operations within many cloud environments. Events should then not be viewed in isolation, but as part of a chain of behavior that could lead to other activities. For example, the creation of an instance by a new user account or the unexpected creation of one or more snapshots followed by the creation of an instance may indicate suspicious activity.\n\nIn AWS, CloudTrail logs capture the creation of an instance in the <code>RunInstances</code> event, and in Azure the creation of a VM may be captured in Azure activity logs.(Citation: AWS CloudTrail Search)(Citation: Azure Activity Logs) Google's Admin Activity audit logs within their Cloud Audit logs can be used to detect the usage of <code>gcloud compute instances create</code> to create a VM.(Citation: Cloud Audit Logs)",
    "x_mitre_data_sources": [
        "Instance: Instance Metadata",
        "Instance: Instance Creation"
    ],
    "x_mitre_permissions_required": [
        "User"
    ],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Audit",
                "description": "Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.",
                "type": "course-of-action",
                "id": "M1047"
            },
            {
                "name": "User Account Management",
                "description": "Manage the creation, modification, use, and permissions associated to user accounts.",
                "type": "course-of-action",
                "id": "M1018"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that auditing is employed for the user to monitor their permissions regularly.",
                "acid": "98581480"
            },
            {
                "description": "Ensure that permissions are implemented properly so that only expected users can create new instances.",
                "acid": "98581481"
            },
            {
                "description": "Ensure that the least privileges are implemented by limiting permissions for creating new instances.",
                "acid": "98581482"
            },
            {
                "description": "Ensure that the IAM role is implemented to limit the number of users in the organization.",
                "acid": "98581483"
            },
            {
                "description": "Ensure that the IAM role is implemented to reduce all permanent privileged role assignments.",
                "acid": "98581484"
            },
            {
                "description": "Ensure that periodic entitlement reviews are conducted on IAM users, roles, and policies.",
                "acid": "98581485"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that events are viewed as part of the chain of behavior rather than isolation.",
                "acid": "98581476"
            },
            {
                "description": "Ensure that CloudTrail logs are monitored to inspect the creation of an instance in the \"RunInstances \" events.",
                "acid": "98581477"
            },
            {
                "description": "Ensure that for Azure, Azure activity logs are monitored to check the creation of VM.",
                "acid": "98581478"
            },
            {
                "description": "Ensure that Google's Admin Activity audit logs (within their Cloud Audit logs) are monitored to detect the creation of VM.",
                "acid": "98581479"
            }
        ]
    },
    "cspcontrolIds": [
        "40000097",
        "40000490"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [],
    "technologycontrolIds": [],
    "cveIds": []
}
