{
    "id": "T1566.003",
    "name": "Spearphishing via Service",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may send spearphishing messages via third-party services in an attempt to gain access to victim systems. Spearphishing via service is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of third party services rather than directly via enterprise email channels. \n\nAll forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries send messages through various social media services, personal webmail, and other non-enterprise controlled services. These services are more likely to have a less-strict security policy than an enterprise. As with most kinds of spearphishing, the goal is to generate rapport with the target or get the target's interest in some way. Adversaries will create fake social media accounts and message employees for potential job opportunities. Doing so allows a plausible reason for asking about services, policies, and software that's running in an environment. The adversary can then send malicious links or attachments through these services.\n\nA common example is to build rapport with a target via social media, then send content to a personal webmail service that the target uses on their work computer. This allows an adversary to bypass some email restrictions on the work account, and the target is more likely to open the file since it's something they were expecting. If the payload doesn't work as expected, the adversary can continue normal communications and troubleshoot with the target on how to get it working.",
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1566/003",
            "external_id": "T1566.003"
        },
        {
            "source_name": "capec",
            "url": "https://capec.mitre.org/data/definitions/163.html",
            "external_id": "CAPEC-163"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "initial-access"
        }
    ],
    "tactic": [
        "initial-access"
    ],
    "x_mitre_detection": "Because most common third-party services used for spearphishing via service leverage TLS encryption, SSL/TLS inspection is generally required to detect the initial communication/delivery. With SSL/TLS inspection intrusion detection signatures or other security gateway appliances may be able to detect malware. \n\nAnti-virus can potentially detect malicious documents and files that are downloaded on the user's computer. Endpoint sensing or network sensing can potentially detect malicious events once the file is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning Powershell.exe) for techniques such as [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203) or usage of malicious scripts.",
    "x_mitre_data_sources": [
        "Network Traffic: Network Traffic Flow",
        "Network Traffic: Network Traffic Content",
        "Application Log: Application Log Content"
    ],
    "x_mitre_permissions_required": [],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "User Training",
                "description": "Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.",
                "type": "course-of-action",
                "id": "M1017"
            },
            {
                "name": "Antivirus/Antimalware",
                "description": "Use signatures or heuristics to detect malicious software.",
                "type": "course-of-action",
                "id": "M1049"
            },
            {
                "name": "Restrict Web-Based Content",
                "description": "Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.",
                "type": "course-of-action",
                "id": "M1021"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that anti-malware solutions are configured to automatically quarantine malicious files",
                "acid": "98580066"
            },
            {
                "description": "Ensure that users are trained to identify social engineering techniques and spearphishing emails & links",
                "acid": "98580067"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that SSL/TLS inspection is configured to detect the initial communication/delivery to identify whether it is malicious",
                "acid": "98580062"
            },
            {
                "description": "Ensure that email gateway solutions (with SSL/TLS ID Signatures) are configured to detect malware present in the emails",
                "acid": "98580063"
            },
            {
                "description": "Ensure that Anti-malware Solutions are configured to detect malicious documents and files downloaded on the user's computer",
                "acid": "98580064"
            },
            {
                "description": "Ensure that endpoint security solution(s) is configured to detect potentially malicious events once the attachment (i.e. PDF) is opened/ accessed",
                "acid": "98580065"
            }
        ]
    },
    "cspcontrolIds": [
        "40000208"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [
        "PACR00004",
        "PACR00006",
        "PACR00007",
        "PACR00008",
        "PACR00009"
    ],
    "policycontrolIds": [
        "50100521",
        "50100523",
        "50101358",
        "50104151",
        "50104319",
        "50104353"
    ],
    "technologycontrolIds": [
        "11060009",
        "11100009",
        "11170005",
        "19120017"
    ],
    "cveIds": []
}
