{
    "id": "T1021.003",
    "name": "Distributed Component Object Model",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to interact with remote machines by taking advantage of Distributed Component Object Model (DCOM). The adversary may then perform actions as the logged-on user.\n\nThe Windows Component Object Model (COM) is a component of the native Windows application programming interface (API) that enables interaction between software objects, or executable code that implements one or more interfaces. Through COM, a client object can call methods of server objects, which are typically Dynamic Link Libraries (DLL) or executables (EXE). Distributed COM (DCOM) is transparent middleware that extends the functionality of COM beyond a local computer using remote procedure call (RPC) technology.(Citation: Fireeye Hunting COM June 2019)(Citation: Microsoft COM)\n\nPermissions to interact with local and remote server COM objects are specified by access control lists (ACL) in the Registry.(Citation: Microsoft Process Wide Com Keys) By default, only Administrators may remotely activate and launch COM objects through DCOM.(Citation: Microsoft COM ACL)\n\nThrough DCOM, adversaries operating in the context of an appropriately privileged user can remotely obtain arbitrary and even direct shellcode execution through Office applications(Citation: Enigma Outlook DCOM Lateral Movement Nov 2017) as well as other Windows objects that contain insecure methods.(Citation: Enigma MMC20 COM Jan 2017)(Citation: Enigma DCOM Lateral Movement Jan 2017) DCOM can also execute macros in existing documents(Citation: Enigma Excel DCOM Sept 2017) and may also invoke [Dynamic Data Exchange](https://attack.mitre.org/techniques/T1559/002) (DDE) execution directly through a COM created instance of a Microsoft Office application(Citation: Cyberreason DCOM DDE Lateral Movement Nov 2017), bypassing the need for a malicious document. DCOM can be used as a method of remotely interacting with [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). (Citation: MSDN WMI)",
    "x_mitre_platforms": [
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1021/003",
            "external_id": "T1021.003"
        },
        {
            "source_name": "Fireeye Hunting COM June 2019",
            "description": "Hamilton, C. (2019, June 4). Hunting COM Objects. Retrieved June 10, 2019.",
            "url": "https://www.fireeye.com/blog/threat-research/2019/06/hunting-com-objects.html"
        },
        {
            "source_name": "Microsoft COM",
            "description": "Microsoft. (n.d.). Component Object Model (COM). Retrieved November 22, 2017.",
            "url": "https://msdn.microsoft.com/library/windows/desktop/ms680573.aspx"
        },
        {
            "source_name": "Microsoft Process Wide Com Keys",
            "description": "Microsoft. (n.d.). Setting Process-Wide Security Through the Registry. Retrieved November 21, 2017.",
            "url": "https://msdn.microsoft.com/en-us/library/windows/desktop/ms687317(v=vs.85).aspx"
        },
        {
            "source_name": "Microsoft COM ACL",
            "description": "Microsoft. (n.d.). DCOM Security Enhancements in Windows XP Service Pack 2 and Windows Server 2003 Service Pack 1. Retrieved November 22, 2017.",
            "url": "https://docs.microsoft.com/en-us/windows/desktop/com/dcom-security-enhancements-in-windows-xp-service-pack-2-and-windows-server-2003-service-pack-1"
        },
        {
            "source_name": "Enigma Outlook DCOM Lateral Movement Nov 2017",
            "description": "Nelson, M. (2017, November 16). Lateral Movement using Outlook's CreateObject Method and DotNetToJScript. Retrieved November 21, 2017.",
            "url": "https://enigma0x3.net/2017/11/16/lateral-movement-using-outlooks-createobject-method-and-dotnettojscript/"
        },
        {
            "source_name": "Enigma MMC20 COM Jan 2017",
            "description": "Nelson, M. (2017, January 5). Lateral Movement using the MMC20 Application COM Object. Retrieved November 21, 2017.",
            "url": "https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/"
        },
        {
            "source_name": "Enigma DCOM Lateral Movement Jan 2017",
            "description": "Nelson, M. (2017, January 23). Lateral Movement via DCOM: Round 2. Retrieved November 21, 2017.",
            "url": "https://enigma0x3.net/2017/01/23/lateral-movement-via-dcom-round-2/"
        },
        {
            "source_name": "Enigma Excel DCOM Sept 2017",
            "description": "Nelson, M. (2017, September 11). Lateral Movement using Excel.Application and DCOM. Retrieved November 21, 2017.",
            "url": "https://enigma0x3.net/2017/09/11/lateral-movement-using-excel-application-and-dcom/"
        },
        {
            "source_name": "Cyberreason DCOM DDE Lateral Movement Nov 2017",
            "description": "Tsukerman, P. (2017, November 8). Leveraging Excel DDE for lateral movement via DCOM. Retrieved November 21, 2017.",
            "url": "https://www.cybereason.com/blog/leveraging-excel-dde-for-lateral-movement-via-dcom"
        },
        {
            "source_name": "MSDN WMI",
            "description": "Microsoft. (n.d.). Windows Management Instrumentation. Retrieved April 27, 2016.",
            "url": "https://msdn.microsoft.com/en-us/library/aa394582.aspx"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "lateral-movement"
        }
    ],
    "tactic": [
        "lateral-movement"
    ],
    "x_mitre_detection": "Monitor for COM objects loading DLLs and other modules not typically associated with the application.(Citation: Enigma Outlook DCOM Lateral Movement Nov 2017) Enumeration of COM objects, via [Query Registry](https://attack.mitre.org/techniques/T1012) or [PowerShell](https://attack.mitre.org/techniques/T1059/001), may also proceed malicious use.(Citation: Fireeye Hunting COM June 2019)(Citation: Enigma MMC20 COM Jan 2017) Monitor for spawning of processes associated with COM objects, especially those invoked by a user different than the one currently logged on.\n\nMonitor for any influxes or abnormal increases in DCOM related Distributed Computing Environment/Remote Procedure Call (DCE/RPC) traffic (typically over port 135).",
    "x_mitre_data_sources": [
        "Module: Module Load",
        "Network Traffic: Network Connection Creation",
        "Process: Process Creation"
    ],
    "x_mitre_permissions_required": [
        "Administrator",
        "SYSTEM"
    ],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Disable or Remove Feature or Program",
                "description": "Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.",
                "type": "course-of-action",
                "id": "M1042"
            },
            {
                "name": "Application Isolation and Sandboxing",
                "description": "Restrict execution of code to a virtual environment on or in transit to an endpoint system.",
                "type": "course-of-action",
                "id": "M1048"
            },
            {
                "name": "Network Segmentation",
                "description": "Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.",
                "type": "course-of-action",
                "id": "M1030"
            },
            {
                "name": "Privileged Account Management",
                "description": "Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.",
                "type": "course-of-action",
                "id": "M1026"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that system is configured to enable Windows COM alerts.",
                "acid": "98582267"
            },
            {
                "description": "Ensure that Protected View is used to read or open files.",
                "acid": "98582268"
            },
            {
                "description": "Ensure that DCOM is disabled through Dcomcnfg.exe.",
                "acid": "98582269"
            },
            {
                "description": "Ensure that Windows firewall is enabled to prevent DCOM instantiation by default.",
                "acid": "98582270"
            },
            {
                "description": "Ensure that registry settings are modified either directly or using Dcomcnfg.exe in HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{{{{AppID_GUID}}}} associated with the process-wide security of individual COM applications.",
                "acid": "98582271"
            },
            {
                "description": "Ensure that registry settings are modified either directly or using Dcomcnfg.exe in HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Ole associated with system-wide security defaults for all COM applications that do not set their own process-wide security.",
                "acid": "98582272"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that system is monitored for COM objects that loads DLLs.",
                "acid": "98582262"
            },
            {
                "description": "Ensure that system is monitored for modules that are not typically associated with application.",
                "acid": "98582263"
            },
            {
                "description": "Ensure that system is monitored for any enumeration of COM objects, via Query Registry or PowerShell.",
                "acid": "98582264"
            },
            {
                "description": "Ensure that system is monitored for spawning of processes associated with COM objects.",
                "acid": "98582265"
            },
            {
                "description": "Ensure that system is monitored for any influxes or abnormal increases in Distributed Computing Environment/Remote Procedure Call (DCE/RPC) traffic.",
                "acid": "98582266"
            }
        ]
    },
    "cspcontrolIds": [
        "40000205",
        "40000499"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [],
    "technologycontrolIds": [
        "15040012",
        "15040016",
        "15040023",
        "15040024",
        "15040027",
        "16130077"
    ],
    "cveIds": []
}
