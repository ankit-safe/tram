{
    "id": "T1078",
    "name": "Valid Accounts",
    "x_mitre_is_subtechnique": false,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access, network devices, and remote desktop.(Citation: volexity_0day_sophos_FW) Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.\n\nIn some cases, adversaries may abuse inactive accounts: for example, those belonging to individuals who are no longer part of an organization. Using these accounts may allow the adversary to evade detection, as the original account user will not be present to identify any anomalous activity taking place on their account.(Citation: CISA MFA PrintNightmare)\n\nThe overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise.(Citation: TechNet Credential Theft)",
    "x_mitre_platforms": [
        "Windows",
        "Azure AD",
        "Office 365",
        "SaaS",
        "IaaS",
        "Linux",
        "macOS",
        "Google Workspace",
        "Containers",
        "Network"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [
        "Firewall",
        "Anti-virus",
        "Host Intrusion Prevention Systems",
        "Network Intrusion Detection System",
        "Application Control",
        "System Access Controls"
    ],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1078",
            "external_id": "T1078"
        },
        {
            "source_name": "volexity_0day_sophos_FW",
            "description": "Adair, S., Lancaster, T., Volexity Threat Research. (2022, June 15). DriftingCloud: Zero-Day Sophos Firewall Exploitation and an Insidious Breach. Retrieved July 1, 2022.",
            "url": "https://www.volexity.com/blog/2022/06/15/driftingcloud-zero-day-sophos-firewall-exploitation-and-an-insidious-breach/"
        },
        {
            "source_name": "CISA MFA PrintNightmare",
            "description": "Cybersecurity and Infrastructure Security Agency. (2022, March 15). Russian State-Sponsored Cyber Actors Gain Network Access by Exploiting Default Multifactor Authentication Protocols and \u201cPrintNightmare\u201d Vulnerability. Retrieved March 16, 2022.",
            "url": "https://www.cisa.gov/uscert/ncas/alerts/aa22-074a"
        },
        {
            "source_name": "TechNet Credential Theft",
            "description": "Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016.",
            "url": "https://technet.microsoft.com/en-us/library/dn535501.aspx"
        },
        {
            "source_name": "TechNet Audit Policy",
            "description": "Microsoft. (2016, April 15). Audit Policy Recommendations. Retrieved June 3, 2016.",
            "url": "https://technet.microsoft.com/en-us/library/dn487457.aspx"
        },
        {
            "source_name": "capec",
            "url": "https://capec.mitre.org/data/definitions/560.html",
            "external_id": "CAPEC-560"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "defense-evasion"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "persistence"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "privilege-escalation"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "initial-access"
        }
    ],
    "tactic": [
        "defense-evasion",
        "persistence",
        "privilege-escalation",
        "initial-access"
    ],
    "x_mitre_detection": "Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services.(Citation: TechNet Audit Policy) Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).\n\nPerform regular audits of domain and local system accounts to detect accounts that may have been created by an adversary for persistence. Checks on these accounts could also include whether default accounts such as Guest have been activated. These audits should also include checks on any appliances and applications for default credentials or SSH keys, and if any are discovered, they should be updated immediately.",
    "x_mitre_data_sources": [
        "User Account: User Account Authentication",
        "Logon Session: Logon Session Creation",
        "Logon Session: Logon Session Metadata"
    ],
    "x_mitre_permissions_required": [
        "User",
        "Administrator"
    ],
    "x_mitre_effective_permissions": [
        "User",
        "Administrator"
    ],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Valid Accounts Mitigation",
                "description": "Take measures to detect or prevent techniques such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) or installation of keyloggers to acquire credentials through [Input Capture](https://attack.mitre.org/techniques/T1056). Limit credential overlap across systems to prevent access if account credentials are obtained. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled and use of accounts is segmented, as this is often equivalent to having a local administrator account with the same password on all systems. \n\nFollow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. (Citation: Microsoft Securing Privileged Access) \n\nAudit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. (Citation: TechNet Credential Theft) (Citation: TechNet Least Privilege) These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. \n\nApplications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment. (Citation: US-CERT Alert TA13-175A Risks of Default Passwords on the Internet) When possible, applications that use SSH keys should be updated periodically and properly secured. ",
                "type": "course-of-action",
                "id": "T1078"
            },
            {
                "name": "Password Policies",
                "description": "Set and enforce secure password policies for accounts.",
                "type": "course-of-action",
                "id": "M1027"
            },
            {
                "name": "User Account Management",
                "description": "Manage the creation, modification, use, and permissions associated to user accounts.",
                "type": "course-of-action",
                "id": "M1018"
            },
            {
                "name": "Privileged Account Management",
                "description": "Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.",
                "type": "course-of-action",
                "id": "M1026"
            },
            {
                "name": "Application Developer Guidance",
                "description": "This mitigation describes any guidance or training given to developers of applications to avoid introducing security weaknesses that an adversary may be able to take advantage of.",
                "type": "course-of-action",
                "id": "M1013"
            },
            {
                "name": "User Training",
                "description": "Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.",
                "type": "course-of-action",
                "id": "M1017"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that applications do not store sensitive data or credentials insecurely",
                "acid": "98580106"
            },
            {
                "description": "Ensure that applications do not store plaintext credentials in code",
                "acid": "98580107"
            },
            {
                "description": "Ensure that applications do not store published credentials in repositories",
                "acid": "98580108"
            },
            {
                "description": "Ensure that applications do not store credentials in public cloud storage",
                "acid": "98580109"
            },
            {
                "description": "Ensure that the default username and password utilized by the application should be changed immediately after the installation, and before deployment to a production environment",
                "acid": "98580110"
            },
            {
                "description": "Ensure that applications using SSH keys should be updated periodically and properly secured",
                "acid": "98580111"
            },
            {
                "description": "Ensure that domain and local accounts as well as their permission levels are audited regularly to identify suspicious behavior",
                "acid": "98580112"
            },
            {
                "description": "Ensure that audits are performed regularly to check for enabled default accounts",
                "acid": "98580113"
            },
            {
                "description": "Ensure that audits are performed regularly to check for new local accounts created that do not require authorization",
                "acid": "98580114"
            },
            {
                "description": "Ensure that best practices are followed for the design and administration of an enterprise network to limit privileged account use",
                "acid": "98580115"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that robust and consistent account activity audit policies are configured across the enterprise and with externally accessible services",
                "acid": "98580097"
            },
            {
                "description": "Ensure that systems sharing user, admin, or service accounts should be monitored for suspicious account behavior",
                "acid": "98580098"
            },
            {
                "description": "Ensure that an account should be monitored if logged into multiple systems simultaneously",
                "acid": "98580099"
            },
            {
                "description": "Ensure that behavior for multiple accounts logged into the same machine simultaneously is monitored",
                "acid": "98580100"
            },
            {
                "description": "Ensure that accounts should be monitored if logged in at odd times or outside of business hours",
                "acid": "98580101"
            },
            {
                "description": "Ensure that regular audits are performed for domain and local system accounts to detect accounts created by adversaries",
                "acid": "98580103"
            },
            {
                "description": "Ensure that domain and local system accounts are checked for active default accounts such as Guest",
                "acid": "98580104"
            },
            {
                "description": "Ensure that appliances and applications are monitored for default credentials or SSH keys",
                "acid": "98580105"
            }
        ]
    },
    "cspcontrolIds": [
        "40000097",
        "40000205",
        "40000211",
        "40000223",
        "40000490",
        "40000499",
        "40000502",
        "40000509",
        "40000516"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [
        "PACR00001"
    ],
    "policycontrolIds": [
        "50100283",
        "50100568",
        "50101185",
        "50101970",
        "50102686",
        "50102826",
        "50103017",
        "50103497",
        "50104298",
        "50106000",
        "50106001",
        "50106014",
        "50106020",
        "50106026",
        "50106027",
        "50106114",
        "50106115"
    ],
    "technologycontrolIds": [
        "10101032",
        "101020015",
        "10110015",
        "10110043",
        "10110048",
        "101540005",
        "101540018",
        "101540027",
        "101540038",
        "101550005",
        "101550018",
        "101550027",
        "101550038",
        "101560005",
        "101560017",
        "101560019",
        "101560040",
        "101560042",
        "101570005",
        "101570017",
        "101570019",
        "101570040",
        "101570042",
        "101600005",
        "101600017",
        "101600040",
        "101600042",
        "103900005",
        "103900017",
        "103900019",
        "103900039",
        "103900040",
        "10460005",
        "10460017",
        "10460040",
        "10460042",
        "10960008",
        "11010005",
        "11010017",
        "11010040",
        "11010042",
        "11470009",
        "11470013",
        "11470015",
        "11480001",
        "11480002",
        "11480003",
        "11480005",
        "11480007",
        "11480008",
        "11480011",
        "11490006",
        "11490014",
        "11490019",
        "11490024",
        "11490027",
        "11490028",
        "11490029",
        "11500006",
        "11500015",
        "11500016",
        "14010015",
        "14010027",
        "14010032",
        "14020015",
        "14020050",
        "14020055",
        "14030002",
        "14030099",
        "14030100",
        "14040002",
        "14040099",
        "14040100",
        "14040141",
        "14050016",
        "14050017",
        "14050020",
        "14050021",
        "14050032",
        "14050033",
        "14050037",
        "14080028",
        "14080056",
        "14080061",
        "14080069",
        "14110016",
        "14110017",
        "14110020",
        "14110021",
        "14110034",
        "14110035",
        "14120015",
        "14120016",
        "14120019",
        "14120020",
        "14120038",
        "14120040",
        "14120041",
        "14130015",
        "14130016",
        "14130020",
        "14130021",
        "14130030",
        "14130031",
        "14130047",
        "14170016",
        "14170017",
        "14170020",
        "14170021",
        "14170041",
        "14170042",
        "15010064",
        "15010164",
        "15020065",
        "15020159",
        "15020170",
        "15030065",
        "15030172",
        "15030199",
        "15040130",
        "15180060",
        "15200064",
        "15200164",
        "16010068",
        "16010173",
        "16020068",
        "16020175",
        "16020201",
        "16100069",
        "16100181",
        "16100212",
        "16110068",
        "16110171",
        "16120069",
        "16120176",
        "16120201",
        "16140060",
        "16360070",
        "16360185",
        "16360221",
        "16460068",
        "16460184",
        "16460219",
        "16460379",
        "16460393",
        "16460394",
        "16460395",
        "17800001",
        "17800005",
        "17800007",
        "17800008",
        "17800009",
        "17800010",
        "17800011",
        "17800012",
        "17800013",
        "17800014",
        "17800015",
        "17800018",
        "17810001",
        "17880002",
        "17880003",
        "17880005",
        "17880007",
        "17880009",
        "17890003",
        "17890005",
        "17900001",
        "17900005",
        "17900007",
        "17910001",
        "17910003",
        "17930001",
        "18140001",
        "18140002",
        "18140003",
        "18140004",
        "18140005",
        "18140006",
        "18160002",
        "18240001",
        "18240002",
        "18330001",
        "18330002",
        "18330003",
        "18340001",
        "18370001",
        "18380011",
        "18380016",
        "18410007",
        "18410015",
        "18410016",
        "18410017",
        "18410020",
        "18410022",
        "18410023",
        "18410044",
        "18410045",
        "18410046",
        "18410047",
        "18410048",
        "18410049",
        "18410050",
        "18410051",
        "18420002",
        "18420003",
        "18420005",
        "18420006",
        "18420007",
        "18420011",
        "18550003",
        "18640005",
        "18710001",
        "18710002",
        "18770001",
        "18770002",
        "18770003",
        "18780001",
        "18830001",
        "18840002",
        "19120040",
        "19200003",
        "19220005",
        "19310009",
        "19310010",
        "19310011",
        "19310012",
        "19310032",
        "19310033",
        "19330005",
        "19330006",
        "19350001",
        "19350002",
        "19350014",
        "19350015",
        "19350017",
        "19360001",
        "19360002",
        "19360007",
        "19360008",
        "19360009",
        "19360010",
        "19360011",
        "19360012",
        "19360013",
        "19360014",
        "19360015",
        "19360017",
        "19360020",
        "19430002",
        "19430003",
        "19430004",
        "19430005",
        "19430006",
        "19430007",
        "19430008",
        "19430009",
        "19430010",
        "19450001",
        "19450002",
        "19450003",
        "19450004",
        "19450005",
        "19450006",
        "19450007",
        "19450008",
        "19480001",
        "19920160",
        "19920402",
        "19920415",
        "19920420",
        "19920444"
    ],
    "cveIds": [
        "CVE-1999-0519",
        "CVE-2007-3280",
        "CVE-2011-3172",
        "CVE-2012-0874",
        "CVE-2013-0629",
        "CVE-2013-0640",
        "CVE-2016-5645",
        "CVE-2017-11368",
        "CVE-2017-13289",
        "CVE-2018-10517",
        "CVE-2018-10633",
        "CVE-2018-11045",
        "CVE-2018-11062",
        "CVE-2018-12464",
        "CVE-2018-14847",
        "CVE-2018-15761",
        "CVE-2018-15771",
        "CVE-2018-15795",
        "CVE-2018-15800",
        "CVE-2018-17900",
        "CVE-2018-20159",
        "CVE-2018-6941",
        "CVE-2018-7448",
        "CVE-2019-10990",
        "CVE-2019-11080",
        "CVE-2019-12185",
        "CVE-2019-12660",
        "CVE-2019-15243",
        "CVE-2019-15249",
        "CVE-2019-15288",
        "CVE-2019-15949",
        "CVE-2019-15954",
        "CVE-2019-15956",
        "CVE-2019-15963",
        "CVE-2019-15972",
        "CVE-2019-15998",
        "CVE-2019-1609",
        "CVE-2019-1611",
        "CVE-2019-1612",
        "CVE-2019-1715",
        "CVE-2019-1753",
        "CVE-2019-1768",
        "CVE-2019-1781",
        "CVE-2019-1790",
        "CVE-2019-1794",
        "CVE-2019-1812",
        "CVE-2019-1863",
        "CVE-2019-1879",
        "CVE-2019-18873",
        "CVE-2019-1889",
        "CVE-2019-1942",
        "CVE-2019-19609",
        "CVE-2019-3398",
        "CVE-2019-3704",
        "CVE-2019-3735",
        "CVE-2019-3763",
        "CVE-2019-3787",
        "CVE-2019-3790",
        "CVE-2019-6549",
        "CVE-2019-6563",
        "CVE-2019-7265",
        "CVE-2019-7751",
        "CVE-2019-8385",
        "CVE-2019-8942",
        "CVE-2020-0646",
        "CVE-2020-10963",
        "CVE-2020-11035",
        "CVE-2020-11107",
        "CVE-2020-11749",
        "CVE-2020-14011",
        "CVE-2020-14510",
        "CVE-2020-15093",
        "CVE-2020-15100",
        "CVE-2020-15105",
        "CVE-2020-1938",
        "CVE-2020-28337",
        "CVE-2020-29607",
        "CVE-2020-3165",
        "CVE-2020-3253",
        "CVE-2020-3292",
        "CVE-2020-3379",
        "CVE-2020-3403",
        "CVE-2020-3416",
        "CVE-2020-3476",
        "CVE-2020-3477",
        "CVE-2020-3513",
        "CVE-2020-35314",
        "CVE-2020-35606",
        "CVE-2020-5231",
        "CVE-2020-5364",
        "CVE-2020-5365",
        "CVE-2020-5374",
        "CVE-2021-24155",
        "CVE-2021-31761",
        "CVE-2021-31933",
        "CVE-2021-42362",
        "CVE-2022-0824",
        "CVE-2022-22909",
        "CVE-2022-24734",
        "CVE-2022-26965"
    ],
    "subTechniques": [
        "T1078.001",
        "T1078.002",
        "T1078.003",
        "T1078.004"
    ]
}
