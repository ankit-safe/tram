{
    "id": "T1003.003",
    "name": "NTDS",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may attempt to access or create a copy of the Active Directory domain database in order to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights. By default, the NTDS file (NTDS.dit) is located in <code>%SystemRoot%\\NTDS\\Ntds.dit</code> of a domain controller.(Citation: Wikipedia Active Directory)\n\nIn addition to looking for NTDS files on active Domain Controllers, adversaries may search for backups that contain the same or similar information.(Citation: Metcalf 2015)\n\nThe following tools and techniques can be used to enumerate the NTDS file and the contents of the entire Active Directory hashes.\n\n* Volume Shadow Copy\n* secretsdump.py\n* Using the in-built Windows tool, ntdsutil.exe\n* Invoke-NinjaCopy\n",
    "x_mitre_platforms": [
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1003/003",
            "external_id": "T1003.003"
        },
        {
            "source_name": "Wikipedia Active Directory",
            "description": "Wikipedia. (2018, March 10). Active Directory. Retrieved April 11, 2018.",
            "url": "https://en.wikipedia.org/wiki/Active_Directory"
        },
        {
            "source_name": "Metcalf 2015",
            "description": "Metcalf, S. (2015, January 19). Attackers Can Now Use Mimikatz to Implant Skeleton Key on Domain Controllers & BackDoor Your Active Directory Forest. Retrieved February 3, 2015.",
            "url": "http://adsecurity.org/?p=1275"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "credential-access"
        }
    ],
    "tactic": [
        "credential-access"
    ],
    "x_mitre_detection": "Monitor processes and command-line arguments for program execution that may be indicative of credential dumping, especially attempts to access or copy the NTDS.dit.",
    "x_mitre_data_sources": [
        "Command: Command Execution",
        "File: File Access"
    ],
    "x_mitre_permissions_required": [
        "Administrator"
    ],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [
        "Access to Domain Controller or backup"
    ],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Password Policies",
                "description": "Set and enforce secure password policies for accounts.",
                "type": "course-of-action",
                "id": "M1027"
            },
            {
                "name": "Privileged Account Management",
                "description": "Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.",
                "type": "course-of-action",
                "id": "M1026"
            },
            {
                "name": "User Training",
                "description": "Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.",
                "type": "course-of-action",
                "id": "M1017"
            },
            {
                "name": "Encrypt Sensitive Information",
                "description": "Protect sensitive information with strong encryption.",
                "type": "course-of-action",
                "id": "M1041"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that Doman controllers are backed up and secured using encryption",
                "acid": "98581948"
            },
            {
                "description": "Ensure that local administrator accounts are configured with complex and unique passwords",
                "acid": "98581949"
            },
            {
                "description": "Ensure that Privilege Access Management solutions are configured with appropriate privileges to different levels of administrative tiers",
                "acid": "98581950"
            },
            {
                "description": "Ensure that user or admin domain accounts are not configured under local administrator groups in windows",
                "acid": "98581951"
            },
            {
                "description": "Ensure that user training is provided for users which provides awareness on password usage",
                "acid": "98581952"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that processes and command-line arguments for program execution on NTDS.dit are monitored",
                "acid": "98581947"
            }
        ]
    },
    "cspcontrolIds": [
        "40000205",
        "40000499"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [
        "50110001",
        "50110003"
    ],
    "policycontrolIds": [
        "50100281",
        "50100282"
    ],
    "technologycontrolIds": [],
    "cveIds": []
}
