{
    "id": "T1059",
    "name": "Command and Scripting Interpreter",
    "x_mitre_is_subtechnique": false,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n\nThere are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).\n\nAdversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)",
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Network"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1059",
            "external_id": "T1059"
        },
        {
            "source_name": "Remote Shell Execution in Python",
            "description": "Abdou Rockikz. (2020, July). How to Execute Shell Commands in a Remote Machine in Python. Retrieved July 26, 2021.",
            "url": "https://www.thepythoncode.com/article/executing-bash-commands-remotely-in-python"
        },
        {
            "source_name": "Cisco IOS Software Integrity Assurance - Command History",
            "description": "Cisco. (n.d.). Cisco IOS Software Integrity Assurance - Command History. Retrieved October 21, 2020.",
            "url": "https://tools.cisco.com/security/center/resources/integrity_assurance.html#23"
        },
        {
            "source_name": "Powershell Remote Commands",
            "description": "Microsoft. (2020, August 21). Running Remote Commands. Retrieved July 26, 2021.",
            "url": "https://docs.microsoft.com/en-us/powershell/scripting/learn/remoting/running-remote-commands?view=powershell-7.1"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "execution"
        }
    ],
    "tactic": [
        "execution"
    ],
    "x_mitre_detection": "Command-line and scripting activities can be captured through proper logging of process execution with command-line arguments. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools. Also monitor for loading of modules associated with specific languages.\n\nIf scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.\n\nScripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information discovery, collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.",
    "x_mitre_data_sources": [
        "Script: Script Execution",
        "Process: Process Metadata",
        "Command: Command Execution",
        "Module: Module Load",
        "Process: Process Creation"
    ],
    "x_mitre_permissions_required": [],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": true,
    "relation": {
        "mitigates": [
            {
                "name": "Code Signing",
                "description": "Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.",
                "type": "course-of-action",
                "id": "M1045"
            },
            {
                "name": "Disable or Remove Feature or Program",
                "description": "Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.",
                "type": "course-of-action",
                "id": "M1042"
            },
            {
                "name": "Execution Prevention",
                "description": "Block execution of code on a system through application control, and/or script blocking.",
                "type": "course-of-action",
                "id": "M1038"
            },
            {
                "name": "Antivirus/Antimalware",
                "description": "Use signatures or heuristics to detect malicious software.",
                "type": "course-of-action",
                "id": "M1049"
            },
            {
                "name": "Privileged Account Management",
                "description": "Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.",
                "type": "course-of-action",
                "id": "M1026"
            },
            {
                "name": "Restrict Web-Based Content",
                "description": "Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.",
                "type": "course-of-action",
                "id": "M1021"
            },
            {
                "name": "Behavior Prevention on Endpoint",
                "description": "Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.",
                "type": "course-of-action",
                "id": "M1040"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that Anti-virus solutions are configured to automatically quarantine suspicious files",
                "acid": "98580150"
            },
            {
                "description": "Ensure that only signed scripts are permitted to execute",
                "acid": "98580151"
            },
            {
                "description": "Ensure that any unnecessary or unused shells or interpreters are disabled or removed",
                "acid": "98580152"
            },
            {
                "description": "Ensure that application-level controls are implemented to prevent the execution of scripts",
                "acid": "98580153"
            },
            {
                "description": "Ensure that the PowerShell execution policy is restricted to administrators",
                "acid": "98580154"
            },
            {
                "description": "Ensure that Script blocking extensions are enabled to block the execution of scripts and HTA files",
                "acid": "98580155"
            },
            {
                "description": "Ensure that adblockers are configured to prevent malicious code (served through ads) from executing in the first place",
                "acid": "98580156"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that logs for process execution with command-line arguments are captured to analyze command-line and scripting activities",
                "acid": "98580142"
            },
            {
                "description": "Ensure that the loading of modules associated with specific languages is monitored",
                "acid": "98580143"
            },
            {
                "description": "Ensure that any attempt to enable scripts by restricted user accounts should be monitored",
                "acid": "98580144"
            },
            {
                "description": "Ensure that uncommon scripts running out of cycle from patching or other administrator function should be monitored",
                "acid": "98580145"
            },
            {
                "description": "Ensure that scripts are captured from the file system(when possible) to monitor their actions and intent",
                "acid": "98580146"
            },
            {
                "description": "Ensure that processes and command-line arguments are monitored for script execution indicating suspicious behavior",
                "acid": "98580147"
            },
            {
                "description": "Ensure that processes and command-line arguments are monitored for network and system information discovery actions indicating suspicious behavior",
                "acid": "98580148"
            },
            {
                "description": "Ensure that processes and command-line arguments are monitored for scriptable post-compromise behaviors",
                "acid": "98580149"
            }
        ]
    },
    "cspcontrolIds": [
        "40000097",
        "40000117",
        "40000140",
        "40000205",
        "40000208",
        "40000219",
        "40000490",
        "40000497",
        "40000499",
        "40000501",
        "40000507",
        "40000521",
        "40000522"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [
        "50100523",
        "50101358",
        "50106008"
    ],
    "technologycontrolIds": [
        "101040066",
        "101040067",
        "10190014",
        "10190015",
        "10190049",
        "11060034",
        "11060035",
        "11100033",
        "11100034",
        "11170020",
        "11170021",
        "11490020",
        "11490021",
        "14050007",
        "14110007",
        "14120007",
        "14130007",
        "14170007",
        "16010479",
        "16020489",
        "16100531",
        "16110466",
        "16120484",
        "16130086",
        "16130087",
        "16130134",
        "16130156",
        "16460389",
        "16460390",
        "16460391",
        "18650006",
        "19010014",
        "19010015",
        "19010049",
        "19310008",
        "19310016",
        "19310017",
        "19310018",
        "19920418",
        "19920419",
        "19920451",
        "19920497"
    ],
    "cveIds": [
        "CVE-2010-3888",
        "CVE-2012-0158",
        "CVE-2012-1795",
        "CVE-2012-4681",
        "CVE-2012-6498",
        "CVE-2013-3893",
        "CVE-2014-0295",
        "CVE-2014-4114",
        "CVE-2014-5092",
        "CVE-2014-6271",
        "CVE-2014-6277",
        "CVE-2014-6293",
        "CVE-2014-7186",
        "CVE-2014-9938",
        "CVE-2015-2945",
        "CVE-2015-5254",
        "CVE-2015-6475",
        "CVE-2015-6480",
        "CVE-2015-7450",
        "CVE-2015-7912",
        "CVE-2015-8103",
        "CVE-2016-0710",
        "CVE-2016-4372",
        "CVE-2016-5062",
        "CVE-2016-9684",
        "CVE-2017-1000353",
        "CVE-2017-12500",
        "CVE-2017-12542",
        "CVE-2017-12557",
        "CVE-2017-12629",
        "CVE-2017-14094",
        "CVE-2017-14323",
        "CVE-2017-14459",
        "CVE-2017-17405",
        "CVE-2017-18362",
        "CVE-2017-5173",
        "CVE-2017-5792",
        "CVE-2017-5799",
        "CVE-2017-5815",
        "CVE-2017-5816",
        "CVE-2017-5817",
        "CVE-2017-6327",
        "CVE-2017-7411",
        "CVE-2017-7692",
        "CVE-2017-8464",
        "CVE-2017-9791",
        "CVE-2017-9805",
        "CVE-2018-0824",
        "CVE-2018-1000006",
        "CVE-2018-1000888",
        "CVE-2018-10517",
        "CVE-2018-10611",
        "CVE-2018-11048",
        "CVE-2018-11059",
        "CVE-2018-11073",
        "CVE-2018-11075",
        "CVE-2018-1133",
        "CVE-2018-11510",
        "CVE-2018-11686",
        "CVE-2018-11776",
        "CVE-2018-12464",
        "CVE-2018-12465",
        "CVE-2018-13415",
        "CVE-2018-13416",
        "CVE-2018-13417",
        "CVE-2018-14009",
        "CVE-2018-14933",
        "CVE-2018-15133",
        "CVE-2018-15393",
        "CVE-2018-15444",
        "CVE-2018-15576",
        "CVE-2018-15764",
        "CVE-2018-15776",
        "CVE-2018-17889",
        "CVE-2018-18987",
        "CVE-2018-19007",
        "CVE-2018-20221",
        "CVE-2018-20434",
        "CVE-2018-6961",
        "CVE-2018-7297",
        "CVE-2018-7448",
        "CVE-2018-7890",
        "CVE-2018-8021",
        "CVE-2018-8607",
        "CVE-2018-8735",
        "CVE-2019-0232",
        "CVE-2019-0604",
        "CVE-2019-0708",
        "CVE-2019-1031",
        "CVE-2019-10969",
        "CVE-2019-11080",
        "CVE-2019-11409",
        "CVE-2019-12725",
        "CVE-2019-12815",
        "CVE-2019-13294",
        "CVE-2019-13538",
        "CVE-2019-13597",
        "CVE-2019-1458",
        "CVE-2019-15243",
        "CVE-2019-15249",
        "CVE-2019-15280",
        "CVE-2019-15287",
        "CVE-2019-15715",
        "CVE-2019-15949",
        "CVE-2019-15954",
        "CVE-2019-15958",
        "CVE-2019-15959",
        "CVE-2019-15972",
        "CVE-2019-15976",
        "CVE-2019-15994",
        "CVE-2019-1609",
        "CVE-2019-1611",
        "CVE-2019-16112",
        "CVE-2019-1612",
        "CVE-2019-1620",
        "CVE-2019-1665",
        "CVE-2019-16662",
        "CVE-2019-16759",
        "CVE-2019-16784",
        "CVE-2019-1753",
        "CVE-2019-1768",
        "CVE-2019-1772",
        "CVE-2019-1781",
        "CVE-2019-1790",
        "CVE-2019-1812",
        "CVE-2019-18234",
        "CVE-2019-1838",
        "CVE-2019-18571",
        "CVE-2019-18578",
        "CVE-2019-18581",
        "CVE-2019-18582",
        "CVE-2019-1879",
        "CVE-2019-18935",
        "CVE-2019-1941",
        "CVE-2019-1942",
        "CVE-2019-19509",
        "CVE-2019-19609",
        "CVE-2019-2725",
        "CVE-2019-2729",
        "CVE-2019-3396",
        "CVE-2019-3704",
        "CVE-2019-3708",
        "CVE-2019-3719",
        "CVE-2019-3723",
        "CVE-2019-3727",
        "CVE-2019-3754",
        "CVE-2019-6453",
        "CVE-2019-9082",
        "CVE-2020-0618",
        "CVE-2020-0646",
        "CVE-2020-10189",
        "CVE-2020-10603",
        "CVE-2020-11010",
        "CVE-2020-11023",
        "CVE-2020-11030",
        "CVE-2020-11036",
        "CVE-2020-11055",
        "CVE-2020-11073",
        "CVE-2020-11082",
        "CVE-2020-11651",
        "CVE-2020-11819",
        "CVE-2020-11901",
        "CVE-2020-12000",
        "CVE-2020-12014",
        "CVE-2020-12029",
        "CVE-2020-14011",
        "CVE-2020-14295",
        "CVE-2020-14508",
        "CVE-2020-14510",
        "CVE-2020-1456",
        "CVE-2020-14947",
        "CVE-2020-15094",
        "CVE-2020-15096",
        "CVE-2020-15118",
        "CVE-2020-15140",
        "CVE-2020-15143",
        "CVE-2020-15147",
        "CVE-2020-15162",
        "CVE-2020-15179",
        "CVE-2020-15183",
        "CVE-2020-15188",
        "CVE-2020-15189",
        "CVE-2020-15920",
        "CVE-2020-15922",
        "CVE-2020-3121",
        "CVE-2020-3137",
        "CVE-2020-3216",
        "CVE-2020-3233",
        "CVE-2020-3240",
        "CVE-2020-3253",
        "CVE-2020-3292",
        "CVE-2020-3349",
        "CVE-2020-3356",
        "CVE-2020-3375",
        "CVE-2020-3403",
        "CVE-2020-35754",
        "CVE-2020-3956",
        "CVE-2020-5217",
        "CVE-2020-5241",
        "CVE-2020-5264",
        "CVE-2020-5266",
        "CVE-2020-5267",
        "CVE-2020-5269",
        "CVE-2020-5270",
        "CVE-2020-5271",
        "CVE-2020-5281",
        "CVE-2020-5283",
        "CVE-2020-5297",
        "CVE-2020-5332",
        "CVE-2020-5336",
        "CVE-2020-5339",
        "CVE-2020-5340",
        "CVE-2020-5350",
        "CVE-2020-6960",
        "CVE-2020-6964",
        "CVE-2020-7209",
        "CVE-2020-8163",
        "CVE-2020-8515",
        "CVE-2020-8518",
        "CVE-2020-8816",
        "CVE-2020-9374",
        "CVE-2020-9380",
        "CVE-2020-9459",
        "CVE-2020-9484",
        "CVE-2021-21972",
        "CVE-2021-22911",
        "CVE-2021-24040",
        "CVE-2021-27928",
        "CVE-2021-35464",
        "CVE-2021-42071",
        "CVE-2021-42580",
        "CVE-2021-43857",
        "CVE-2021-44228",
        "CVE-2022-23642"
    ],
    "subTechniques": [
        "T1059.001",
        "T1059.002",
        "T1059.003",
        "T1059.004",
        "T1059.005",
        "T1059.006",
        "T1059.007",
        "T1059.008"
    ]
}
