{
    "id": "T1216",
    "name": "System Script Proxy Execution",
    "x_mitre_is_subtechnique": false,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may use trusted scripts, often signed with certificates, to proxy the execution of malicious files. Several Microsoft signed scripts that have been downloaded from Microsoft or are default on Windows installations can be used to proxy execution of other files.(Citation: LOLBAS Project) This behavior may be abused by adversaries to execute malicious files that could bypass application control and signature validation on systems.(Citation: GitHub Ultimate AppLocker Bypass List)",
    "x_mitre_platforms": [
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [
        "Application control",
        "Digital Certificate Validation"
    ],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1216",
            "external_id": "T1216"
        },
        {
            "source_name": "GitHub Ultimate AppLocker Bypass List",
            "description": "Moe, O. (2018, March 1). Ultimate AppLocker Bypass List. Retrieved April 10, 2018.",
            "url": "https://github.com/api0cradle/UltimateAppLockerByPassList"
        },
        {
            "source_name": "LOLBAS Project",
            "description": "Oddvar Moe et al. (2022, February).  Living Off The Land Binaries, Scripts and Libraries. Retrieved March 7, 2022.",
            "url": "https://github.com/LOLBAS-Project/LOLBAS#criteria"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "defense-evasion"
        }
    ],
    "tactic": [
        "defense-evasion"
    ],
    "x_mitre_detection": "Monitor script processes, such as `cscript`, and command-line parameters for scripts like PubPrn.vbs that may be used to proxy execution of malicious files.",
    "x_mitre_data_sources": [
        "Process: Process Creation",
        "Script: Script Execution",
        "Command: Command Execution"
    ],
    "x_mitre_permissions_required": [],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Signed Script Proxy Execution Mitigation",
                "description": "Certain signed scripts that can be used to execute other programs may not be necessary within a given environment. Use application whitelisting configured to block execution of these scripts if they are not required for a given system or network to prevent potential misuse by adversaries.",
                "type": "course-of-action",
                "id": "T1216"
            },
            {
                "name": "Execution Prevention",
                "description": "Block execution of code on a system through application control, and/or script blocking.",
                "type": "course-of-action",
                "id": "M1038"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that signed scripts are prevented (using application control) from execution if not required within a given environment.",
                "acid": "98581669"
            },
            {
                "description": "Ensure that application whitelisting is configured to prevent the execution of signed scripts if not required for a system or network.",
                "acid": "98581670"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that monitoring solutions are configured to monitor script processes (e.g. cscript) to prevent proxy execution.",
                "acid": "98581667"
            },
            {
                "description": "Ensure that monitoring solutions are configured to monitor command-line parameters for scripts (e.g. PubPrn.vbs) to prevent proxy execution.",
                "acid": "98581668"
            }
        ]
    },
    "cspcontrolIds": [],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [
        "50106008"
    ],
    "technologycontrolIds": [
        "11490036"
    ],
    "cveIds": [],
    "subTechniques": [
        "T1216.001"
    ]
}
