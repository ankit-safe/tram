{
    "id": "T1133",
    "name": "External Remote Services",
    "x_mitre_is_subtechnique": false,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may leverage external-facing remote services to initially access and/or persist within a network. Remote services such as VPNs, Citrix, and other access mechanisms allow users to connect to internal enterprise network resources from external locations. There are often remote service gateways that manage connections and credential authentication for these services. Services such as [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006) and [VNC](https://attack.mitre.org/techniques/T1021/005) can also be used externally.(Citation: MacOS VNC software for Remote Desktop)\n\nAccess to [Valid Accounts](https://attack.mitre.org/techniques/T1078) to use the service is often a requirement, which could be obtained through credential pharming or by obtaining the credentials from users after compromising the enterprise network.(Citation: Volexity Virtual Private Keylogging) Access to remote services may be used as a redundant or persistent access mechanism during an operation.\n\nAccess may also be gained through an exposed service that doesn't require authentication. In containerized environments, this may include an exposed Docker API, Kubernetes API server, kubelet, or web application such as the Kubernetes dashboard.(Citation: Trend Micro Exposed Docker Server)(Citation: Unit 42 Hildegard Malware)",
    "x_mitre_platforms": [
        "Windows",
        "Linux",
        "Containers",
        "macOS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1133",
            "external_id": "T1133"
        },
        {
            "source_name": "Volexity Virtual Private Keylogging",
            "description": "Adair, S. (2015, October 7). Virtual Private Keylogging: Cisco Web VPNs Leveraged for Access and Persistence. Retrieved March 20, 2017.",
            "url": "https://www.volexity.com/blog/2015/10/07/virtual-private-keylogging-cisco-web-vpns-leveraged-for-access-and-persistence/"
        },
        {
            "source_name": "MacOS VNC software for Remote Desktop",
            "description": "Apple Support. (n.d.). Set up a computer running VNC software for Remote Desktop. Retrieved August 18, 2021.",
            "url": "https://support.apple.com/guide/remote-desktop/set-up-a-computer-running-vnc-software-apdbed09830/mac"
        },
        {
            "source_name": "Unit 42 Hildegard Malware",
            "description": "Chen, J. et al. (2021, February 3). Hildegard: New TeamTNT Cryptojacking Malware Targeting Kubernetes. Retrieved April 5, 2021.",
            "url": "https://unit42.paloaltonetworks.com/hildegard-malware-teamtnt/"
        },
        {
            "source_name": "Trend Micro Exposed Docker Server",
            "description": "Remillano II, A., et al. (2020, June 20). XORDDoS, Kaiji Variants Target Exposed Docker Servers. Retrieved April 5, 2021.",
            "url": "https://www.trendmicro.com/en_us/research/20/f/xorddos-kaiji-botnet-malware-variants-target-exposed-docker-servers.html"
        },
        {
            "source_name": "capec",
            "url": "https://capec.mitre.org/data/definitions/555.html",
            "external_id": "CAPEC-555"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "persistence"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "initial-access"
        }
    ],
    "tactic": [
        "persistence",
        "initial-access"
    ],
    "x_mitre_detection": "Follow best practices for detecting adversary use of [Valid Accounts](https://attack.mitre.org/techniques/T1078) for authenticating to remote services. Collect authentication logs and analyze for unusual access patterns, windows of activity, and access outside of normal business hours.\n\nWhen authentication is not required to access an exposed remote service, monitor for follow-on activities such as anomalous external use of the exposed API or application.",
    "x_mitre_data_sources": [
        "Application Log: Application Log Content",
        "Network Traffic: Network Traffic Content",
        "Network Traffic: Network Connection Creation",
        "Logon Session: Logon Session Metadata",
        "Network Traffic: Network Traffic Flow"
    ],
    "x_mitre_permissions_required": [],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Network Segmentation",
                "description": "Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.",
                "type": "course-of-action",
                "id": "M1030"
            },
            {
                "name": "Disable or Remove Feature or Program",
                "description": "Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.",
                "type": "course-of-action",
                "id": "M1042"
            },
            {
                "name": "Limit Access to Resource Over Network",
                "description": "Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.",
                "type": "course-of-action",
                "id": "M1035"
            },
            {
                "name": "External Remote Services Mitigation",
                "description": "Limit access to remote services through centrally managed concentrators such as VPNs and other managed remote access systems. Deny direct remote access to internal systems through the use of network proxies, gateways, and firewalls. Disable or block remotely available services such as [Windows Remote Management](https://attack.mitre.org/techniques/T1028). Use strong two-factor or multi-factor authentication for remote service accounts to mitigate an adversary's ability to leverage stolen credentials, but be aware of [Multi-Factor Authentication Interception](https://attack.mitre.org/techniques/T1111) techniques for some two-factor authentication implementations.",
                "type": "course-of-action",
                "id": "T1133"
            },
            {
                "name": "Multi-factor Authentication",
                "description": "Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.",
                "type": "course-of-action",
                "id": "M1032"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that unnecessary remotely available services are either disabled or blocked",
                "acid": "98580027"
            },
            {
                "description": "Ensure that VPNs (or Centrally Managed concentrators) are configured to limit access to remote services",
                "acid": "98580028"
            },
            {
                "description": "Ensure that multi-factor authentication is implemented for remote service accounts",
                "acid": "98580029"
            },
            {
                "description": "Ensure that network proxy, gateways, and firewalls are configured to deny direct remote access to internal systems",
                "acid": "98580030"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that best practices are implemented for detecting adversary use (malicious usage) of Valid Accounts for authenticating to remote services",
                "acid": "98580025"
            },
            {
                "description": "Ensure that the authentication logs are collected and analyzed for unusual access patterns (such as window of activity/access outside business hours)",
                "acid": "98580026"
            }
        ]
    },
    "cspcontrolIds": [
        "40000102",
        "40000219",
        "40000227",
        "40000491",
        "40000501",
        "40000505",
        "40000510",
        "40000511",
        "40000513",
        "40000523"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [
        "50106020",
        "50106027",
        "50106029",
        "50106030",
        "50106115"
    ],
    "technologycontrolIds": [
        "101020005",
        "101020007",
        "101020025",
        "101020026",
        "101020029",
        "101020030",
        "101020031",
        "101020032",
        "101020033",
        "101020039",
        "10110005",
        "10110007",
        "10110025",
        "10110026",
        "10110029",
        "10110030",
        "10110031",
        "10110032",
        "10110033",
        "10110039",
        "101540025",
        "101540026",
        "101540044",
        "101540045",
        "101550025",
        "101550026",
        "101550044",
        "101550045",
        "101560026",
        "101560027",
        "101560045",
        "101560046",
        "101570026",
        "101570027",
        "101570045",
        "101570046",
        "101600026",
        "101600027",
        "101600049",
        "101600050",
        "10190027",
        "10190028",
        "10190029",
        "10190030",
        "10190031",
        "10190032",
        "10190033",
        "10190034",
        "10190035",
        "10190036",
        "10190037",
        "10190038",
        "10190039",
        "10190040",
        "10190041",
        "10190042",
        "10190043",
        "10190044",
        "103900026",
        "103900027",
        "103900045",
        "103900046",
        "10460023",
        "10460026",
        "10460027",
        "10460047",
        "10460048",
        "10960069",
        "11010023",
        "11010026",
        "11010027",
        "11010047",
        "11010048",
        "14050003",
        "14050006",
        "14050008",
        "14050009",
        "14110003",
        "14110006",
        "14110008",
        "14110009",
        "14110011",
        "14120003",
        "14120006",
        "14120008",
        "14120009",
        "14130003",
        "14130006",
        "14130008",
        "14130009",
        "14170003",
        "14170006",
        "14170008",
        "14170009",
        "14170011",
        "15010049",
        "15010050",
        "15010055",
        "15010061",
        "15010062",
        "15010065",
        "15010073",
        "15010090",
        "15010091",
        "15010322",
        "15020049",
        "15020051",
        "15020056",
        "15020062",
        "15020063",
        "15020066",
        "15020076",
        "15020094",
        "15020095",
        "15020328",
        "15030049",
        "15030051",
        "15030056",
        "15030062",
        "15030063",
        "15030066",
        "15030076",
        "15030094",
        "15030095",
        "15030298",
        "15030372",
        "15040068",
        "15040070",
        "15040091",
        "15040097",
        "15040116",
        "15040123",
        "15040125",
        "15040134",
        "15040136",
        "15040301",
        "15180044",
        "15180045",
        "15180050",
        "15180057",
        "15180058",
        "15180061",
        "15180070",
        "15200049",
        "15200050",
        "15200055",
        "15200061",
        "15200062",
        "15200065",
        "15200073",
        "15200090",
        "15200091",
        "15200314",
        "16010050",
        "16010051",
        "16010056",
        "16010059",
        "16010061",
        "16010065",
        "16010066",
        "16010069",
        "16010078",
        "16010096",
        "16010097",
        "16010281",
        "16010470",
        "16010479",
        "16020050",
        "16020051",
        "16020056",
        "16020059",
        "16020061",
        "16020065",
        "16020066",
        "16020069",
        "16020078",
        "16020096",
        "16020097",
        "16020292",
        "16020480",
        "16020489",
        "16100050",
        "16100052",
        "16100057",
        "16100061",
        "16100062",
        "16100066",
        "16100067",
        "16100070",
        "16100080",
        "16100098",
        "16100099",
        "16100331",
        "16100387",
        "16100399",
        "16100522",
        "16100531",
        "16110050",
        "16110051",
        "16110056",
        "16110059",
        "16110061",
        "16110065",
        "16110066",
        "16110069",
        "16110078",
        "16110095",
        "16110096",
        "16110268",
        "16110457",
        "16110466",
        "16120050",
        "16120052",
        "16120057",
        "16120060",
        "16120062",
        "16120066",
        "16120067",
        "16120070",
        "16120080",
        "16120098",
        "16120099",
        "16120287",
        "16120475",
        "16120484",
        "16130031",
        "16130032",
        "16130033",
        "16130034",
        "16130035",
        "16130036",
        "16130037",
        "16130038",
        "16130039",
        "16130040",
        "16130041",
        "16130042",
        "16130043",
        "16130044",
        "16130045",
        "16130046",
        "16130047",
        "16130048",
        "16130049",
        "16130050",
        "16130051",
        "16130052",
        "16130053",
        "16130054",
        "16130055",
        "16130056",
        "16130057",
        "16130058",
        "16130059",
        "16130060",
        "16130061",
        "16130062",
        "16130063",
        "16130064",
        "16130065",
        "16130066",
        "16130067",
        "16130068",
        "16130069",
        "16130070",
        "16130071",
        "16130072",
        "16130073",
        "16130074",
        "16130075",
        "16130076",
        "16130078",
        "16130079",
        "16130080",
        "16130081",
        "16130082",
        "16130088",
        "16130091",
        "16130092",
        "16130093",
        "16130094",
        "16130095",
        "16130096",
        "16130097",
        "16130098",
        "16130099",
        "16130100",
        "16130101",
        "16130118",
        "16130123",
        "16130139",
        "16130140",
        "16130142",
        "16130148",
        "16130150",
        "16130154",
        "16130155",
        "16130158",
        "16130159",
        "16130160",
        "16130161",
        "16130163",
        "16130164",
        "16130166",
        "16130189",
        "16130190",
        "16130191",
        "16130192",
        "16130193",
        "16130194",
        "16130195",
        "16130221",
        "16140044",
        "16140045",
        "16140050",
        "16140052",
        "16140053",
        "16140057",
        "16140058",
        "16140061",
        "16140070",
        "16360050",
        "16360052",
        "16360057",
        "16360060",
        "16360062",
        "16360066",
        "16360067",
        "16360069",
        "16360080",
        "16360099",
        "16360100",
        "16360348",
        "16460048",
        "16460050",
        "16460055",
        "16460064",
        "16460065",
        "16460067",
        "16460078",
        "16460097",
        "16460098",
        "16460343",
        "18380046",
        "18380051",
        "18380054",
        "18380055",
        "18410012",
        "18410013",
        "18410014",
        "18410020",
        "18410022",
        "18410023",
        "18550002",
        "18640006",
        "18810001",
        "19010027",
        "19010028",
        "19010029",
        "19010030",
        "19010031",
        "19010032",
        "19010033",
        "19010034",
        "19010035",
        "19010036",
        "19010037",
        "19010038",
        "19010039",
        "19010040",
        "19010041",
        "19010042",
        "19010043",
        "19010044",
        "19920046",
        "19920048",
        "19920053",
        "19920059",
        "19920060",
        "19920062",
        "19920072",
        "19920090",
        "19920091",
        "19920269",
        "19920425",
        "19920429",
        "19920434",
        "19920461",
        "19920497",
        "21809001",
        "21811001"
    ],
    "cveIds": [
        "CVE-1999-0404",
        "CVE-2009-3023",
        "CVE-2010-2772",
        "CVE-2011-2523",
        "CVE-2012-5958",
        "CVE-2014-0751",
        "CVE-2014-9938",
        "CVE-2015-2342",
        "CVE-2015-7935",
        "CVE-2016-5180",
        "CVE-2016-6367",
        "CVE-2017-17215",
        "CVE-2018-11048",
        "CVE-2018-15444",
        "CVE-2018-19007",
        "CVE-2018-7506",
        "CVE-2019-0708",
        "CVE-2019-11510",
        "CVE-2019-11708",
        "CVE-2019-12815",
        "CVE-2019-15288",
        "CVE-2019-15821",
        "CVE-2019-15972",
        "CVE-2019-15998",
        "CVE-2019-1612",
        "CVE-2019-18234",
        "CVE-2019-1836",
        "CVE-2019-1942",
        "CVE-2020-0609",
        "CVE-2020-0610",
        "CVE-2020-10603",
        "CVE-2020-11010",
        "CVE-2020-12000",
        "CVE-2020-12029",
        "CVE-2020-15109",
        "CVE-2020-15140",
        "CVE-2020-15143",
        "CVE-2020-15147",
        "CVE-2020-15188",
        "CVE-2020-15189",
        "CVE-2020-20277",
        "CVE-2020-3198",
        "CVE-2020-3237",
        "CVE-2020-3240",
        "CVE-2020-3309",
        "CVE-2020-3387",
        "CVE-2020-4068",
        "CVE-2020-5225",
        "CVE-2020-5295",
        "CVE-2020-8794",
        "CVE-2020-8816"
    ],
    "subTechniques": []
}
