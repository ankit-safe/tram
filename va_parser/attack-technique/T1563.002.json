{
    "id": "T1563.002",
    "name": "RDP Hijacking",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may hijack a legitimate user's remote desktop session to move laterally within an environment. Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).(Citation: TechNet Remote Desktop Services)\n\nAdversaries may perform RDP session hijacking which involves stealing a legitimate user's remote session. Typically, a user is notified when someone else is trying to steal their session. With System permissions and using Terminal Services Console, `c:\\windows\\system32\\tscon.exe [session number to be stolen]`, an adversary can hijack a session without the need for credentials or prompts to the user.(Citation: RDP Hijacking Korznikov) This can be done remotely or locally and with active or disconnected sessions.(Citation: RDP Hijacking Medium) It can also lead to [Remote System Discovery](https://attack.mitre.org/techniques/T1018) and Privilege Escalation by stealing a Domain Admin or higher privileged account session. All of this can be done by using native Windows commands, but it has also been added as a feature in red teaming tools.(Citation: Kali Redsnarf)",
    "x_mitre_platforms": [
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1563/002",
            "external_id": "T1563.002"
        },
        {
            "source_name": "TechNet Remote Desktop Services",
            "description": "Microsoft. (n.d.). Remote Desktop Services. Retrieved June 1, 2016.",
            "url": "https://technet.microsoft.com/en-us/windowsserver/ee236407.aspx"
        },
        {
            "source_name": "RDP Hijacking Korznikov",
            "description": "Korznikov, A. (2017, March 17). Passwordless RDP Session Hijacking Feature All Windows versions. Retrieved December 11, 2017.",
            "url": "http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html"
        },
        {
            "source_name": "RDP Hijacking Medium",
            "description": "Beaumont, K. (2017, March 19). RDP hijacking\u200a\u2014\u200ahow to hijack RDS and RemoteApp sessions transparently to move through an organisation. Retrieved December 11, 2017.",
            "url": "https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6"
        },
        {
            "source_name": "Kali Redsnarf",
            "description": "NCC Group PLC. (2016, November 1). Kali Redsnarf. Retrieved December 11, 2017.",
            "url": "https://github.com/nccgroup/redsnarf"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "lateral-movement"
        }
    ],
    "tactic": [
        "lateral-movement"
    ],
    "x_mitre_detection": "Consider monitoring processes for `tscon.exe` usage and monitor service creation that uses `cmd.exe /k` or `cmd.exe /c` in its arguments to detect RDP session hijacking.\n\nUse of RDP may be legitimate, depending on the network environment and how it is used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP.",
    "x_mitre_data_sources": [
        "Logon Session: Logon Session Creation",
        "Command: Command Execution",
        "Process: Process Creation",
        "Network Traffic: Network Traffic Flow",
        "Network Traffic: Network Traffic Content"
    ],
    "x_mitre_permissions_required": [
        "SYSTEM"
    ],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Limit Access to Resource Over Network",
                "description": "Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.",
                "type": "course-of-action",
                "id": "M1035"
            },
            {
                "name": "Network Segmentation",
                "description": "Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.",
                "type": "course-of-action",
                "id": "M1030"
            },
            {
                "name": "Operating System Configuration",
                "description": "Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.",
                "type": "course-of-action",
                "id": "M1028"
            },
            {
                "name": "User Account Management",
                "description": "Manage the creation, modification, use, and permissions associated to user accounts.",
                "type": "course-of-action",
                "id": "M1018"
            },
            {
                "name": "Audit",
                "description": "Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.",
                "type": "course-of-action",
                "id": "M1047"
            },
            {
                "name": "Disable or Remove Feature or Program",
                "description": "Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.",
                "type": "course-of-action",
                "id": "M1042"
            },
            {
                "name": "Privileged Account Management",
                "description": "Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.",
                "type": "course-of-action",
                "id": "M1026"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that Remote Desktop Users group membership is audited regularly.",
                "acid": "98582223"
            },
            {
                "description": "Ensure that accounts and groups are removed from Remote Desktop Users groups if not required.",
                "acid": "98582224"
            },
            {
                "description": "Ensure that RDP service is disabled if not necessary.",
                "acid": "98582225"
            },
            {
                "description": "Ensure that remote desktop gateways are used to limit resource access.",
                "acid": "98582226"
            },
            {
                "description": "Ensure that Firewall rules are configured to block RDP traffic between network security zones within a network.",
                "acid": "98582227"
            },
            {
                "description": "Ensure that GPOs settings are configured properly to minimize timeout sessions.",
                "acid": "98582228"
            },
            {
                "description": "Ensure that GPOs settings are configured properly to define maximize active time for single session.",
                "acid": "98582229"
            },
            {
                "description": "Ensure that GPOs settings are configured properly to specify the maximum amount of time a disconnected session stays active on the RD session host server.",
                "acid": "98582230"
            },
            {
                "description": "Ensure that local Administrators group are removed from the list of groups allowed to log in through RDP.",
                "acid": "98582231"
            },
            {
                "description": "Ensure that remote access permissions are limited for remote user.",
                "acid": "98582232"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that usage of tscon.exe processes is monitored to detect RDP session hijacking.",
                "acid": "98582220"
            },
            {
                "description": "Ensure that service creation that uses cmd.exe /k or cmd.exe /c in its arguments are monitored to detect RDP session hijacking.",
                "acid": "98582221"
            },
            {
                "description": "Ensure that system is monitored for access patterns and activity that occurs after a remote login to detect malicious behavior with RDP.",
                "acid": "98582222"
            }
        ]
    },
    "cspcontrolIds": [
        "40000097",
        "40000205",
        "40000490",
        "40000499"
    ],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [],
    "technologycontrolIds": [
        "101020023",
        "10110023",
        "15010094",
        "15020098",
        "15030098",
        "15040094",
        "15180087",
        "15200094",
        "16010100",
        "16020100",
        "16020465",
        "16020466",
        "16100103",
        "16100507",
        "16100508",
        "16110098",
        "16120102",
        "16120460",
        "16120461",
        "16140087",
        "16360103",
        "16460101",
        "19920094",
        "19920445",
        "19920458",
        "19920465"
    ],
    "cveIds": []
}
