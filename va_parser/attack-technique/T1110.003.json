{
    "id": "T1110.003",
    "name": "Password Spraying",
    "x_mitre_is_subtechnique": true,
    "revoked": false,
    "x_mitre_deprecated": false,
    "description": "Adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials. Password spraying uses one password (e.g. 'Password01'), or a small list of commonly used passwords, that may match the complexity policy of the domain. Logins are attempted with that password against many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords. (Citation: BlackHillsInfosec Password Spraying)\n\nTypically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following:\n\n* SSH (22/TCP)\n* Telnet (23/TCP)\n* FTP (21/TCP)\n* NetBIOS / SMB / Samba (139/TCP & 445/TCP)\n* LDAP (389/TCP)\n* Kerberos (88/TCP)\n* RDP / Terminal Services (3389/TCP)\n* HTTP/HTTP Management Services (80/TCP & 443/TCP)\n* MSSQL (1433/TCP)\n* Oracle (1521/TCP)\n* MySQL (3306/TCP)\n* VNC (5900/TCP)\n\nIn addition to management services, adversaries may \"target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,\" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)\n\nIn default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows \"logon failure\" event ID 4625.",
    "x_mitre_platforms": [
        "Windows",
        "Azure AD",
        "Office 365",
        "SaaS",
        "IaaS",
        "Linux",
        "macOS",
        "Google Workspace",
        "Containers"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_defense_bypassed": [],
    "external_references": [
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1110/003",
            "external_id": "T1110.003"
        },
        {
            "source_name": "capec",
            "url": "https://capec.mitre.org/data/definitions/565.html",
            "external_id": "CAPEC-565"
        },
        {
            "source_name": "BlackHillsInfosec Password Spraying",
            "description": "Thyer, J. (2015, October 30). Password Spraying & Other Fun with RPCCLIENT. Retrieved April 25, 2017.",
            "url": "http://www.blackhillsinfosec.com/?p=4645"
        },
        {
            "source_name": "US-CERT TA18-068A 2018",
            "description": "US-CERT. (2018, March 27). TA18-068A Brute Force Attacks Conducted by Cyber Actors. Retrieved October 2, 2019.",
            "url": "https://www.us-cert.gov/ncas/alerts/TA18-086A"
        },
        {
            "source_name": "Trimarc Detecting Password Spraying",
            "description": "Metcalf, S. (2018, May 6). Trimarc Research: Detecting Password Spraying with Security Event Auditing. Retrieved January 16, 2019.",
            "url": "https://www.trimarcsecurity.com/single-post/2018/05/06/Trimarc-Research-Detecting-Password-Spraying-with-Security-Event-Auditing"
        }
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "credential-access"
        }
    ],
    "tactic": [
        "credential-access"
    ],
    "x_mitre_detection": "Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). Specifically, monitor for many failed authentication attempts across various accounts that may result from password spraying attempts.\n\nConsider the following event IDs:(Citation: Trimarc Detecting Password Spraying)\n\n* Domain Controllers: \"Audit Logon\" (Success & Failure) for event ID 4625.\n* Domain Controllers: \"Audit Kerberos Authentication Service\" (Success & Failure) for event ID 4771.\n* All systems: \"Audit Logon\" (Success & Failure) for event ID 4648.",
    "x_mitre_data_sources": [
        "User Account: User Account Authentication",
        "Application Log: Application Log Content"
    ],
    "x_mitre_permissions_required": [
        "User"
    ],
    "x_mitre_effective_permissions": [],
    "x_mitre_system_requirements": [],
    "x_mitre_remote_support": false,
    "relation": {
        "mitigates": [
            {
                "name": "Multi-factor Authentication",
                "description": "Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.",
                "type": "course-of-action",
                "id": "M1032"
            },
            {
                "name": "Password Policies",
                "description": "Set and enforce secure password policies for accounts.",
                "type": "course-of-action",
                "id": "M1027"
            },
            {
                "name": "Account Use Policies",
                "description": "Configure features related to account use like login attempt lockouts, specific login times, etc.",
                "type": "course-of-action",
                "id": "M1036"
            }
        ]
    },
    "mitigationRequirements": {
        "requirements": [
            {
                "description": "Ensure that account lockout policies are configured to deny access to an account after a certain number of failed login attempts to an account",
                "acid": "98581834"
            },
            {
                "description": "Ensure that multi-factor authentication is used (for all the business-critical applications)",
                "acid": "98581835"
            },
            {
                "description": "Ensure that multi-factor authentication is used on externally facing services (wherever possible)",
                "acid": "98581836"
            }
        ]
    },
    "detectionRequirements": {
        "requirements": [
            {
                "description": "Ensure that authentication logs for systems and application login failures of valid accounts are monitored",
                "acid": "98581830"
            },
            {
                "description": "Ensure that event ID: 4625 for Domain Controllers: \"Audit Login\" (Success & Failure) is monitored",
                "acid": "98581831"
            },
            {
                "description": "Ensure that event ID: 4771 for Domain Controllers: \"Audit Kerberos Authentication Service\" (Success & Failure) is monitored",
                "acid": "98581832"
            },
            {
                "description": "Ensure that event ID: 4648 for All systems: \"Audit Login\" (Success & Failure) is monitored",
                "acid": "98581833"
            }
        ]
    },
    "cspcontrolIds": [],
    "externalcontrolIds": [],
    "peoplecontrolIds": [],
    "policycontrolIds": [
        "50101752",
        "50102697",
        "50102779"
    ],
    "technologycontrolIds": [
        "11490004",
        "15010007",
        "15010008",
        "15010009",
        "15010142",
        "15010143",
        "15010144",
        "15010145",
        "15010147",
        "15010151",
        "15010156",
        "15010157",
        "15010158",
        "15010161",
        "15020007",
        "15020008",
        "15020009",
        "15020135",
        "15020136",
        "15020137",
        "15020138",
        "15020140",
        "15020144",
        "15020147",
        "15020150",
        "15020151",
        "15020154",
        "15030007",
        "15030008",
        "15030009",
        "15030145",
        "15030146",
        "15030147",
        "15030148",
        "15030150",
        "15030156",
        "15030158",
        "15030161",
        "15030162",
        "15030163",
        "15030166",
        "15040001",
        "15040002",
        "15040003",
        "15040010",
        "15040014",
        "15040015",
        "15040019",
        "15040020",
        "15040025",
        "15040028",
        "15040034",
        "15040036",
        "15040043",
        "15040044",
        "15040045",
        "15040050",
        "15040056",
        "15040058",
        "15040060",
        "15180007",
        "15180009",
        "15200007",
        "15200008",
        "15200009",
        "15200142",
        "15200143",
        "15200144",
        "15200145",
        "15200147",
        "15200151",
        "15200156",
        "15200157",
        "15200158",
        "15200161",
        "16010007",
        "16010008",
        "16010009",
        "16010148",
        "16010149",
        "16010150",
        "16010151",
        "16010152",
        "16010154",
        "16010160",
        "16010165",
        "16010166",
        "16010167",
        "16010170",
        "16020007",
        "16020008",
        "16020009",
        "16020147",
        "16020148",
        "16020149",
        "16020150",
        "16020151",
        "16020153",
        "16020159",
        "16020162",
        "16020165",
        "16020166",
        "16020167",
        "16020170",
        "16100007",
        "16100008",
        "16100009",
        "16100149",
        "16100150",
        "16100151",
        "16100152",
        "16100153",
        "16100157",
        "16100163",
        "16100166",
        "16100169",
        "16100170",
        "16100171",
        "16100174",
        "16110007",
        "16110008",
        "16110009",
        "16110146",
        "16110147",
        "16110148",
        "16110149",
        "16110150",
        "16110152",
        "16110158",
        "16110163",
        "16110164",
        "16110165",
        "16110168",
        "16120007",
        "16120008",
        "16120009",
        "16120150",
        "16120151",
        "16120152",
        "16120153",
        "16120154",
        "16120156",
        "16120162",
        "16120165",
        "16120168",
        "16120169",
        "16120170",
        "16120173",
        "16130023",
        "16140007",
        "16140008",
        "16140009",
        "16360007",
        "16360008",
        "16360009",
        "16360145",
        "16360146",
        "16360148",
        "16360149",
        "16360150",
        "16360151",
        "16360153",
        "16360161",
        "16360165",
        "16360166",
        "16360167",
        "16360171",
        "16360173",
        "16360174",
        "16360175",
        "16360178",
        "16390019",
        "16460006",
        "16460007",
        "16460144",
        "16460145",
        "16460147",
        "16460148",
        "16460149",
        "16460150",
        "16460152",
        "16460160",
        "16460164",
        "16460165",
        "16460166",
        "16460170",
        "16460172",
        "16460173",
        "16460174",
        "16460177",
        "16460393",
        "16460394",
        "16460395",
        "19120007",
        "19120008",
        "19120009",
        "19120011",
        "19120013",
        "19920006",
        "19920007",
        "19920136",
        "19920137",
        "19920139",
        "19920145",
        "19920147",
        "19920150",
        "19920151",
        "19920152",
        "19920155",
        "19920402",
        "19920420",
        "19920444",
        "19920473",
        "19920495",
        "19920498"
    ],
    "cveIds": []
}
