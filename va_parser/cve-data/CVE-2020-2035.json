{
    "title": "When SSL/TLS Forward Proxy Decryption mode has been configured to decrypt the web transactions, the PAN-OS URL filtering feature inspects the HTTP Host and URL path headers for policy enforcement on the decrypted HTTPS web transactions but does not consider Server Name Indication (SNI) field within the TLS Client Hello handshake. This allows a compromised host in a protected network to evade any security policy that uses URL filtering on a firewall configured with SSL Decryption in the Forward Proxy mode. A malicious actor can then use this technique to evade detection of communication on the TLS handshake phase between a compromised host and a remote malicious server. This technique does not increase the risk of a host being compromised in the network. It does not impact the confidentiality or availability of a firewall. This is considered to have a low impact on the integrity of the firewall because the firewall fails to enforce a policy on certain traffic that should have been blocked. This issue does not impact the URL filtering policy enforcement on clear text or encrypted web transactions. This technique can be used only after a malicious actor has compromised a host in the protected network and the TLS/SSL Decryption feature is enabled for the traffic that the attacker controls. Palo Alto Networks is not aware of any malware that uses this technique to exfiltrate data. This issue is applicable to all current versions of PAN-OS. This issue does not impact Panorama or WF-500 appliances.",
    "score": 3.0,
    "severity": "LOW",
    "cwe_id": "NVD-CWE-noinfo",
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:L/A:N",
    "cpe_match": [
        "cpe:2.3:o:paloaltonetworks:pan-os:*:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1505.003",
            "confidence": "98.3",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1016",
            "confidence": "19.1",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "6.2",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1082",
            "confidence": "2.6",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1090",
            "confidence": "6.1",
            "techniqueName": "Proxy"
        },
        {
            "techniqueId": "T1106",
            "confidence": "11.9",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1129",
            "confidence": "2.3",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1219",
            "confidence": "2.4",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "3.2",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1055",
            "confidence": "3.7",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1068",
            "confidence": "3.0",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1071",
            "confidence": "18.5",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1082",
            "confidence": "10.4",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.8",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1090.004",
            "confidence": "2.2",
            "techniqueName": "Domain Fronting"
        },
        {
            "techniqueId": "T1203",
            "confidence": "2.6",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1219",
            "confidence": "3.1",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1543",
            "confidence": "2.1",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1548.003",
            "confidence": "2.5",
            "techniqueName": "Sudo and Sudo Caching"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "4.2",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1016",
            "confidence": "68.0",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "2.8",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1219",
            "confidence": "2.1",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1056",
            "confidence": "5.1",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1106",
            "confidence": "2.7",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "6.5",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "8.9",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1219",
            "confidence": "25.7",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "5.6",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1489",
            "confidence": "4.4",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "3.7",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1056",
            "confidence": "2.4",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1069",
            "confidence": "2.6",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1115",
            "confidence": "3.2",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.0",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1201",
            "confidence": "4.8",
            "techniqueName": "Password Policy Discovery"
        },
        {
            "techniqueId": "T1218",
            "confidence": "3.6",
            "techniqueName": "System Binary Proxy Execution"
        },
        {
            "techniqueId": "T1219",
            "confidence": "16.5",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "4.2",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1542.003",
            "confidence": "2.3",
            "techniqueName": "Bootkit"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "2.5",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1546.006",
            "confidence": "2.5",
            "techniqueName": "LC_LOAD_DYLIB Addition"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "3.7",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1087",
            "confidence": "2.6",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.9",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1190",
            "confidence": "2.6",
            "techniqueName": "Exploit Public-Facing Application"
        },
        {
            "techniqueId": "T1210",
            "confidence": "2.2",
            "techniqueName": "Exploitation of Remote Services"
        },
        {
            "techniqueId": "T1486",
            "confidence": "8.2",
            "techniqueName": "Data Encrypted for Impact"
        },
        {
            "techniqueId": "T1489",
            "confidence": "4.0",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "8.0",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1016",
            "confidence": "6.1",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1036",
            "confidence": "15.7",
            "techniqueName": "Masquerading"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.4",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1082",
            "confidence": "3.6",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "6.5",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "22.1",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1219",
            "confidence": "2.8",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "4.9",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1566.001",
            "confidence": "5.8",
            "techniqueName": "Spearphishing Attachment"
        },
        {
            "techniqueId": "T1574.002",
            "confidence": "2.5",
            "techniqueName": "DLL Side-Loading"
        },
        {
            "techniqueId": "T1048",
            "confidence": "4.5",
            "techniqueName": "Exfiltration Over Alternative Protocol"
        },
        {
            "techniqueId": "T1055",
            "confidence": "10.4",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1059",
            "confidence": "20.7",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1070.004",
            "confidence": "2.7",
            "techniqueName": "File Deletion"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.3",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.7",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1204",
            "confidence": "6.4",
            "techniqueName": "User Execution"
        },
        {
            "techniqueId": "T1210",
            "confidence": "2.9",
            "techniqueName": "Exploitation of Remote Services"
        },
        {
            "techniqueId": "T1489",
            "confidence": "5.2",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1003",
            "confidence": "2.7",
            "techniqueName": "OS Credential Dumping"
        },
        {
            "techniqueId": "T1007",
            "confidence": "2.1",
            "techniqueName": "System Service Discovery"
        },
        {
            "techniqueId": "T1033",
            "confidence": "3.0",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1055",
            "confidence": "2.3",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.5",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1082",
            "confidence": "4.6",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.1",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1221",
            "confidence": "2.6",
            "techniqueName": "Template Injection"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.7",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1543",
            "confidence": "2.2",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.0",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "2.9",
            "techniqueName": "Account Discovery"
        }
    ]
}
