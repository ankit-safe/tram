{
    "title": "In OSSEC-HIDS 2.7 through 3.5.0, the OS_CleanMSG function in ossec-analysisd doesnt remove or encode terminal control characters or newlines from processed log messages. In many cases, those characters are later logged. Because newlines (n) are permitted in messages processed by ossec-analysisd, it may be possible to inject nested events into the ossec log. Use of terminal control characters may allow obfuscating events or executing commands when viewed through vulnerable terminal emulators. This may be an unauthenticated remote attack for certain types and origins of logged data.",
    "score": 9.8,
    "severity": "CRITICAL",
    "cwe_id": "CWE-20",
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cpe_match": [
        "cpe:2.3:a:ossec:ossec:*:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "technique_id": "T1027",
            "confidence": "2.2",
            "technique_name": "Obfuscated Files or Information"
        },
        {
            "technique_id": "T1056",
            "confidence": "4.7",
            "technique_name": "Input Capture"
        },
        {
            "technique_id": "T1056.004",
            "confidence": "2.8",
            "technique_name": "Credential API Hooking"
        },
        {
            "technique_id": "T1069",
            "confidence": "2.6",
            "technique_name": "Permission Groups Discovery"
        },
        {
            "technique_id": "T1115",
            "confidence": "5.0",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1140",
            "confidence": "4.1",
            "technique_name": "Deobfuscate/Decode Files or Information"
        },
        {
            "technique_id": "T1201",
            "confidence": "2.3",
            "technique_name": "Password Policy Discovery"
        },
        {
            "technique_id": "T1218",
            "confidence": "3.2",
            "technique_name": "System Binary Proxy Execution"
        },
        {
            "technique_id": "T1219",
            "confidence": "4.8",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "5.2",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1542.003",
            "confidence": "3.2",
            "technique_name": "Bootkit"
        },
        {
            "technique_id": "T1546.004",
            "confidence": "5.7",
            "technique_name": "Unix Shell Configuration Modification"
        },
        {
            "technique_id": "T1546.006",
            "confidence": "3.8",
            "technique_name": "LC_LOAD_DYLIB Addition"
        },
        {
            "technique_id": "T1546.009",
            "confidence": "8.1",
            "technique_name": "AppCert DLLs"
        },
        {
            "technique_id": "T1546.010",
            "confidence": "3.1",
            "technique_name": "AppInit DLLs"
        },
        {
            "technique_id": "T1558.003",
            "confidence": "2.3",
            "technique_name": "Kerberoasting"
        },
        {
            "technique_id": "T1562.003",
            "confidence": "5.8",
            "technique_name": "Impair Command History Logging"
        },
        {
            "technique_id": "T1016",
            "confidence": "3.4",
            "technique_name": "System Network Configuration Discovery"
        },
        {
            "technique_id": "T1056.004",
            "confidence": "2.3",
            "technique_name": "Credential API Hooking"
        },
        {
            "technique_id": "T1069",
            "confidence": "3.7",
            "technique_name": "Permission Groups Discovery"
        },
        {
            "technique_id": "T1106",
            "confidence": "10.2",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1115",
            "confidence": "8.3",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1129",
            "confidence": "5.2",
            "technique_name": "Shared Modules"
        },
        {
            "technique_id": "T1201",
            "confidence": "2.1",
            "technique_name": "Password Policy Discovery"
        },
        {
            "technique_id": "T1218",
            "confidence": "2.9",
            "technique_name": "System Binary Proxy Execution"
        },
        {
            "technique_id": "T1219",
            "confidence": "11.8",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "10.2",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1542.003",
            "confidence": "3.8",
            "technique_name": "Bootkit"
        },
        {
            "technique_id": "T1546.004",
            "confidence": "4.0",
            "technique_name": "Unix Shell Configuration Modification"
        },
        {
            "technique_id": "T1546.006",
            "confidence": "2.9",
            "technique_name": "LC_LOAD_DYLIB Addition"
        },
        {
            "technique_id": "T1546.009",
            "confidence": "2.1",
            "technique_name": "AppCert DLLs"
        },
        {
            "technique_id": "T1557.001",
            "confidence": "3.3",
            "technique_name": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "technique_id": "T1562.003",
            "confidence": "4.0",
            "technique_name": "Impair Command History Logging"
        },
        {
            "technique_id": "T1053",
            "confidence": "2.1",
            "technique_name": "Scheduled Task/Job"
        },
        {
            "technique_id": "T1056",
            "confidence": "4.7",
            "technique_name": "Input Capture"
        },
        {
            "technique_id": "T1056.004",
            "confidence": "3.4",
            "technique_name": "Credential API Hooking"
        },
        {
            "technique_id": "T1106",
            "confidence": "5.2",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1115",
            "confidence": "2.5",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1123",
            "confidence": "2.7",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1140",
            "confidence": "2.1",
            "technique_name": "Deobfuscate/Decode Files or Information"
        },
        {
            "technique_id": "T1190",
            "confidence": "8.1",
            "technique_name": "Exploit Public-Facing Application"
        },
        {
            "technique_id": "T1201",
            "confidence": "2.1",
            "technique_name": "Password Policy Discovery"
        },
        {
            "technique_id": "T1218",
            "confidence": "2.2",
            "technique_name": "System Binary Proxy Execution"
        },
        {
            "technique_id": "T1219",
            "confidence": "7.1",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "4.3",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1542.003",
            "confidence": "2.4",
            "technique_name": "Bootkit"
        },
        {
            "technique_id": "T1546.009",
            "confidence": "2.3",
            "technique_name": "AppCert DLLs"
        },
        {
            "technique_id": "T1547.008",
            "confidence": "2.2",
            "technique_name": "LSASS Driver"
        },
        {
            "technique_id": "T1562.003",
            "confidence": "4.4",
            "technique_name": "Impair Command History Logging"
        },
        {
            "technique_id": "T1115",
            "confidence": "2.6",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1546.009",
            "confidence": "3.1",
            "technique_name": "AppCert DLLs"
        },
        {
            "technique_id": "T1003",
            "confidence": "2.5",
            "technique_name": "OS Credential Dumping"
        }
    ]
}
