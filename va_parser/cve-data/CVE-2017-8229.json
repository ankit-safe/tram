{
    "title": "Amcrest IPM-721S V2.420.AC00.16.R.20160909 devices allow an unauthenticated attacker to download the administrative credentials. If the firmware version V2.420.AC00.16.R 9/9/2016 is dissected using binwalk tool, one obtains a _user-x.squashfs.img.extracted archive which contains the filesystem set up on the device that many of the binaries in the /usr folder. The binary sonia is the one that has the vulnerable function that sets up the default credentials on the device. If one opens this binary in IDA-pro one will notice that this follows a ARM little endian format. The function sub_436D6 in IDA pro is identified to be setting up the configuration for the device. If one scrolls to the address 0x000437C2 then one can see that /current_config is being set as an ALIAS for /mnt/mtd/Config folder on the device. If one TELNETs into the device and navigates to /mnt/mtd/Config folder, one can observe that it contains various files such as Account1, Account2, SHAACcount1, etc. This means that if one navigates to http://[IPofcamera]/current_config/Sha1Account1 then one should be able to view the content of the files. The security researchers assumed that this was only possible only after authentication to the device. However, when unauthenticated access tests were performed for the same URL as provided above, it was observed that the device file could be downloaded without any authentication.",
    "score": 9.8,
    "severity": "CRITICAL",
    "cwe_id": "CWE-255",
    "cvss_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cpe_match": [
        "cpe:2.3:o:amcrest:ipm-721s_firmware:*:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1036",
            "confidence": "2.0",
            "techniqueName": "Masquerading"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.5",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1105",
            "confidence": "13.4",
            "techniqueName": "Ingress Tool Transfer"
        },
        {
            "techniqueId": "T1003",
            "confidence": "25.8",
            "techniqueName": "OS Credential Dumping"
        },
        {
            "techniqueId": "T1036",
            "confidence": "2.2",
            "techniqueName": "Masquerading"
        },
        {
            "techniqueId": "T1057",
            "confidence": "3.7",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "6.9",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.3",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.1",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1548.003",
            "confidence": "5.3",
            "techniqueName": "Sudo and Sudo Caching"
        },
        {
            "techniqueId": "T1566.002",
            "confidence": "5.9",
            "techniqueName": "Spearphishing Link"
        },
        {
            "techniqueId": "T1003",
            "confidence": "3.4",
            "techniqueName": "OS Credential Dumping"
        },
        {
            "techniqueId": "T1036",
            "confidence": "2.3",
            "techniqueName": "Masquerading"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.7",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "3.5",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1105",
            "confidence": "3.9",
            "techniqueName": "Ingress Tool Transfer"
        },
        {
            "techniqueId": "T1566.002",
            "confidence": "2.8",
            "techniqueName": "Spearphishing Link"
        },
        {
            "techniqueId": "T1007",
            "confidence": "2.4",
            "techniqueName": "System Service Discovery"
        },
        {
            "techniqueId": "T1082",
            "confidence": "6.5",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1115",
            "confidence": "7.1",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "7.3",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "5.6",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1140",
            "confidence": "4.1",
            "techniqueName": "Deobfuscate/Decode Files or Information"
        },
        {
            "techniqueId": "T1218",
            "confidence": "2.1",
            "techniqueName": "System Binary Proxy Execution"
        },
        {
            "techniqueId": "T1219",
            "confidence": "7.4",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "4.6",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1489",
            "confidence": "6.2",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "2.2",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1546.006",
            "confidence": "4.4",
            "techniqueName": "LC_LOAD_DYLIB Addition"
        },
        {
            "techniqueId": "T1057",
            "confidence": "4.1",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "3.5",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1087",
            "confidence": "7.4",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.8",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "6.2",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1566.001",
            "confidence": "2.4",
            "techniqueName": "Spearphishing Attachment"
        },
        {
            "techniqueId": "T1016",
            "confidence": "96.5",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1016",
            "confidence": "43.5",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "4.9",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1057",
            "confidence": "8.4",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "18.5",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1115",
            "confidence": "2.5",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1482",
            "confidence": "2.6",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1016",
            "confidence": "2.5",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "4.3",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "2.5",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1071",
            "confidence": "5.9",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1102",
            "confidence": "2.7",
            "techniqueName": "Web Service"
        },
        {
            "techniqueId": "T1105",
            "confidence": "9.5",
            "techniqueName": "Ingress Tool Transfer"
        },
        {
            "techniqueId": "T1106",
            "confidence": "5.1",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "2.0",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1129",
            "confidence": "4.4",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1135",
            "confidence": "6.8",
            "techniqueName": "Network Share Discovery"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "2.1",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "4.2",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1057",
            "confidence": "6.5",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1068",
            "confidence": "2.2",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1083",
            "confidence": "3.8",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "6.4",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1203",
            "confidence": "2.6",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1221",
            "confidence": "2.2",
            "techniqueName": "Template Injection"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "6.4",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1548.003",
            "confidence": "2.6",
            "techniqueName": "Sudo and Sudo Caching"
        },
        {
            "techniqueId": "T1566.002",
            "confidence": "4.2",
            "techniqueName": "Spearphishing Link"
        },
        {
            "techniqueId": "T1057",
            "confidence": "4.0",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "20.9",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.3",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1105",
            "confidence": "4.6",
            "techniqueName": "Ingress Tool Transfer"
        },
        {
            "techniqueId": "T1203",
            "confidence": "6.5",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "2.0",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1566.002",
            "confidence": "2.4",
            "techniqueName": "Spearphishing Link"
        }
    ]
}
