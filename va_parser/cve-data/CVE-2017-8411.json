{
    "title": "An issue was discovered on D-Link DCS-1130 devices. The device provides a user with the capability of setting a SMB folder for the video clippings recorded by the device. It seems that the POST parameters passed in this request (to test if email credentials and hostname sent to the device work properly) result in being passed as commands to a system API in the function and thus result in command injection on the device. If the firmware version is dissected using binwalk tool, we obtain a cramfs-root archive which contains the filesystem set up on the device that contains all the binaries. The library libmailutils.so is the one that has the vulnerable function sub_1FC4 that receives the values sent by the POST request. If we open this binary in IDA-pro we will notice that this follows an ARM little endian format. The function sub_1FC4 in IDA pro is identified to be receiving the values sent in the POST request and the value set in POST parameter receiver1 is extracted in function sub_15AC which is then passed to the vulnerable system API call. The vulnerable library function is accessed in cgibox binary at address 0x00023BCC which calls the Send_mail function in libmailutils.so binary as shown below which results in the vulnerable POST parameter being passed to the library which results in the command injection issue.",
    "score": 8.8,
    "severity": "HIGH",
    "cwe_id": "CWE-77",
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cpe_match": [
        "cpe:2.3:o:dlink:dcs-1130_firmware:-:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1003",
            "confidence": "2.4",
            "techniqueName": "OS Credential Dumping"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.2",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.3",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1068",
            "confidence": "2.5",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1083",
            "confidence": "6.0",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.4",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "4.2",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1204",
            "confidence": "4.9",
            "techniqueName": "User Execution"
        },
        {
            "techniqueId": "T1210",
            "confidence": "2.0",
            "techniqueName": "Exploitation of Remote Services"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.4",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "2.2",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1033",
            "confidence": "3.5",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1036",
            "confidence": "2.0",
            "techniqueName": "Masquerading"
        },
        {
            "techniqueId": "T1083",
            "confidence": "9.1",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1114.001",
            "confidence": "2.0",
            "techniqueName": "Local Email Collection"
        },
        {
            "techniqueId": "T1125",
            "confidence": "2.9",
            "techniqueName": "Video Capture"
        },
        {
            "techniqueId": "T1134",
            "confidence": "2.7",
            "techniqueName": "Access Token Manipulation"
        },
        {
            "techniqueId": "T1548.003",
            "confidence": "2.6",
            "techniqueName": "Sudo and Sudo Caching"
        },
        {
            "techniqueId": "T1550.001",
            "confidence": "2.4",
            "techniqueName": "Application Access Token"
        },
        {
            "techniqueId": "T1566.002",
            "confidence": "2.1",
            "techniqueName": "Spearphishing Link"
        },
        {
            "techniqueId": "T1003",
            "confidence": "20.2",
            "techniqueName": "OS Credential Dumping"
        },
        {
            "techniqueId": "T1037",
            "confidence": "2.0",
            "techniqueName": "Boot or Logon Initialization Scripts"
        },
        {
            "techniqueId": "T1048",
            "confidence": "2.0",
            "techniqueName": "Exfiltration Over Alternative Protocol"
        },
        {
            "techniqueId": "T1055",
            "confidence": "7.2",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1082",
            "confidence": "5.8",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.4",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1190",
            "confidence": "2.6",
            "techniqueName": "Exploit Public-Facing Application"
        },
        {
            "techniqueId": "T1203",
            "confidence": "4.6",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1486",
            "confidence": "14.9",
            "techniqueName": "Data Encrypted for Impact"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.3",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1003",
            "confidence": "43.9",
            "techniqueName": "OS Credential Dumping"
        },
        {
            "techniqueId": "T1041",
            "confidence": "2.3",
            "techniqueName": "Exfiltration Over C2 Channel"
        },
        {
            "techniqueId": "T1123",
            "confidence": "4.7",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1125",
            "confidence": "2.3",
            "techniqueName": "Video Capture"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.6",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1003",
            "confidence": "5.2",
            "techniqueName": "OS Credential Dumping"
        },
        {
            "techniqueId": "T1041",
            "confidence": "4.6",
            "techniqueName": "Exfiltration Over C2 Channel"
        },
        {
            "techniqueId": "T1083",
            "confidence": "8.3",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1115",
            "confidence": "2.3",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "7.8",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1125",
            "confidence": "6.0",
            "techniqueName": "Video Capture"
        },
        {
            "techniqueId": "T1132",
            "confidence": "6.4",
            "techniqueName": "Data Encoding"
        },
        {
            "techniqueId": "T1210",
            "confidence": "2.2",
            "techniqueName": "Exploitation of Remote Services"
        },
        {
            "techniqueId": "T1486",
            "confidence": "5.4",
            "techniqueName": "Data Encrypted for Impact"
        },
        {
            "techniqueId": "T1489",
            "confidence": "3.8",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1007",
            "confidence": "3.2",
            "techniqueName": "System Service Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.6",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1082",
            "confidence": "11.3",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1115",
            "confidence": "3.1",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "6.7",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1204",
            "confidence": "2.3",
            "techniqueName": "User Execution"
        },
        {
            "techniqueId": "T1489",
            "confidence": "6.0",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1566.001",
            "confidence": "3.6",
            "techniqueName": "Spearphishing Attachment"
        },
        {
            "techniqueId": "T1003",
            "confidence": "2.1",
            "techniqueName": "OS Credential Dumping"
        },
        {
            "techniqueId": "T1041",
            "confidence": "2.1",
            "techniqueName": "Exfiltration Over C2 Channel"
        },
        {
            "techniqueId": "T1048",
            "confidence": "2.1",
            "techniqueName": "Exfiltration Over Alternative Protocol"
        },
        {
            "techniqueId": "T1112",
            "confidence": "3.8",
            "techniqueName": "Modify Registry"
        },
        {
            "techniqueId": "T1113",
            "confidence": "3.9",
            "techniqueName": "Screen Capture"
        },
        {
            "techniqueId": "T1125",
            "confidence": "6.1",
            "techniqueName": "Video Capture"
        },
        {
            "techniqueId": "T1132",
            "confidence": "5.2",
            "techniqueName": "Data Encoding"
        },
        {
            "techniqueId": "T1486",
            "confidence": "49.0",
            "techniqueName": "Data Encrypted for Impact"
        },
        {
            "techniqueId": "T1037",
            "confidence": "2.2",
            "techniqueName": "Boot or Logon Initialization Scripts"
        },
        {
            "techniqueId": "T1048",
            "confidence": "3.1",
            "techniqueName": "Exfiltration Over Alternative Protocol"
        },
        {
            "techniqueId": "T1082",
            "confidence": "3.8",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "3.3",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1112",
            "confidence": "2.5",
            "techniqueName": "Modify Registry"
        },
        {
            "techniqueId": "T1125",
            "confidence": "3.3",
            "techniqueName": "Video Capture"
        },
        {
            "techniqueId": "T1133",
            "confidence": "2.4",
            "techniqueName": "External Remote Services"
        },
        {
            "techniqueId": "T1203",
            "confidence": "6.1",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1485",
            "confidence": "2.4",
            "techniqueName": "Data Destruction"
        },
        {
            "techniqueId": "T1486",
            "confidence": "3.0",
            "techniqueName": "Data Encrypted for Impact"
        },
        {
            "techniqueId": "T1498",
            "confidence": "2.1",
            "techniqueName": "Network Denial of Service"
        },
        {
            "techniqueId": "T1499",
            "confidence": "2.0",
            "techniqueName": "Endpoint Denial of Service"
        },
        {
            "techniqueId": "T1574.002",
            "confidence": "2.1",
            "techniqueName": "DLL Side-Loading"
        }
    ]
}
