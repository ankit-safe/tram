{
    "title": "HedgeDoc is a collaborative platform for writing and sharing markdown. In HedgeDoc before version 1.7.1 an attacker can inject arbitrary `script` tags in HedgeDoc notes using mermaid diagrams. Our content security policy prevents loading scripts from most locations, but `www.google-analytics.com` is allowed. Using Google Tag Manger it is possible to inject arbitrary JavaScript and execute it on page load. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.1. As a workaround one can disallow `www.google-analytics.com` in the `Content-Security-Policy` header. Note that other ways to leverage the `script` tag injection might exist.",
    "score": 8.7,
    "severity": "HIGH",
    "cwe_id": "CWE-79",
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N",
    "cpe_match": [
        "cpe:2.3:a:hedgedoc:hedgedoc:*:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1016",
            "confidence": "5.6",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "4.5",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "2.4",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1057",
            "confidence": "4.0",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "3.8",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.3",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.4",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "7.3",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "11.6",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1129",
            "confidence": "2.9",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1219",
            "confidence": "7.6",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "5.8",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "2.3",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "2.2",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "2.3",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1021.003",
            "confidence": "9.0",
            "techniqueName": "Distributed Component Object Model"
        },
        {
            "techniqueId": "T1071",
            "confidence": "3.1",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1102",
            "confidence": "60.0",
            "techniqueName": "Web Service"
        },
        {
            "techniqueId": "T1003",
            "confidence": "6.0",
            "techniqueName": "OS Credential Dumping"
        },
        {
            "techniqueId": "T1055",
            "confidence": "4.4",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1059",
            "confidence": "25.3",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1113",
            "confidence": "7.0",
            "techniqueName": "Screen Capture"
        },
        {
            "techniqueId": "T1190",
            "confidence": "4.2",
            "techniqueName": "Exploit Public-Facing Application"
        },
        {
            "techniqueId": "T1221",
            "confidence": "2.5",
            "techniqueName": "Template Injection"
        },
        {
            "techniqueId": "T1222",
            "confidence": "5.2",
            "techniqueName": "File and Directory Permissions Modification"
        },
        {
            "techniqueId": "T1059",
            "confidence": "7.0",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1068",
            "confidence": "3.5",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.1",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1210",
            "confidence": "2.6",
            "techniqueName": "Exploitation of Remote Services"
        },
        {
            "techniqueId": "T1222",
            "confidence": "2.3",
            "techniqueName": "File and Directory Permissions Modification"
        },
        {
            "techniqueId": "T1489",
            "confidence": "3.0",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1057",
            "confidence": "4.8",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.2",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1087",
            "confidence": "6.8",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.9",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "4.6",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.4",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1016",
            "confidence": "4.9",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1021.003",
            "confidence": "8.1",
            "techniqueName": "Distributed Component Object Model"
        },
        {
            "techniqueId": "T1069",
            "confidence": "4.5",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1102",
            "confidence": "39.4",
            "techniqueName": "Web Service"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "7.0",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1016",
            "confidence": "3.7",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "11.0",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.3",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1087",
            "confidence": "5.8",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "4.3",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "3.3",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1213",
            "confidence": "3.0",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1482",
            "confidence": "2.6",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1489",
            "confidence": "3.6",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "2.6",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1543",
            "confidence": "3.4",
            "techniqueName": "Create or Modify System Process"
        }
    ]
}
