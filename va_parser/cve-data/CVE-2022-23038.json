{
    "title": "Linux PV device frontends vulnerable to attacks by backends T[his CNA information record relates to multiple CVEs; the text explains which aspects/vulnerabilities correspond to which CVE.] Several Linux PV device frontends are using the grant table interfaces for removing access rights of the backends in ways being subject to race conditions, resulting in potential data leaks, data corruption by malicious backends, and denial of service triggered by malicious backends: blkfront, netfront, scsifront and the gntalloc driver are testing whether a grant reference is still in use. If this is not the case, they assume that a following removal of the granted access will always succeed, which is not true in case the backend has mapped the granted page between those two operations. As a result the backend can keep access to the memory page of the guest no matter how the page will be used after the frontend I/O has finished. The xenbus driver has a similar problem, as it doesnt check the success of removing the granted access of a shared ring buffer. blkfront: CVE-2022-23036 netfront: CVE-2022-23037 scsifront: CVE-2022-23038 gntalloc: CVE-2022-23039 xenbus: CVE-2022-23040 blkfront, netfront, scsifront, usbfront, dmabuf, xenbus, 9p, kbdfront, and pvcalls are using a functionality to delay freeing a grant reference until it is no longer in use, but the freeing of the related data page is not synchronized with dropping the granted access. As a result the backend can keep access to the memory page even after it has been freed and then re-used for a different purpose. CVE-2022-23041 netfront will fail a BUG_ON() assertion if it fails to revoke access in the rx path. This will result in a Denial of Service (DoS) situation of the guest which can be triggered by the backend. CVE-2022-23042",
    "score": 7.0,
    "severity": "HIGH",
    "cwe_id": "CWE-362",
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cpe_match": [
        "cpe:2.3:o:xen:xen:-:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1203",
            "confidence": "3.5",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1037",
            "confidence": "2.8",
            "techniqueName": "Boot or Logon Initialization Scripts"
        },
        {
            "techniqueId": "T1048",
            "confidence": "2.5",
            "techniqueName": "Exfiltration Over Alternative Protocol"
        },
        {
            "techniqueId": "T1055",
            "confidence": "2.7",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1059.006",
            "confidence": "2.3",
            "techniqueName": "Python"
        },
        {
            "techniqueId": "T1204",
            "confidence": "2.1",
            "techniqueName": "User Execution"
        },
        {
            "techniqueId": "T1222",
            "confidence": "2.2",
            "techniqueName": "File and Directory Permissions Modification"
        },
        {
            "techniqueId": "T1486",
            "confidence": "2.0",
            "techniqueName": "Data Encrypted for Impact"
        },
        {
            "techniqueId": "T1543",
            "confidence": "2.6",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1036",
            "confidence": "2.1",
            "techniqueName": "Masquerading"
        },
        {
            "techniqueId": "T1057",
            "confidence": "6.4",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1068",
            "confidence": "21.9",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1082",
            "confidence": "6.0",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "5.5",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "9.8",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "2.3",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1566.001",
            "confidence": "2.8",
            "techniqueName": "Spearphishing Attachment"
        },
        {
            "techniqueId": "T1033",
            "confidence": "2.1",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.3",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1046",
            "confidence": "2.5",
            "techniqueName": "Network Service Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.3",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1068",
            "confidence": "2.1",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1082",
            "confidence": "2.6",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "11.2",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1213",
            "confidence": "3.0",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1480",
            "confidence": "2.0",
            "techniqueName": "Execution Guardrails"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "7.0",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1027",
            "confidence": "2.1",
            "techniqueName": "Obfuscated Files or Information"
        },
        {
            "techniqueId": "T1068",
            "confidence": "12.4",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1203",
            "confidence": "27.4",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1222",
            "confidence": "6.2",
            "techniqueName": "File and Directory Permissions Modification"
        },
        {
            "techniqueId": "T1033",
            "confidence": "6.5",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1048",
            "confidence": "2.4",
            "techniqueName": "Exfiltration Over Alternative Protocol"
        },
        {
            "techniqueId": "T1055",
            "confidence": "4.5",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1082",
            "confidence": "8.0",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "2.1",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1140",
            "confidence": "3.8",
            "techniqueName": "Deobfuscate/Decode Files or Information"
        },
        {
            "techniqueId": "T1219",
            "confidence": "2.1",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "2.2",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1033",
            "confidence": "2.5",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "3.6",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1068",
            "confidence": "10.0",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1082",
            "confidence": "3.1",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.8",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1210",
            "confidence": "2.4",
            "techniqueName": "Exploitation of Remote Services"
        },
        {
            "techniqueId": "T1212",
            "confidence": "2.4",
            "techniqueName": "Exploitation for Credential Access"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.9",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1222",
            "confidence": "2.3",
            "techniqueName": "File and Directory Permissions Modification"
        },
        {
            "techniqueId": "T1489",
            "confidence": "3.7",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "2.0",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1056",
            "confidence": "5.3",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1106",
            "confidence": "2.2",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "2.6",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1129",
            "confidence": "2.5",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1140",
            "confidence": "2.1",
            "techniqueName": "Deobfuscate/Decode Files or Information"
        },
        {
            "techniqueId": "T1219",
            "confidence": "4.1",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "4.3",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1543",
            "confidence": "4.0",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1546.010",
            "confidence": "2.0",
            "techniqueName": "AppInit DLLs"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "4.2",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1016",
            "confidence": "2.4",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "3.0",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "2.6",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1057",
            "confidence": "3.9",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "2.4",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.5",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "5.4",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "8.7",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1129",
            "confidence": "4.1",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.3",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1218",
            "confidence": "2.3",
            "techniqueName": "System Binary Proxy Execution"
        },
        {
            "techniqueId": "T1219",
            "confidence": "10.7",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "7.9",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "2.5",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1546.006",
            "confidence": "2.2",
            "techniqueName": "LC_LOAD_DYLIB Addition"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "2.5",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "2.7",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1562.003",
            "confidence": "2.1",
            "techniqueName": "Impair Command History Logging"
        }
    ]
}
