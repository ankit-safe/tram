{
    "title": "Grafana is an open-source platform for monitoring and observability. When fine-grained access control is enabled and a client uses Grafana API Key to make requests, the permissions for that API Key are cached for 30 seconds for the given organization. Because of the way the cache ID is constructed, the consequent requests with any API Key evaluate to the same permissions as the previous requests. This can lead to an escalation of privileges, when for example a first request is made with Admin permissions, and the second request with different API Key is made with Viewer permissions, the second request will get the cached permissions from the previous Admin, essentially accessing higher privilege than it should. The vulnerability is only impacting Grafana Enterprise when the fine-grained access control beta feature is enabled and there are more than one API Keys in one organization with different roles assigned. All installations after Grafana Enterprise v8.1.0-beta1 should be upgraded as soon as possible. As an alternative, disable fine-grained access control will mitigate the vulnerability.",
    "score": 8.8,
    "severity": "HIGH",
    "cwe_id": "CWE-269",
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cpe_match": [
        "cpe:2.3:a:grafana:grafana:*:*:*:*:enterprise:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1057",
            "confidence": "4.5",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1068",
            "confidence": "2.7",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1083",
            "confidence": "9.2",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "4.1",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "9.3",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "5.6",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1213",
            "confidence": "3.3",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1219",
            "confidence": "3.3",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "3.1",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "43.5",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1546.008",
            "confidence": "51.8",
            "techniqueName": "Accessibility Features"
        },
        {
            "techniqueId": "T1021.003",
            "confidence": "2.3",
            "techniqueName": "Distributed Component Object Model"
        },
        {
            "techniqueId": "T1055",
            "confidence": "2.0",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1056",
            "confidence": "2.5",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "11.1",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1106",
            "confidence": "22.8",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1546.008",
            "confidence": "28.1",
            "techniqueName": "Accessibility Features"
        },
        {
            "techniqueId": "T1068",
            "confidence": "26.5",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1071",
            "confidence": "32.3",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1132",
            "confidence": "3.0",
            "techniqueName": "Data Encoding"
        },
        {
            "techniqueId": "T1203",
            "confidence": "2.6",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1218.005",
            "confidence": "4.4",
            "techniqueName": "Mshta"
        },
        {
            "techniqueId": "T1218.010",
            "confidence": "2.8",
            "techniqueName": "Regsvr32"
        },
        {
            "techniqueId": "T1003",
            "confidence": "2.6",
            "techniqueName": "OS Credential Dumping"
        },
        {
            "techniqueId": "T1007",
            "confidence": "2.1",
            "techniqueName": "System Service Discovery"
        },
        {
            "techniqueId": "T1055",
            "confidence": "3.2",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1068",
            "confidence": "8.2",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1082",
            "confidence": "5.6",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "4.0",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1113",
            "confidence": "2.7",
            "techniqueName": "Screen Capture"
        },
        {
            "techniqueId": "T1204",
            "confidence": "2.5",
            "techniqueName": "User Execution"
        },
        {
            "techniqueId": "T1221",
            "confidence": "2.3",
            "techniqueName": "Template Injection"
        },
        {
            "techniqueId": "T1574.002",
            "confidence": "2.2",
            "techniqueName": "DLL Side-Loading"
        },
        {
            "techniqueId": "T1057",
            "confidence": "15.7",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "10.8",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "2.5",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "2.1",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "5.3",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "2.9",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1213",
            "confidence": "10.4",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1219",
            "confidence": "2.9",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "2.8",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1489",
            "confidence": "3.3",
            "techniqueName": "Service Stop"
        }
    ]
}
