{
    "title": "Sophos SafeGuard Enterprise before 8.00.5, SafeGuard Easy before 7.00.3, and SafeGuard LAN Crypt before 3.95.2 are vulnerable to Local Privilege Escalation via IOCTL 0x802022E0. By crafting an input buffer we can control the execution path to the point where the constant 0x12 will be written to a user-controlled address. We can take advantage of this condition to modify the SEP_TOKEN_PRIVILEGES structure of the Token object belonging to the exploit process and grant SE_DEBUG_NAME privilege. This allows the exploit process to interact with higher privileged processes running as SYSTEM and execute code in their security context.",
    "score": 7.8,
    "severity": "HIGH",
    "cwe_id": "CWE-119",
    "cvss_vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cpe_match": [
        "cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.95.1:*:*:*:*:*:*:*",
        "cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.90.2:*:*:*:*:*:*:*",
        "cpe:2.3:a:sophos:safeguard_enterprise_client:8.00:*:*:*:*:*:*:*",
        "cpe:2.3:a:sophos:safeguard_enterprise_client:7.00:*:*:*:*:*:*:*",
        "cpe:2.3:a:sophos:safeguard_enterprise_client:6.10:*:*:*:*:*:*:*",
        "cpe:2.3:a:sophos:safeguard_enterprise_client:6.00:*:*:*:*:*:*:*",
        "cpe:2.3:a:sophos:safeguard_enterprise_client:6.00.1:*:*:*:*:*:*:*",
        "cpe:2.3:a:sophos:safeguard_easy_device_encryption_client:6.00:*:*:*:*:*:*:*",
        "cpe:2.3:a:sophos:safeguard_easy_device_encryption_client:6.10:*:*:*:*:*:*:*",
        "cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.90.1:ts:*:*:*:*:*:*",
        "cpe:2.3:a:sophos:safeguard_easy_device_encryption_client:7.00:*:*:*:*:*:*:*",
        "cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.95.1:ts:*:*:*:*:*:*",
        "cpe:2.3:a:sophos:safeguard_enterprise_client:5.60.3:vs-nfd:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "technique_id": "T1003",
            "confidence": "3.3",
            "technique_name": "OS Credential Dumping"
        },
        {
            "technique_id": "T1007",
            "confidence": "3.2",
            "technique_name": "System Service Discovery"
        },
        {
            "technique_id": "T1068",
            "confidence": "41.1",
            "technique_name": "Exploitation for Privilege Escalation"
        },
        {
            "technique_id": "T1123",
            "confidence": "5.0",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1190",
            "confidence": "2.5",
            "technique_name": "Exploit Public-Facing Application"
        },
        {
            "technique_id": "T1210",
            "confidence": "2.4",
            "technique_name": "Exploitation of Remote Services"
        },
        {
            "technique_id": "T1543",
            "confidence": "3.3",
            "technique_name": "Create or Modify System Process"
        },
        {
            "technique_id": "T1020",
            "confidence": "2.0",
            "technique_name": "Automated Exfiltration"
        },
        {
            "technique_id": "T1037",
            "confidence": "2.8",
            "technique_name": "Boot or Logon Initialization Scripts"
        },
        {
            "technique_id": "T1041",
            "confidence": "2.2",
            "technique_name": "Exfiltration Over C2 Channel"
        },
        {
            "technique_id": "T1048",
            "confidence": "3.3",
            "technique_name": "Exfiltration Over Alternative Protocol"
        },
        {
            "technique_id": "T1053.003",
            "confidence": "2.4",
            "technique_name": "Cron"
        },
        {
            "technique_id": "T1068",
            "confidence": "2.2",
            "technique_name": "Exploitation for Privilege Escalation"
        },
        {
            "technique_id": "T1078",
            "confidence": "2.9",
            "technique_name": "Valid Accounts"
        },
        {
            "technique_id": "T1083",
            "confidence": "2.1",
            "technique_name": "File and Directory Discovery"
        },
        {
            "technique_id": "T1112",
            "confidence": "3.0",
            "technique_name": "Modify Registry"
        },
        {
            "technique_id": "T1123",
            "confidence": "2.6",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1125",
            "confidence": "3.1",
            "technique_name": "Video Capture"
        },
        {
            "technique_id": "T1133",
            "confidence": "2.3",
            "technique_name": "External Remote Services"
        },
        {
            "technique_id": "T1134",
            "confidence": "2.5",
            "technique_name": "Access Token Manipulation"
        },
        {
            "technique_id": "T1189",
            "confidence": "2.1",
            "technique_name": "Drive-by Compromise"
        },
        {
            "technique_id": "T1190",
            "confidence": "2.6",
            "technique_name": "Exploit Public-Facing Application"
        },
        {
            "technique_id": "T1203",
            "confidence": "7.0",
            "technique_name": "Exploitation for Client Execution"
        },
        {
            "technique_id": "T1204",
            "confidence": "2.4",
            "technique_name": "User Execution"
        },
        {
            "technique_id": "T1485",
            "confidence": "3.0",
            "technique_name": "Data Destruction"
        },
        {
            "technique_id": "T1486",
            "confidence": "2.5",
            "technique_name": "Data Encrypted for Impact"
        },
        {
            "technique_id": "T1489",
            "confidence": "2.7",
            "technique_name": "Service Stop"
        },
        {
            "technique_id": "T1499",
            "confidence": "2.1",
            "technique_name": "Endpoint Denial of Service"
        },
        {
            "technique_id": "T1505.003",
            "confidence": "2.2",
            "technique_name": "Web Shell"
        },
        {
            "technique_id": "T1548",
            "confidence": "3.6",
            "technique_name": "Abuse Elevation Control Mechanism"
        },
        {
            "technique_id": "T1565",
            "confidence": "2.2",
            "technique_name": "Data Manipulation"
        },
        {
            "technique_id": "T1608.001",
            "confidence": "2.3",
            "technique_name": "Upload Malware"
        },
        {
            "technique_id": "T1608.002",
            "confidence": "2.2",
            "technique_name": "Upload Tool"
        },
        {
            "technique_id": "T1007",
            "confidence": "9.2",
            "technique_name": "System Service Discovery"
        },
        {
            "technique_id": "T1057",
            "confidence": "7.8",
            "technique_name": "Process Discovery"
        },
        {
            "technique_id": "T1134",
            "confidence": "2.4",
            "technique_name": "Access Token Manipulation"
        },
        {
            "technique_id": "T1222",
            "confidence": "56.2",
            "technique_name": "File and Directory Permissions Modification"
        },
        {
            "technique_id": "T1543",
            "confidence": "8.1",
            "technique_name": "Create or Modify System Process"
        },
        {
            "technique_id": "T1020",
            "confidence": "2.3",
            "technique_name": "Automated Exfiltration"
        },
        {
            "technique_id": "T1055",
            "confidence": "3.4",
            "technique_name": "Process Injection"
        },
        {
            "technique_id": "T1068",
            "confidence": "24.6",
            "technique_name": "Exploitation for Privilege Escalation"
        },
        {
            "technique_id": "T1113",
            "confidence": "2.9",
            "technique_name": "Screen Capture"
        },
        {
            "technique_id": "T1134",
            "confidence": "3.5",
            "technique_name": "Access Token Manipulation"
        },
        {
            "technique_id": "T1203",
            "confidence": "2.5",
            "technique_name": "Exploitation for Client Execution"
        },
        {
            "technique_id": "T1210",
            "confidence": "4.8",
            "technique_name": "Exploitation of Remote Services"
        },
        {
            "technique_id": "T1221",
            "confidence": "4.2",
            "technique_name": "Template Injection"
        },
        {
            "technique_id": "T1543",
            "confidence": "3.2",
            "technique_name": "Create or Modify System Process"
        }
    ]
}
