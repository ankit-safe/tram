{
    "title": "A program using swift-corelibs-foundation is vulnerable to a denial of service attack caused by a potentially malicious source producing a JSON document containing a type mismatch. This vulnerability is caused by the interaction between a deserialization mechanism offered by the Swift standard library, the Codable protocol; and the JSONDecoder class offered by swift-corelibs-foundation, which can deserialize types that adopt the Codable protocol based on the content of a provided JSON document. When a type that adopts Codable requests the initialization of a field with an integer value, the JSONDecoder class uses a type-erased container with different accessor methods to attempt and coerce a corresponding JSON value and produce an integer. In the case the JSON value was a numeric literal with a floating-point portion, JSONDecoder used different type-eraser methods during validation than it did during the final casting of the value. The checked casting produces a deterministic crash due to this mismatch. The JSONDecoder class is often wrapped by popular Swift-based web frameworks to parse the body of HTTP requests and perform basic type validation. This makes the attack low-effort: sending a specifically crafted JSON document during a request to these endpoints will cause them to crash. The attack does not have any confidentiality or integrity risks in and of itself; the crash is produced deterministically by an abort function that ensures that execution does not continue in the face of this violation of assumptions. However, unexpected crashes can lead to violations of invariants in services, so its possible that this attack can be used to trigger error conditions that escalate the risk. Producing a denial of service may also be the goal of an attacker in itself. This issue is solved in Swift 5.6.2 for Linux and Windows. This issue was solved by ensuring that the same methods are invoked both when validating and during casting, so that no type mismatch occurs. Swift for Linux and Windows versions are not ABI-interchangeable. To upgrade a service, its owner must update to this version of the Swift toolchain, then recompile and redeploy their software. The new version of Swift includes an updated swift-corelibs-foundation package. Versions of Swift running on Darwin-based operating systems are not affected.",
    "score": 7.5,
    "severity": "HIGH",
    "cwe_id": "CWE-704",
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cpe_match": [
        "cpe:2.3:a:apple:swift:*:*:*:*:*:linux:*:*",
        "cpe:2.3:a:apple:swift:*:*:*:*:*:windows:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1033",
            "confidence": "10.0",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1082",
            "confidence": "9.7",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1189",
            "confidence": "2.5",
            "techniqueName": "Drive-by Compromise"
        },
        {
            "techniqueId": "T1203",
            "confidence": "5.2",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1222",
            "confidence": "2.1",
            "techniqueName": "File and Directory Permissions Modification"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "6.7",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1543",
            "confidence": "10.9",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1574.001",
            "confidence": "2.0",
            "techniqueName": "DLL Search Order Hijacking"
        },
        {
            "techniqueId": "T1053",
            "confidence": "2.8",
            "techniqueName": "Scheduled Task/Job"
        },
        {
            "techniqueId": "T1056",
            "confidence": "8.6",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1071",
            "confidence": "4.4",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.3",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1134.005",
            "confidence": "2.1",
            "techniqueName": "SID-History Injection"
        },
        {
            "techniqueId": "T1203",
            "confidence": "8.2",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1204",
            "confidence": "5.1",
            "techniqueName": "User Execution"
        },
        {
            "techniqueId": "T1218.009",
            "confidence": "4.6",
            "techniqueName": "Regsvcs/Regasm"
        },
        {
            "techniqueId": "T1218.010",
            "confidence": "2.1",
            "techniqueName": "Regsvr32"
        },
        {
            "techniqueId": "T1559.002",
            "confidence": "2.5",
            "techniqueName": "Dynamic Data Exchange"
        },
        {
            "techniqueId": "T1569.001",
            "confidence": "2.0",
            "techniqueName": "Launchctl"
        },
        {
            "techniqueId": "T1027",
            "confidence": "47.0",
            "techniqueName": "Obfuscated Files or Information"
        },
        {
            "techniqueId": "T1055.012",
            "confidence": "2.3",
            "techniqueName": "Process Hollowing"
        },
        {
            "techniqueId": "T1106",
            "confidence": "2.3",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1027",
            "confidence": "13.0",
            "techniqueName": "Obfuscated Files or Information"
        },
        {
            "techniqueId": "T1055",
            "confidence": "17.2",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1082",
            "confidence": "8.3",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1102",
            "confidence": "2.8",
            "techniqueName": "Web Service"
        },
        {
            "techniqueId": "T1106",
            "confidence": "3.3",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1113",
            "confidence": "4.4",
            "techniqueName": "Screen Capture"
        },
        {
            "techniqueId": "T1140",
            "confidence": "8.1",
            "techniqueName": "Deobfuscate/Decode Files or Information"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "2.8",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "2.5",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1057",
            "confidence": "6.5",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.0",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1069",
            "confidence": "2.0",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "9.0",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "3.2",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "6.5",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "4.6",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "3.5",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1213",
            "confidence": "5.8",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1219",
            "confidence": "5.8",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "6.7",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1489",
            "confidence": "3.4",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1071",
            "confidence": "13.6",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1486",
            "confidence": "2.2",
            "techniqueName": "Data Encrypted for Impact"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "50.5",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1036",
            "confidence": "5.9",
            "techniqueName": "Masquerading"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.9",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1068",
            "confidence": "2.3",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1087",
            "confidence": "2.9",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1113",
            "confidence": "3.0",
            "techniqueName": "Screen Capture"
        },
        {
            "techniqueId": "T1203",
            "confidence": "2.3",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "5.1",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1566.001",
            "confidence": "8.8",
            "techniqueName": "Spearphishing Attachment"
        },
        {
            "techniqueId": "T1566.002",
            "confidence": "6.3",
            "techniqueName": "Spearphishing Link"
        },
        {
            "techniqueId": "T1033",
            "confidence": "2.6",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1068",
            "confidence": "2.6",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1082",
            "confidence": "2.5",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.2",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.1",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1203",
            "confidence": "2.4",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "2.2",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1033",
            "confidence": "3.4",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "3.4",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "6.7",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1068",
            "confidence": "5.7",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1082",
            "confidence": "2.9",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.1",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "4.2",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.2",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1489",
            "confidence": "3.3",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1087",
            "confidence": "2.1",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1543",
            "confidence": "2.5",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.8",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.2",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.2",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "2.1",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.3",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.2",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1057",
            "confidence": "3.5",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.6",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1083",
            "confidence": "5.2",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.3",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.1",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.6",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1219",
            "confidence": "2.2",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1057",
            "confidence": "10.7",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.5",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.9",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "5.0",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "4.6",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "6.9",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.7",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1036",
            "confidence": "2.1",
            "techniqueName": "Masquerading"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.4",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.2",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1087",
            "confidence": "2.7",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.2",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1036",
            "confidence": "3.0",
            "techniqueName": "Masquerading"
        },
        {
            "techniqueId": "T1057",
            "confidence": "4.4",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.0",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "5.3",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1213",
            "confidence": "4.1",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1548.003",
            "confidence": "2.7",
            "techniqueName": "Sudo and Sudo Caching"
        },
        {
            "techniqueId": "T1553.002",
            "confidence": "2.4",
            "techniqueName": "Code Signing"
        },
        {
            "techniqueId": "T1057",
            "confidence": "41.6",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "5.0",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1213",
            "confidence": "8.8",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1219",
            "confidence": "3.3",
            "techniqueName": "Remote Access Software"
        }
    ]
}
