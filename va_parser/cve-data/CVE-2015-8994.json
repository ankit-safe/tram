{
    "title": "An issue was discovered in PHP 5.x and 7.x, when the configuration uses apache2handler/mod_php or php-fpm with OpCache enabled. With 5.x after 5.6.28 or 7.x after 7.0.13, the issue is resolved in a non-default configuration with the opcache.validate_permission=1 setting. The vulnerability details are as follows. In PHP SAPIs where PHP interpreters share a common parent process, Zend OpCache creates a shared memory object owned by the common parent during initialization. Child PHP processes inherit the SHM descriptor, using it to cache and retrieve compiled script bytecode (opcode in PHP jargon). Cache keys vary depending on configuration, but filename is a central key component, and compiled opcode can generally be run if a scripts filename is known or can be guessed. Many common shared-hosting configurations change EUID in child processes to enforce privilege separation among hosted users (for example using mod_ruid2 for the Apache HTTP Server, or php-fpm user settings). In these scenarios, the default Zend OpCache behavior defeats script file permissions by sharing a single SHM cache among all child PHP processes. PHP scripts often contain sensitive information: Think of CMS configurations where reading or running another users script usually means gaining privileges to the CMS database.",
    "score": 7.5,
    "severity": "HIGH",
    "cwe_id": "CWE-264",
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cpe_match": [
        "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
        "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1059",
            "confidence": "2.2",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.1",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1033",
            "confidence": "3.9",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1068",
            "confidence": "2.2",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.3",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.0",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "3.8",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1543",
            "confidence": "2.6",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1033",
            "confidence": "4.0",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1055",
            "confidence": "42.9",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1059",
            "confidence": "11.1",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1082",
            "confidence": "9.6",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1189",
            "confidence": "3.7",
            "techniqueName": "Drive-by Compromise"
        },
        {
            "techniqueId": "T1221",
            "confidence": "2.2",
            "techniqueName": "Template Injection"
        },
        {
            "techniqueId": "T1574.002",
            "confidence": "2.7",
            "techniqueName": "DLL Side-Loading"
        },
        {
            "techniqueId": "T1055",
            "confidence": "2.3",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1057",
            "confidence": "21.2",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "3.2",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1082",
            "confidence": "4.3",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "17.7",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1105",
            "confidence": "12.4",
            "techniqueName": "Ingress Tool Transfer"
        },
        {
            "techniqueId": "T1213",
            "confidence": "3.7",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1027",
            "confidence": "2.2",
            "techniqueName": "Obfuscated Files or Information"
        },
        {
            "techniqueId": "T1082",
            "confidence": "3.2",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1547.001",
            "confidence": "28.6",
            "techniqueName": "Registry Run Keys / Startup Folder"
        },
        {
            "techniqueId": "T1033",
            "confidence": "47.6",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1055",
            "confidence": "7.5",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1068",
            "confidence": "3.4",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1082",
            "confidence": "2.2",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1210",
            "confidence": "2.5",
            "techniqueName": "Exploitation of Remote Services"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "7.6",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1057",
            "confidence": "11.6",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "5.0",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1083",
            "confidence": "10.1",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "6.1",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1105",
            "confidence": "9.5",
            "techniqueName": "Ingress Tool Transfer"
        },
        {
            "techniqueId": "T1204",
            "confidence": "2.3",
            "techniqueName": "User Execution"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.2",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1480",
            "confidence": "2.3",
            "techniqueName": "Execution Guardrails"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "2.2",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1566.001",
            "confidence": "3.6",
            "techniqueName": "Spearphishing Attachment"
        },
        {
            "techniqueId": "T1566.002",
            "confidence": "5.2",
            "techniqueName": "Spearphishing Link"
        },
        {
            "techniqueId": "T1033",
            "confidence": "13.1",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "3.2",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "9.3",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1068",
            "confidence": "6.8",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1083",
            "confidence": "8.6",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "5.9",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1123",
            "confidence": "4.7",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1190",
            "confidence": "2.0",
            "techniqueName": "Exploit Public-Facing Application"
        },
        {
            "techniqueId": "T1204",
            "confidence": "6.3",
            "techniqueName": "User Execution"
        },
        {
            "techniqueId": "T1489",
            "confidence": "3.3",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "4.0",
            "techniqueName": "Web Shell"
        }
    ]
}
