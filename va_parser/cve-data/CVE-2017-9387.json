{
    "title": "An issue was discovered on Vera VeraEdge 1.7.19 and Veralite 1.7.481 devices. The device provides a shell script called relay.sh which is used for creating new SSH relays for the device so that the device connects to Vera servers. All the parameters passed in this specific script are logged to a log file called log.relay in the /tmp folder. The user can also read all the log files from the device using a script called log.sh. However, when the script loads the log files it displays them with content-type text/html and passes all the logs through the ansi2html binary which converts all the character text including HTML meta-characters correctly to be displayed in the browser. This allows an attacker to use the log files as a storing mechanism for the XSS payload and thus whenever a user navigates to that log.sh script, it enables the XSS payload and allows an attacker to execute his malicious payload on the users browser.",
    "score": 5.4,
    "severity": "MEDIUM",
    "cwe_id": "CWE-79",
    "cvss_vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cpe_match": [
        "cpe:2.3:o:getvera:veraedge_firmware:*:*:*:*:*:*:*:*",
        "cpe:2.3:o:getvera:veralite_firmware:*:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1033",
            "confidence": "2.6",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.2",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1083",
            "confidence": "5.0",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.6",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1203",
            "confidence": "2.3",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1204",
            "confidence": "2.7",
            "techniqueName": "User Execution"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.8",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "3.1",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1543",
            "confidence": "2.4",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1036",
            "confidence": "5.8",
            "techniqueName": "Masquerading"
        },
        {
            "techniqueId": "T1055",
            "confidence": "2.0",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1105",
            "confidence": "16.6",
            "techniqueName": "Ingress Tool Transfer"
        },
        {
            "techniqueId": "T1203",
            "confidence": "4.0",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1543",
            "confidence": "3.3",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1548.002",
            "confidence": "4.2",
            "techniqueName": "Bypass User Account Control"
        },
        {
            "techniqueId": "T1566.001",
            "confidence": "2.7",
            "techniqueName": "Spearphishing Attachment"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.6",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1070.004",
            "confidence": "14.2",
            "techniqueName": "File Deletion"
        },
        {
            "techniqueId": "T1074",
            "confidence": "32.4",
            "techniqueName": "Data Staged"
        },
        {
            "techniqueId": "T1140",
            "confidence": "5.5",
            "techniqueName": "Deobfuscate/Decode Files or Information"
        },
        {
            "techniqueId": "T1057",
            "confidence": "17.8",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "4.6",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1074",
            "confidence": "2.2",
            "techniqueName": "Data Staged"
        },
        {
            "techniqueId": "T1082",
            "confidence": "2.6",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "5.6",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1213",
            "confidence": "4.4",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1480",
            "confidence": "3.5",
            "techniqueName": "Execution Guardrails"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "2.3",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1533",
            "confidence": "2.2",
            "techniqueName": "Data from Local System"
        },
        {
            "techniqueId": "T1016",
            "confidence": "2.4",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1070",
            "confidence": "4.9",
            "techniqueName": "Indicator Removal"
        },
        {
            "techniqueId": "T1070.004",
            "confidence": "21.9",
            "techniqueName": "File Deletion"
        },
        {
            "techniqueId": "T1106",
            "confidence": "9.7",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1129",
            "confidence": "3.0",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1132",
            "confidence": "2.9",
            "techniqueName": "Data Encoding"
        },
        {
            "techniqueId": "T1218.002",
            "confidence": "2.1",
            "techniqueName": "Control Panel"
        },
        {
            "techniqueId": "T1561.002",
            "confidence": "6.0",
            "techniqueName": "Disk Structure Wipe"
        },
        {
            "techniqueId": "T1564.001",
            "confidence": "2.2",
            "techniqueName": "Hidden Files and Directories"
        }
    ]
}
