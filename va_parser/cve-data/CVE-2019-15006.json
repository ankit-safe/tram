{
    "title": "There was a man-in-the-middle (MITM) vulnerability present in the Confluence Previews plugin in Confluence Server and Confluence Data Center. This plugin was used to facilitate communication with the Atlassian Companion application. The Confluence Previews plugin in Confluence Server and Confluence Data Center communicated with the Companion application via the atlassian-domain-for-localhost-connections-only.com domain name, the DNS A record of which points at 127.0.0.1. Additionally, a signed certificate for the domain was publicly distributed with the Companion application. An attacker in the position to control DNS resolution of their victim could carry out a man-in-the-middle (MITM) attack between Confluence Server (or Confluence Data Center) and the atlassian-domain-for-localhost-connections-only.com domain intended to be used with the Companion application. This certificate has been revoked, however, usage of the atlassian-domain-for-localhost-connections-only.com domain name was still present in Confluence Server and Confluence Data Center. An attacker could perform the described attack by denying their victim access to certificate revocation information, and carry out a man-in-the-middle (MITM) attack to observe files being edited using the Companion application and/or modify them, and access some limited user information.",
    "score": 6.5,
    "severity": "MEDIUM",
    "cwe_id": "CWE-913",
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:H/A:N",
    "cpe_match": [
        "cpe:2.3:a:atlassian:confluence:*:*:*:*:*:*:*:*",
        "cpe:2.3:a:atlassian:confluence_server:*:*:*:*:*:*:*:*",
        "cpe:2.3:a:atlassian:confluence_server:*:*:*:*:*:*:*:*",
        "cpe:2.3:a:atlassian:confluence_server:*:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1003",
            "confidence": "4.7",
            "techniqueName": "OS Credential Dumping"
        },
        {
            "techniqueId": "T1007",
            "confidence": "2.0",
            "techniqueName": "System Service Discovery"
        },
        {
            "techniqueId": "T1033",
            "confidence": "3.1",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1041",
            "confidence": "3.3",
            "techniqueName": "Exfiltration Over C2 Channel"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.7",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1113",
            "confidence": "3.9",
            "techniqueName": "Screen Capture"
        },
        {
            "techniqueId": "T1123",
            "confidence": "4.1",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1125",
            "confidence": "2.9",
            "techniqueName": "Video Capture"
        },
        {
            "techniqueId": "T1133",
            "confidence": "2.5",
            "techniqueName": "External Remote Services"
        },
        {
            "techniqueId": "T1210",
            "confidence": "2.5",
            "techniqueName": "Exploitation of Remote Services"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.6",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "4.5",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1574.002",
            "confidence": "2.2",
            "techniqueName": "DLL Side-Loading"
        },
        {
            "techniqueId": "T1071",
            "confidence": "4.3",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1090.004",
            "confidence": "2.1",
            "techniqueName": "Domain Fronting"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.0",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "3.9",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1574.001",
            "confidence": "2.0",
            "techniqueName": "DLL Search Order Hijacking"
        },
        {
            "techniqueId": "T1008",
            "confidence": "14.7",
            "techniqueName": "Fallback Channels"
        },
        {
            "techniqueId": "T1053",
            "confidence": "2.5",
            "techniqueName": "Scheduled Task/Job"
        },
        {
            "techniqueId": "T1071",
            "confidence": "36.9",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1090.004",
            "confidence": "27.9",
            "techniqueName": "Domain Fronting"
        },
        {
            "techniqueId": "T1016",
            "confidence": "4.3",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "3.0",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1115",
            "confidence": "3.1",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.3",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "2.4",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1482",
            "confidence": "10.7",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1546.006",
            "confidence": "2.1",
            "techniqueName": "LC_LOAD_DYLIB Addition"
        },
        {
            "techniqueId": "T1553.002",
            "confidence": "17.9",
            "techniqueName": "Code Signing"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "2.4",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1008",
            "confidence": "10.2",
            "techniqueName": "Fallback Channels"
        },
        {
            "techniqueId": "T1016",
            "confidence": "10.6",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1041",
            "confidence": "18.6",
            "techniqueName": "Exfiltration Over C2 Channel"
        },
        {
            "techniqueId": "T1048",
            "confidence": "4.2",
            "techniqueName": "Exfiltration Over Alternative Protocol"
        },
        {
            "techniqueId": "T1071",
            "confidence": "7.2",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1113",
            "confidence": "4.2",
            "techniqueName": "Screen Capture"
        },
        {
            "techniqueId": "T1222",
            "confidence": "4.4",
            "techniqueName": "File and Directory Permissions Modification"
        },
        {
            "techniqueId": "T1008",
            "confidence": "31.2",
            "techniqueName": "Fallback Channels"
        },
        {
            "techniqueId": "T1016",
            "confidence": "6.5",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1027.002",
            "confidence": "6.1",
            "techniqueName": "Software Packing"
        },
        {
            "techniqueId": "T1053",
            "confidence": "11.1",
            "techniqueName": "Scheduled Task/Job"
        },
        {
            "techniqueId": "T1102",
            "confidence": "3.9",
            "techniqueName": "Web Service"
        },
        {
            "techniqueId": "T1140",
            "confidence": "2.0",
            "techniqueName": "Deobfuscate/Decode Files or Information"
        },
        {
            "techniqueId": "T1546.015",
            "confidence": "3.9",
            "techniqueName": "Component Object Model Hijacking"
        },
        {
            "techniqueId": "T1566.003",
            "confidence": "4.2",
            "techniqueName": "Spearphishing via Service"
        },
        {
            "techniqueId": "T1082",
            "confidence": "2.1",
            "techniqueName": "System Information Discovery"
        }
    ]
}
