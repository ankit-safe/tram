{
    "title": "In Weave Net before version 2.6.3, an attacker able to run a process as root in a container is able to respond to DNS requests from the host and thereby insert themselves as a fake service. In a cluster with an IPv4 internal network, if IPv6 is not totally disabled on the host (via ipv6.disable=1 on the kernel cmdline), it will be either unconfigured or configured on some interfaces, but its pretty likely that ipv6 forwarding is disabled, ie /proc/sys/net/ipv6/conf//forwarding == 0. Also by default, /proc/sys/net/ipv6/conf//accept_ra == 1. The combination of these 2 sysctls means that the host accepts router advertisements and configure the IPv6 stack using them. By sending rogue router advertisements, an attacker can reconfigure the host to redirect part or all of the IPv6 traffic of the host to the attacker controlled container. Even if there was no IPv6 traffic before, if the DNS returns A (IPv4) and AAAA (IPv6) records, many HTTP libraries will try to connect via IPv6 first then fallback to IPv4, giving an opportunity to the attacker to respond. If by chance you also have on the host a vulnerability like last years RCE in apt (CVE-2019-3462), you can now escalate to the host. Weave Net version 2.6.3 disables the accept_ra option on the veth devices that it creates.",
    "score": 5.8,
    "severity": "MEDIUM",
    "cwe_id": "CWE-350",
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:H/A:N",
    "cpe_match": [
        "cpe:2.3:a:weave:weave_net:*:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1057",
            "confidence": "8.2",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "5.5",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1068",
            "confidence": "2.5",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1082",
            "confidence": "5.0",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.3",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "52.5",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1553.002",
            "confidence": "2.3",
            "techniqueName": "Code Signing"
        },
        {
            "techniqueId": "T1016",
            "confidence": "24.6",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1018",
            "confidence": "22.0",
            "techniqueName": "Remote System Discovery"
        },
        {
            "techniqueId": "T1049",
            "confidence": "10.0",
            "techniqueName": "System Network Connections Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "7.2",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1135",
            "confidence": "21.6",
            "techniqueName": "Network Share Discovery"
        },
        {
            "techniqueId": "T1201",
            "confidence": "5.9",
            "techniqueName": "Password Policy Discovery"
        },
        {
            "techniqueId": "T1016",
            "confidence": "5.0",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1049",
            "confidence": "25.5",
            "techniqueName": "System Network Connections Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "13.8",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "31.7",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1201",
            "confidence": "3.2",
            "techniqueName": "Password Policy Discovery"
        },
        {
            "techniqueId": "T1016",
            "confidence": "8.7",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "2.2",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "2.4",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1069",
            "confidence": "3.7",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1071",
            "confidence": "2.8",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1087",
            "confidence": "2.8",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1102",
            "confidence": "2.8",
            "techniqueName": "Web Service"
        },
        {
            "techniqueId": "T1106",
            "confidence": "6.7",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "5.7",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1201",
            "confidence": "2.8",
            "techniqueName": "Password Policy Discovery"
        },
        {
            "techniqueId": "T1219",
            "confidence": "4.9",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "2.0",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "2.9",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "2.0",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1562.003",
            "confidence": "2.1",
            "techniqueName": "Impair Command History Logging"
        },
        {
            "techniqueId": "T1033",
            "confidence": "4.0",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1055",
            "confidence": "2.5",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1082",
            "confidence": "3.6",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "3.9",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.3",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.7",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1016",
            "confidence": "2.0",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1055",
            "confidence": "4.3",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.4",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.4",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1071",
            "confidence": "7.5",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1082",
            "confidence": "5.0",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "3.9",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "4.3",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.5",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "3.2",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.8",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1553.002",
            "confidence": "3.0",
            "techniqueName": "Code Signing"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "3.2",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.7",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1068",
            "confidence": "35.2",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.2",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1203",
            "confidence": "40.7",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "3.4",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1049",
            "confidence": "15.2",
            "techniqueName": "System Network Connections Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "7.9",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "46.5",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1201",
            "confidence": "2.3",
            "techniqueName": "Password Policy Discovery"
        }
    ]
}
