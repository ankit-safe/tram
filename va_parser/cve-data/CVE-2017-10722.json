{
    "title": "Recently it was discovered as a part of the research on IoT devices in the most recent firmware for Shekar Endoscope that the desktop application used to connect to the device suffers from a stack overflow if more than 26 characters are passed to it as the Wi-Fi password. This application is installed on the device and an attacker who can provide the right payload can execute code on the users system directly. Any breach of this system can allow an attacker to get access to all the data that the user has access too. The application uses a dynamic link library(DLL) called avilib.dll which is used by the application to send binary packets to the device that allow to control the device. One such action that the DLL provides is change password in the function sendchangepass which allows a user to change the Wi-Fi password on the device. This function calls a sub function sub_75876EA0 at address 0x7587857C. The function determines which action to execute based on the parameters sent to it. The sendchangepass passes the datastring as the second argument which is the password we enter in the textbox and integer 2 as first argument. The rest of the 3 arguments are set to 0. The function sub_75876EA0 at address 0x75876F19 uses the first argument received and to determine which block to jump to. Since the argument passed is 2, it jumps to 0x7587718C and proceeds from there to address 0x758771C2 which calculates the length of the data string passed as the first parameter.This length and the first argument are then passed to the address 0x7587726F which calls a memmove function which uses a stack address as the destination where the password typed by us is passed as the source and length calculated above is passed as the number of bytes to copy which leads to a stack overflow.",
    "score": 7.8,
    "severity": "HIGH",
    "cwe_id": "CWE-119",
    "cvss_vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cpe_match": [
        "cpe:2.3:o:ishekar:endoscope_camera_firmware:*:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "technique_id": "T1003",
            "confidence": "6.2",
            "technique_name": "OS Credential Dumping"
        },
        {
            "technique_id": "T1055",
            "confidence": "3.3",
            "technique_name": "Process Injection"
        },
        {
            "technique_id": "T1068",
            "confidence": "5.8",
            "technique_name": "Exploitation for Privilege Escalation"
        },
        {
            "technique_id": "T1134",
            "confidence": "2.4",
            "technique_name": "Access Token Manipulation"
        },
        {
            "technique_id": "T1203",
            "confidence": "29.4",
            "technique_name": "Exploitation for Client Execution"
        },
        {
            "technique_id": "T1505.003",
            "confidence": "5.7",
            "technique_name": "Web Shell"
        },
        {
            "technique_id": "T1543",
            "confidence": "3.9",
            "technique_name": "Create or Modify System Process"
        },
        {
            "technique_id": "T1574.002",
            "confidence": "2.4",
            "technique_name": "DLL Side-Loading"
        },
        {
            "technique_id": "T1059",
            "confidence": "2.1",
            "technique_name": "Command and Scripting Interpreter"
        },
        {
            "technique_id": "T1068",
            "confidence": "2.0",
            "technique_name": "Exploitation for Privilege Escalation"
        },
        {
            "technique_id": "T1055",
            "confidence": "9.2",
            "technique_name": "Process Injection"
        },
        {
            "technique_id": "T1110.001",
            "confidence": "2.2",
            "technique_name": "Password Guessing"
        },
        {
            "technique_id": "T1518.001",
            "confidence": "5.8",
            "technique_name": "Security Software Discovery"
        },
        {
            "technique_id": "T1548.002",
            "confidence": "3.6",
            "technique_name": "Bypass User Account Control"
        },
        {
            "technique_id": "T1574.001",
            "confidence": "3.8",
            "technique_name": "DLL Search Order Hijacking"
        },
        {
            "technique_id": "T1574.002",
            "confidence": "30.1",
            "technique_name": "DLL Side-Loading"
        },
        {
            "technique_id": "T1589",
            "confidence": "2.2",
            "technique_name": "Gather Victim Identity Information"
        },
        {
            "technique_id": "T1016",
            "confidence": "32.2",
            "technique_name": "System Network Configuration Discovery"
        },
        {
            "technique_id": "T1123",
            "confidence": "3.4",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1140",
            "confidence": "3.3",
            "technique_name": "Deobfuscate/Decode Files or Information"
        },
        {
            "technique_id": "T1213",
            "confidence": "3.7",
            "technique_name": "Data from Information Repositories"
        },
        {
            "technique_id": "T1219",
            "confidence": "4.3",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1489",
            "confidence": "2.2",
            "technique_name": "Service Stop"
        },
        {
            "technique_id": "T1557.001",
            "confidence": "3.1",
            "technique_name": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "technique_id": "T1016",
            "confidence": "2.3",
            "technique_name": "System Network Configuration Discovery"
        },
        {
            "technique_id": "T1057",
            "confidence": "4.1",
            "technique_name": "Process Discovery"
        },
        {
            "technique_id": "T1106",
            "confidence": "9.7",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1115",
            "confidence": "9.6",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1123",
            "confidence": "6.6",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1129",
            "confidence": "3.2",
            "technique_name": "Shared Modules"
        },
        {
            "technique_id": "T1132",
            "confidence": "2.3",
            "technique_name": "Data Encoding"
        },
        {
            "technique_id": "T1219",
            "confidence": "3.5",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "3.5",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1489",
            "confidence": "3.9",
            "technique_name": "Service Stop"
        },
        {
            "technique_id": "T1557.001",
            "confidence": "5.0",
            "technique_name": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "technique_id": "T1016",
            "confidence": "3.7",
            "technique_name": "System Network Configuration Discovery"
        },
        {
            "technique_id": "T1106",
            "confidence": "19.4",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1115",
            "confidence": "4.4",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1123",
            "confidence": "4.7",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1129",
            "confidence": "6.0",
            "technique_name": "Shared Modules"
        },
        {
            "technique_id": "T1219",
            "confidence": "2.7",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "6.7",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1546.009",
            "confidence": "3.1",
            "technique_name": "AppCert DLLs"
        },
        {
            "technique_id": "T1557.001",
            "confidence": "4.0",
            "technique_name": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "technique_id": "T1056",
            "confidence": "2.8",
            "technique_name": "Input Capture"
        },
        {
            "technique_id": "T1057",
            "confidence": "4.3",
            "technique_name": "Process Discovery"
        },
        {
            "technique_id": "T1069",
            "confidence": "2.5",
            "technique_name": "Permission Groups Discovery"
        },
        {
            "technique_id": "T1087",
            "confidence": "4.5",
            "technique_name": "Account Discovery"
        },
        {
            "technique_id": "T1106",
            "confidence": "3.3",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1115",
            "confidence": "5.7",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1123",
            "confidence": "3.3",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1129",
            "confidence": "3.1",
            "technique_name": "Shared Modules"
        },
        {
            "technique_id": "T1201",
            "confidence": "2.3",
            "technique_name": "Password Policy Discovery"
        },
        {
            "technique_id": "T1213",
            "confidence": "2.6",
            "technique_name": "Data from Information Repositories"
        },
        {
            "technique_id": "T1218",
            "confidence": "2.0",
            "technique_name": "System Binary Proxy Execution"
        },
        {
            "technique_id": "T1219",
            "confidence": "7.5",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "6.7",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1542.003",
            "confidence": "2.3",
            "technique_name": "Bootkit"
        },
        {
            "technique_id": "T1546.004",
            "confidence": "3.4",
            "technique_name": "Unix Shell Configuration Modification"
        },
        {
            "technique_id": "T1546.006",
            "confidence": "2.1",
            "technique_name": "LC_LOAD_DYLIB Addition"
        },
        {
            "technique_id": "T1546.009",
            "confidence": "2.1",
            "technique_name": "AppCert DLLs"
        },
        {
            "technique_id": "T1546.010",
            "confidence": "2.2",
            "technique_name": "AppInit DLLs"
        },
        {
            "technique_id": "T1557.001",
            "confidence": "2.4",
            "technique_name": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "technique_id": "T1562.003",
            "confidence": "2.3",
            "technique_name": "Impair Command History Logging"
        },
        {
            "technique_id": "T1016",
            "confidence": "93.2",
            "technique_name": "System Network Configuration Discovery"
        },
        {
            "technique_id": "T1016",
            "confidence": "5.7",
            "technique_name": "System Network Configuration Discovery"
        },
        {
            "technique_id": "T1037",
            "confidence": "4.6",
            "technique_name": "Boot or Logon Initialization Scripts"
        },
        {
            "technique_id": "T1041",
            "confidence": "2.9",
            "technique_name": "Exfiltration Over C2 Channel"
        },
        {
            "technique_id": "T1048",
            "confidence": "2.0",
            "technique_name": "Exfiltration Over Alternative Protocol"
        },
        {
            "technique_id": "T1059",
            "confidence": "2.5",
            "technique_name": "Command and Scripting Interpreter"
        },
        {
            "technique_id": "T1078",
            "confidence": "2.3",
            "technique_name": "Valid Accounts"
        },
        {
            "technique_id": "T1112",
            "confidence": "3.6",
            "technique_name": "Modify Registry"
        },
        {
            "technique_id": "T1113",
            "confidence": "4.3",
            "technique_name": "Screen Capture"
        },
        {
            "technique_id": "T1125",
            "confidence": "3.9",
            "technique_name": "Video Capture"
        },
        {
            "technique_id": "T1133",
            "confidence": "3.5",
            "technique_name": "External Remote Services"
        },
        {
            "technique_id": "T1140",
            "confidence": "19.0",
            "technique_name": "Deobfuscate/Decode Files or Information"
        },
        {
            "technique_id": "T1485",
            "confidence": "4.8",
            "technique_name": "Data Destruction"
        },
        {
            "technique_id": "T1486",
            "confidence": "10.4",
            "technique_name": "Data Encrypted for Impact"
        },
        {
            "technique_id": "T1505.003",
            "confidence": "7.6",
            "technique_name": "Web Shell"
        },
        {
            "technique_id": "T1561",
            "confidence": "2.2",
            "technique_name": "Disk Wipe"
        },
        {
            "technique_id": "T1574.002",
            "confidence": "2.7",
            "technique_name": "DLL Side-Loading"
        }
    ]
}
