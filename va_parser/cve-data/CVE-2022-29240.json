{
    "title": "Scylla is a real-time big data database that is API-compatible with Apache Cassandra and Amazon DynamoDB. When decompressing CQL frame received from user, Scylla assumes that user-provided uncompressed length is correct. If user provides fake length, that is greater than the real one, part of decompression buffer wont be overwritten, and will be left uninitialized. This can be exploited in several ways, depending on the privileges of the user. 1. The main exploit is that an attacker with access to CQL port, but no user account, can bypass authentication, but only if there are other legitimate clients making connections to the cluster, and they use LZ4. 2. Attacker that already has a user account on the cluster can read parts of uninitialized memory, which can contain things like passwords of other users or fragments of other queries / results, which leads to authorization bypass and sensitive information disclosure. The bug has been patched in the following versions: Scylla Enterprise: 2020.1.14, 2021.1.12, 2022.1.0. Scylla Open Source: 4.6.7, 5.0.3. Users unable to upgrade should make sure none of their drivers connect to cluster using LZ4 compression, and that Scylla CQL port is behind firewall. Additionally make sure no untrusted client can connect to Scylla, by setting up authentication and applying workarounds from previous point (firewall, no lz4 compression).",
    "score": 8.1,
    "severity": "HIGH",
    "cwe_id": "CWE-908",
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cpe_match": [
        "cpe:2.3:a:scylladb:scylla:*:*:*:*:enterprise:*:*:*",
        "cpe:2.3:a:scylladb:scylla:*:*:*:*:enterprise:*:*:*",
        "cpe:2.3:a:scylladb:scylla:*:*:*:*:open_source:*:*:*",
        "cpe:2.3:a:scylladb:scylla:*:*:*:*:open_source:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1056.004",
            "confidence": "6.3",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1087",
            "confidence": "2.2",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "41.3",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "2.6",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1219",
            "confidence": "2.6",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1033",
            "confidence": "13.0",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.2",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1082",
            "confidence": "5.2",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "9.0",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "4.8",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1203",
            "confidence": "2.9",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.3",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.4",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1033",
            "confidence": "5.1",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "7.2",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "11.5",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "2.2",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1123",
            "confidence": "5.3",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "4.2",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1219",
            "confidence": "2.9",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "2.2",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.1",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "2.5",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1033",
            "confidence": "9.1",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1036",
            "confidence": "2.2",
            "techniqueName": "Masquerading"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.9",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "15.0",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1203",
            "confidence": "4.2",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.6",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1016",
            "confidence": "2.4",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "2.7",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "2.6",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.9",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "2.8",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.3",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "5.3",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "10.6",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.0",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "5.8",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1201",
            "confidence": "2.5",
            "techniqueName": "Password Policy Discovery"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.5",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1218",
            "confidence": "2.4",
            "techniqueName": "System Binary Proxy Execution"
        },
        {
            "techniqueId": "T1219",
            "confidence": "11.1",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "11.4",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1542.003",
            "confidence": "2.3",
            "techniqueName": "Bootkit"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "2.6",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1546.006",
            "confidence": "2.3",
            "techniqueName": "LC_LOAD_DYLIB Addition"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "2.4",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1546.010",
            "confidence": "2.4",
            "techniqueName": "AppInit DLLs"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "2.6",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1562.003",
            "confidence": "2.3",
            "techniqueName": "Impair Command History Logging"
        },
        {
            "techniqueId": "T1016",
            "confidence": "2.4",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "2.7",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "2.6",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.9",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "2.8",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.3",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "5.3",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "10.6",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.0",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "5.8",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1201",
            "confidence": "2.5",
            "techniqueName": "Password Policy Discovery"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.5",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1218",
            "confidence": "2.4",
            "techniqueName": "System Binary Proxy Execution"
        },
        {
            "techniqueId": "T1219",
            "confidence": "11.1",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "11.4",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1542.003",
            "confidence": "2.3",
            "techniqueName": "Bootkit"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "2.6",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1546.006",
            "confidence": "2.3",
            "techniqueName": "LC_LOAD_DYLIB Addition"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "2.4",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1546.010",
            "confidence": "2.4",
            "techniqueName": "AppInit DLLs"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "2.6",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1562.003",
            "confidence": "2.3",
            "techniqueName": "Impair Command History Logging"
        },
        {
            "techniqueId": "T1033",
            "confidence": "3.1",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.2",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "5.5",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.3",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1057",
            "confidence": "12.2",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "8.8",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "9.7",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.8",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "8.5",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1480",
            "confidence": "2.1",
            "techniqueName": "Execution Guardrails"
        },
        {
            "techniqueId": "T1489",
            "confidence": "3.1",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "2.2",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "3.7",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1068",
            "confidence": "2.3",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.1",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "5.6",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "5.0",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "6.1",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.8",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "2.2",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1213",
            "confidence": "4.4",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1219",
            "confidence": "3.8",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "4.9",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.4",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1033",
            "confidence": "15.3",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "3.2",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1106",
            "confidence": "7.6",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "9.7",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "5.3",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1219",
            "confidence": "7.5",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1222",
            "confidence": "2.5",
            "techniqueName": "File and Directory Permissions Modification"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.3",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "2.2",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1571",
            "confidence": "2.0",
            "techniqueName": "Non-Standard Port"
        },
        {
            "techniqueId": "T1016",
            "confidence": "2.0",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "3.5",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "3.1",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1115",
            "confidence": "8.8",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "5.1",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1219",
            "confidence": "12.7",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.0",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1542.003",
            "confidence": "3.4",
            "techniqueName": "Bootkit"
        },
        {
            "techniqueId": "T1546.006",
            "confidence": "2.1",
            "techniqueName": "LC_LOAD_DYLIB Addition"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "2.0",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1546.010",
            "confidence": "2.1",
            "techniqueName": "AppInit DLLs"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "6.6",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1562.003",
            "confidence": "2.9",
            "techniqueName": "Impair Command History Logging"
        }
    ]
}
