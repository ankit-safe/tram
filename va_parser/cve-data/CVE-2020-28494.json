{
    "title": "This affects the package total.js before 3.4.7. The issue occurs in the image.pipe and image.stream functions. The type parameter is used to build the command that is then executed using child_process.spawn. The issue occurs because child_process.spawn is called with the option shell set to true and because the type parameter is not properly sanitized.",
    "score": 8.6,
    "severity": "HIGH",
    "cwe_id": "CWE-78",
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L",
    "cpe_match": [
        "cpe:2.3:a:totaljs:total.js:*:*:*:*:*:node.js:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "technique_id": "T1016",
            "confidence": "3.8",
            "technique_name": "System Network Configuration Discovery"
        },
        {
            "technique_id": "T1056",
            "confidence": "2.0",
            "technique_name": "Input Capture"
        },
        {
            "technique_id": "T1056.004",
            "confidence": "3.5",
            "technique_name": "Credential API Hooking"
        },
        {
            "technique_id": "T1069",
            "confidence": "2.6",
            "technique_name": "Permission Groups Discovery"
        },
        {
            "technique_id": "T1106",
            "confidence": "9.8",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1115",
            "confidence": "12.0",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1129",
            "confidence": "6.1",
            "technique_name": "Shared Modules"
        },
        {
            "technique_id": "T1218",
            "confidence": "2.4",
            "technique_name": "System Binary Proxy Execution"
        },
        {
            "technique_id": "T1219",
            "confidence": "7.0",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "11.5",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1542.003",
            "confidence": "2.9",
            "technique_name": "Bootkit"
        },
        {
            "technique_id": "T1546.004",
            "confidence": "2.5",
            "technique_name": "Unix Shell Configuration Modification"
        },
        {
            "technique_id": "T1546.006",
            "confidence": "2.2",
            "technique_name": "LC_LOAD_DYLIB Addition"
        },
        {
            "technique_id": "T1546.010",
            "confidence": "2.2",
            "technique_name": "AppInit DLLs"
        },
        {
            "technique_id": "T1557.001",
            "confidence": "2.5",
            "technique_name": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "technique_id": "T1562.003",
            "confidence": "2.5",
            "technique_name": "Impair Command History Logging"
        },
        {
            "technique_id": "T1036.005",
            "confidence": "2.0",
            "technique_name": "Match Legitimate Name or Location"
        },
        {
            "technique_id": "T1037",
            "confidence": "2.0",
            "technique_name": "Boot or Logon Initialization Scripts"
        },
        {
            "technique_id": "T1059.006",
            "confidence": "2.8",
            "technique_name": "Python"
        },
        {
            "technique_id": "T1087",
            "confidence": "3.2",
            "technique_name": "Account Discovery"
        },
        {
            "technique_id": "T1105",
            "confidence": "3.0",
            "technique_name": "Ingress Tool Transfer"
        },
        {
            "technique_id": "T1204",
            "confidence": "6.5",
            "technique_name": "User Execution"
        },
        {
            "technique_id": "T1210",
            "confidence": "2.7",
            "technique_name": "Exploitation of Remote Services"
        },
        {
            "technique_id": "T1480",
            "confidence": "3.7",
            "technique_name": "Execution Guardrails"
        },
        {
            "technique_id": "T1486",
            "confidence": "2.4",
            "technique_name": "Data Encrypted for Impact"
        },
        {
            "technique_id": "T1566.002",
            "confidence": "3.4",
            "technique_name": "Spearphishing Link"
        },
        {
            "technique_id": "T1016",
            "confidence": "42.3",
            "technique_name": "System Network Configuration Discovery"
        },
        {
            "technique_id": "T1027",
            "confidence": "4.7",
            "technique_name": "Obfuscated Files or Information"
        },
        {
            "technique_id": "T1105",
            "confidence": "6.4",
            "technique_name": "Ingress Tool Transfer"
        },
        {
            "technique_id": "T1106",
            "confidence": "2.0",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1129",
            "confidence": "3.3",
            "technique_name": "Shared Modules"
        },
        {
            "technique_id": "T1560",
            "confidence": "2.4",
            "technique_name": "Archive Collected Data"
        },
        {
            "technique_id": "T1573",
            "confidence": "2.4",
            "technique_name": "Encrypted Channel"
        },
        {
            "technique_id": "T1036",
            "confidence": "2.2",
            "technique_name": "Masquerading"
        },
        {
            "technique_id": "T1087",
            "confidence": "5.4",
            "technique_name": "Account Discovery"
        },
        {
            "technique_id": "T1123",
            "confidence": "2.7",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1213",
            "confidence": "2.0",
            "technique_name": "Data from Information Repositories"
        },
        {
            "technique_id": "T1505.003",
            "confidence": "15.0",
            "technique_name": "Web Shell"
        }
    ]
}
