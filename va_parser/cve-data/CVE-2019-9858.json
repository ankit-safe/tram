{
    "title": "Remote code execution was discovered in Horde Groupware Webmail 5.2.22 and 5.2.17. Horde/Form/Type.php contains a vulnerable class that handles image upload in forms. When the Horde_Form_Type_image method onSubmit() is called on uploads, it invokes the functions getImage() and _getUpload(), which uses unsanitized user input as a path to save the image. The unsanitized POST parameter object[photo][img][file] is saved in the $upload[img][file] PHP variable, allowing an attacker to manipulate the $tmp_file passed to move_uploaded_file() to save the uploaded file. By setting the parameter to (for example) ../usr/share/horde/static/bd.php, one can write a PHP backdoor inside the web root. The static/ destination folder is a good candidate to drop the backdoor because it is always writable in Horde installations. (The unsanitized POST parameter went probably unnoticed because its never submitted by the forms, which default to securely using a random path.)",
    "score": 8.8,
    "severity": "HIGH",
    "cwe_id": "CWE-22",
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cpe_match": [
        "cpe:2.3:a:horde:groupware:5.2.17:*:*:*:webmail:*:*:*",
        "cpe:2.3:a:horde:groupware:5.2.22:*:*:*:webmail:*:*:*",
        "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*",
        "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1020",
            "confidence": "2.8",
            "techniqueName": "Automated Exfiltration"
        },
        {
            "techniqueId": "T1037",
            "confidence": "3.0",
            "techniqueName": "Boot or Logon Initialization Scripts"
        },
        {
            "techniqueId": "T1041",
            "confidence": "2.8",
            "techniqueName": "Exfiltration Over C2 Channel"
        },
        {
            "techniqueId": "T1048",
            "confidence": "3.1",
            "techniqueName": "Exfiltration Over Alternative Protocol"
        },
        {
            "techniqueId": "T1053.003",
            "confidence": "2.5",
            "techniqueName": "Cron"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.7",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1068",
            "confidence": "2.7",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1078",
            "confidence": "3.0",
            "techniqueName": "Valid Accounts"
        },
        {
            "techniqueId": "T1083",
            "confidence": "3.3",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1112",
            "confidence": "3.1",
            "techniqueName": "Modify Registry"
        },
        {
            "techniqueId": "T1113",
            "confidence": "2.6",
            "techniqueName": "Screen Capture"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.0",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1125",
            "confidence": "3.4",
            "techniqueName": "Video Capture"
        },
        {
            "techniqueId": "T1134",
            "confidence": "2.6",
            "techniqueName": "Access Token Manipulation"
        },
        {
            "techniqueId": "T1189",
            "confidence": "2.6",
            "techniqueName": "Drive-by Compromise"
        },
        {
            "techniqueId": "T1190",
            "confidence": "2.7",
            "techniqueName": "Exploit Public-Facing Application"
        },
        {
            "techniqueId": "T1202",
            "confidence": "2.8",
            "techniqueName": "Indirect Command Execution"
        },
        {
            "techniqueId": "T1203",
            "confidence": "3.2",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1204",
            "confidence": "2.6",
            "techniqueName": "User Execution"
        },
        {
            "techniqueId": "T1210",
            "confidence": "2.5",
            "techniqueName": "Exploitation of Remote Services"
        },
        {
            "techniqueId": "T1211",
            "confidence": "2.7",
            "techniqueName": "Exploitation for Defense Evasion"
        },
        {
            "techniqueId": "T1485",
            "confidence": "2.3",
            "techniqueName": "Data Destruction"
        },
        {
            "techniqueId": "T1486",
            "confidence": "2.6",
            "techniqueName": "Data Encrypted for Impact"
        },
        {
            "techniqueId": "T1489",
            "confidence": "3.1",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1496",
            "confidence": "2.8",
            "techniqueName": "Resource Hijacking"
        },
        {
            "techniqueId": "T1498",
            "confidence": "2.7",
            "techniqueName": "Network Denial of Service"
        },
        {
            "techniqueId": "T1499",
            "confidence": "2.6",
            "techniqueName": "Endpoint Denial of Service"
        },
        {
            "techniqueId": "T1499.004",
            "confidence": "2.9",
            "techniqueName": "Application or System Exploitation"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "2.6",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1548",
            "confidence": "2.9",
            "techniqueName": "Abuse Elevation Control Mechanism"
        },
        {
            "techniqueId": "T1565",
            "confidence": "2.8",
            "techniqueName": "Data Manipulation"
        },
        {
            "techniqueId": "T1595.002",
            "confidence": "2.5",
            "techniqueName": "Vulnerability Scanning"
        },
        {
            "techniqueId": "T1608.001",
            "confidence": "3.0",
            "techniqueName": "Upload Malware"
        },
        {
            "techniqueId": "T1608.002",
            "confidence": "2.8",
            "techniqueName": "Upload Tool"
        },
        {
            "techniqueId": "T1041",
            "confidence": "3.1",
            "techniqueName": "Exfiltration Over C2 Channel"
        },
        {
            "techniqueId": "T1053.003",
            "confidence": "2.3",
            "techniqueName": "Cron"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.3",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1113",
            "confidence": "5.2",
            "techniqueName": "Screen Capture"
        },
        {
            "techniqueId": "T1123",
            "confidence": "22.0",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1125",
            "confidence": "5.8",
            "techniqueName": "Video Capture"
        },
        {
            "techniqueId": "T1189",
            "confidence": "2.3",
            "techniqueName": "Drive-by Compromise"
        },
        {
            "techniqueId": "T1190",
            "confidence": "2.6",
            "techniqueName": "Exploit Public-Facing Application"
        },
        {
            "techniqueId": "T1202",
            "confidence": "2.4",
            "techniqueName": "Indirect Command Execution"
        },
        {
            "techniqueId": "T1204",
            "confidence": "2.7",
            "techniqueName": "User Execution"
        },
        {
            "techniqueId": "T1210",
            "confidence": "6.0",
            "techniqueName": "Exploitation of Remote Services"
        },
        {
            "techniqueId": "T1486",
            "confidence": "2.3",
            "techniqueName": "Data Encrypted for Impact"
        },
        {
            "techniqueId": "T1489",
            "confidence": "7.1",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1033",
            "confidence": "4.2",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "3.4",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "2.8",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "9.5",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "5.7",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.1",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "2.8",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1204",
            "confidence": "4.9",
            "techniqueName": "User Execution"
        },
        {
            "techniqueId": "T1482",
            "confidence": "2.6",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.7",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1543",
            "confidence": "2.4",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1083",
            "confidence": "64.7",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1125",
            "confidence": "2.0",
            "techniqueName": "Video Capture"
        },
        {
            "techniqueId": "T1203",
            "confidence": "3.3",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1486",
            "confidence": "2.7",
            "techniqueName": "Data Encrypted for Impact"
        },
        {
            "techniqueId": "T1055",
            "confidence": "3.4",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1068",
            "confidence": "2.2",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1078",
            "confidence": "2.3",
            "techniqueName": "Valid Accounts"
        },
        {
            "techniqueId": "T1113",
            "confidence": "4.3",
            "techniqueName": "Screen Capture"
        },
        {
            "techniqueId": "T1189",
            "confidence": "5.0",
            "techniqueName": "Drive-by Compromise"
        },
        {
            "techniqueId": "T1203",
            "confidence": "10.6",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "30.1",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1543",
            "confidence": "4.9",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1574.002",
            "confidence": "6.5",
            "techniqueName": "DLL Side-Loading"
        },
        {
            "techniqueId": "T1016",
            "confidence": "5.4",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1048",
            "confidence": "2.9",
            "techniqueName": "Exfiltration Over Alternative Protocol"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.6",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1083",
            "confidence": "5.5",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1112",
            "confidence": "2.0",
            "techniqueName": "Modify Registry"
        },
        {
            "techniqueId": "T1123",
            "confidence": "25.1",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1190",
            "confidence": "2.3",
            "techniqueName": "Exploit Public-Facing Application"
        },
        {
            "techniqueId": "T1203",
            "confidence": "6.1",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1210",
            "confidence": "7.0",
            "techniqueName": "Exploitation of Remote Services"
        },
        {
            "techniqueId": "T1489",
            "confidence": "12.3",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1016",
            "confidence": "2.3",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1071",
            "confidence": "2.1",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1082",
            "confidence": "11.2",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "6.7",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "4.3",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1203",
            "confidence": "2.5",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1204",
            "confidence": "3.7",
            "techniqueName": "User Execution"
        },
        {
            "techniqueId": "T1210",
            "confidence": "2.2",
            "techniqueName": "Exploitation of Remote Services"
        },
        {
            "techniqueId": "T1222",
            "confidence": "3.1",
            "techniqueName": "File and Directory Permissions Modification"
        },
        {
            "techniqueId": "T1486",
            "confidence": "3.4",
            "techniqueName": "Data Encrypted for Impact"
        },
        {
            "techniqueId": "T1489",
            "confidence": "3.2",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1016",
            "confidence": "2.6",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "2.4",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "2.3",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.7",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "2.1",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.1",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "5.6",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "10.5",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.4",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "5.0",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1201",
            "confidence": "2.2",
            "techniqueName": "Password Policy Discovery"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.5",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1218",
            "confidence": "2.3",
            "techniqueName": "System Binary Proxy Execution"
        },
        {
            "techniqueId": "T1219",
            "confidence": "11.4",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "10.5",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1542.003",
            "confidence": "2.2",
            "techniqueName": "Bootkit"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "2.5",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1546.006",
            "confidence": "2.2",
            "techniqueName": "LC_LOAD_DYLIB Addition"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "2.4",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1546.010",
            "confidence": "2.2",
            "techniqueName": "AppInit DLLs"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "2.9",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1562.003",
            "confidence": "2.2",
            "techniqueName": "Impair Command History Logging"
        }
    ]
}
