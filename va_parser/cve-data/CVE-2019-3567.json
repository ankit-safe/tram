{
    "title": "In some configurations an attacker can inject a new executable path into the extensions.load file for osquery and hard link a parent folder of a malicious binary to a folder with known safe permissions. Under those circumstances osquery will load said malicious executable with SYSTEM permissions. The solution is to migrate installations to the Program Files directory on Windows which restricts unprivileged write access. This issue affects osquery prior to v3.4.0.",
    "score": 8.1,
    "severity": "HIGH",
    "cwe_id": "CWE-59",
    "cvss_vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cpe_match": [
        "cpe:2.3:a:linuxfoundation:osquery:*:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1055",
            "confidence": "4.7",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1068",
            "confidence": "17.6",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1083",
            "confidence": "4.2",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1190",
            "confidence": "2.6",
            "techniqueName": "Exploit Public-Facing Application"
        },
        {
            "techniqueId": "T1203",
            "confidence": "9.0",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1221",
            "confidence": "3.3",
            "techniqueName": "Template Injection"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.1",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1548.002",
            "confidence": "23.4",
            "techniqueName": "Bypass User Account Control"
        },
        {
            "techniqueId": "T1566.001",
            "confidence": "14.0",
            "techniqueName": "Spearphishing Attachment"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "2.1",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1057",
            "confidence": "5.0",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "2.1",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "7.8",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1129",
            "confidence": "32.7",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1218",
            "confidence": "2.1",
            "techniqueName": "System Binary Proxy Execution"
        },
        {
            "techniqueId": "T1219",
            "confidence": "3.7",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "6.9",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1542.003",
            "confidence": "2.0",
            "techniqueName": "Bootkit"
        },
        {
            "techniqueId": "T1546.006",
            "confidence": "3.0",
            "techniqueName": "LC_LOAD_DYLIB Addition"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "2.9",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1546.010",
            "confidence": "3.8",
            "techniqueName": "AppInit DLLs"
        },
        {
            "techniqueId": "T1057",
            "confidence": "10.6",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1082",
            "confidence": "5.3",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "3.6",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.0",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.5",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "3.9",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1480",
            "confidence": "3.5",
            "techniqueName": "Execution Guardrails"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.0",
            "techniqueName": "Service Stop"
        }
    ]
}
