{
    "title": "phpCAS is an authentication library that allows PHP applications to easily authenticate users via a Central Authentication Service (CAS) server. The phpCAS library uses HTTP headers to determine the service URL used to validate tickets. This allows an attacker to control the host header and use a valid ticket granted for any authorized service in the same SSO realm (CAS server) to authenticate to the service protected by phpCAS. Depending on the settings of the CAS server service registry in worst case this may be any other service URL (if the allowed URLs are configured to ^(https)://.*) or may be strictly limited to known and authorized services in the same SSO federation if proper URL service validation is applied. This vulnerability may allow an attacker to gain access to a victims account on a vulnerable CASified service without victims knowledge, when the victim visits attackers website while being logged in to the same CAS server. phpCAS 1.6.0 is a major version upgrade that starts enforcing service URL discovery validation, because there is unfortunately no 100% safe default config to use in PHP. Starting this version, it is required to pass in an additional service base URL argument when constructing the client class. For more information, please refer to the upgrading doc. This vulnerability only impacts the CAS client that the phpCAS library protects against. The problematic service URL discovery behavior in phpCAS < 1.6.0 will only be disabled, and thus you are not impacted from it, if the phpCAS configuration has the following setup: 1. `phpCAS::setUrl()` is called (a reminder that you have to pass in the full URL of the current page, rather than your service base URL), and 2. `phpCAS::setCallbackURL()` is called, only when the proxy mode is enabled. 3. If your PHPs HTTP header input `X-Forwarded-Host`, `X-Forwarded-Server`, `Host`, `X-Forwarded-Proto`, `X-Forwarded-Protocol` is sanitized before reaching PHP (by a reverse proxy, for example), you will not be impacted by this vulnerability either. If your CAS server service registry is configured to only allow known and trusted service URLs the severity of the vulnerability is reduced substantially in its severity since an attacker must be in control of another authorized service. Otherwise, you should upgrade the library to get the safe service discovery behavior.",
    "score": "NA",
    "severity": "NA",
    "cwe_id": "NA",
    "cvss_vector": "NA",
    "cpe_match": "NA",
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1007",
            "confidence": "2.0",
            "techniqueName": "System Service Discovery"
        },
        {
            "techniqueId": "T1033",
            "confidence": "2.8",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1037",
            "confidence": "5.2",
            "techniqueName": "Boot or Logon Initialization Scripts"
        },
        {
            "techniqueId": "T1048",
            "confidence": "3.7",
            "techniqueName": "Exfiltration Over Alternative Protocol"
        },
        {
            "techniqueId": "T1055",
            "confidence": "2.6",
            "techniqueName": "Process Injection"
        },
        {
            "techniqueId": "T1123",
            "confidence": "4.9",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1133",
            "confidence": "7.0",
            "techniqueName": "External Remote Services"
        },
        {
            "techniqueId": "T1189",
            "confidence": "2.2",
            "techniqueName": "Drive-by Compromise"
        },
        {
            "techniqueId": "T1210",
            "confidence": "2.4",
            "techniqueName": "Exploitation of Remote Services"
        },
        {
            "techniqueId": "T1221",
            "confidence": "4.9",
            "techniqueName": "Template Injection"
        },
        {
            "techniqueId": "T1489",
            "confidence": "7.5",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1543",
            "confidence": "11.7",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1574.002",
            "confidence": "4.3",
            "techniqueName": "DLL Side-Loading"
        },
        {
            "techniqueId": "T1071",
            "confidence": "63.7",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1543",
            "confidence": "19.9",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "2.2",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1037",
            "confidence": "2.2",
            "techniqueName": "Boot or Logon Initialization Scripts"
        },
        {
            "techniqueId": "T1221",
            "confidence": "3.5",
            "techniqueName": "Template Injection"
        },
        {
            "techniqueId": "T1543",
            "confidence": "10.2",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1574.002",
            "confidence": "3.0",
            "techniqueName": "DLL Side-Loading"
        },
        {
            "techniqueId": "T1071",
            "confidence": "9.4",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1543",
            "confidence": "74.1",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "8.4",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1007",
            "confidence": "2.2",
            "techniqueName": "System Service Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.8",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.9",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1543",
            "confidence": "51.6",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1033",
            "confidence": "6.5",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1041",
            "confidence": "2.1",
            "techniqueName": "Exfiltration Over C2 Channel"
        },
        {
            "techniqueId": "T1082",
            "confidence": "3.6",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "2.6",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.1",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1134",
            "confidence": "2.8",
            "techniqueName": "Access Token Manipulation"
        },
        {
            "techniqueId": "T1189",
            "confidence": "4.9",
            "techniqueName": "Drive-by Compromise"
        },
        {
            "techniqueId": "T1203",
            "confidence": "4.5",
            "techniqueName": "Exploitation for Client Execution"
        },
        {
            "techniqueId": "T1543",
            "confidence": "4.9",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1027",
            "confidence": "2.3",
            "techniqueName": "Obfuscated Files or Information"
        },
        {
            "techniqueId": "T1069",
            "confidence": "2.1",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "2.1",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "2.4",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1129",
            "confidence": "7.5",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1140",
            "confidence": "2.4",
            "techniqueName": "Deobfuscate/Decode Files or Information"
        },
        {
            "techniqueId": "T1218.004",
            "confidence": "2.1",
            "techniqueName": "InstallUtil"
        },
        {
            "techniqueId": "T1482",
            "confidence": "6.3",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "3.0",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1550.003",
            "confidence": "4.3",
            "techniqueName": "Pass the Ticket"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "7.3",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1057",
            "confidence": "8.3",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "3.3",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1082",
            "confidence": "3.9",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "18.8",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "3.0",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "6.8",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1129",
            "confidence": "3.7",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1213",
            "confidence": "6.0",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1219",
            "confidence": "4.0",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "5.2",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.9",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1068",
            "confidence": "3.3",
            "techniqueName": "Exploitation for Privilege Escalation"
        },
        {
            "techniqueId": "T1082",
            "confidence": "2.8",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "2.4",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1016",
            "confidence": "5.7",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "6.4",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "43.5",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1219",
            "confidence": "3.7",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "23.1",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1016",
            "confidence": "14.2",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "2.6",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1106",
            "confidence": "9.0",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "3.0",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1129",
            "confidence": "3.5",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1132",
            "confidence": "2.9",
            "techniqueName": "Data Encoding"
        },
        {
            "techniqueId": "T1218",
            "confidence": "2.1",
            "techniqueName": "System Binary Proxy Execution"
        },
        {
            "techniqueId": "T1542.003",
            "confidence": "2.5",
            "techniqueName": "Bootkit"
        },
        {
            "techniqueId": "T1546.006",
            "confidence": "2.3",
            "techniqueName": "LC_LOAD_DYLIB Addition"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "3.8",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1550.003",
            "confidence": "3.2",
            "techniqueName": "Pass the Ticket"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "7.1",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1016",
            "confidence": "3.0",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "3.0",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "2.9",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1069",
            "confidence": "2.8",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1090",
            "confidence": "3.1",
            "techniqueName": "Proxy"
        },
        {
            "techniqueId": "T1106",
            "confidence": "5.2",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "20.0",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1129",
            "confidence": "6.2",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1218",
            "confidence": "3.0",
            "techniqueName": "System Binary Proxy Execution"
        },
        {
            "techniqueId": "T1219",
            "confidence": "6.0",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "8.6",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "4.7",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1546.010",
            "confidence": "2.7",
            "techniqueName": "AppInit DLLs"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "2.3",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1562.003",
            "confidence": "2.1",
            "techniqueName": "Impair Command History Logging"
        },
        {
            "techniqueId": "T1016",
            "confidence": "2.4",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "2.7",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "2.6",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.9",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "2.8",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.3",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "5.3",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "10.6",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.0",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "5.8",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1201",
            "confidence": "2.5",
            "techniqueName": "Password Policy Discovery"
        },
        {
            "techniqueId": "T1213",
            "confidence": "2.5",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1218",
            "confidence": "2.4",
            "techniqueName": "System Binary Proxy Execution"
        },
        {
            "techniqueId": "T1219",
            "confidence": "11.1",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "11.4",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1542.003",
            "confidence": "2.3",
            "techniqueName": "Bootkit"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "2.6",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1546.006",
            "confidence": "2.3",
            "techniqueName": "LC_LOAD_DYLIB Addition"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "2.4",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1546.010",
            "confidence": "2.4",
            "techniqueName": "AppInit DLLs"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "2.6",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1562.003",
            "confidence": "2.3",
            "techniqueName": "Impair Command History Logging"
        },
        {
            "techniqueId": "T1071",
            "confidence": "31.2",
            "techniqueName": "Application Layer Protocol"
        },
        {
            "techniqueId": "T1082",
            "confidence": "5.1",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1090",
            "confidence": "4.6",
            "techniqueName": "Proxy"
        },
        {
            "techniqueId": "T1090.004",
            "confidence": "7.2",
            "techniqueName": "Domain Fronting"
        },
        {
            "techniqueId": "T1105",
            "confidence": "4.1",
            "techniqueName": "Ingress Tool Transfer"
        },
        {
            "techniqueId": "T1115",
            "confidence": "2.2",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1218.009",
            "confidence": "3.1",
            "techniqueName": "Regsvcs/Regasm"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "3.5",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1543",
            "confidence": "51.5",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1548.003",
            "confidence": "2.2",
            "techniqueName": "Sudo and Sudo Caching"
        },
        {
            "techniqueId": "T1016",
            "confidence": "8.8",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "4.6",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "2.5",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1115",
            "confidence": "33.6",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1129",
            "confidence": "3.5",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1219",
            "confidence": "4.2",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "9.4",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1542.003",
            "confidence": "2.3",
            "techniqueName": "Bootkit"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "4.3",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1546.010",
            "confidence": "2.8",
            "techniqueName": "AppInit DLLs"
        },
        {
            "techniqueId": "T1557.001",
            "confidence": "2.3",
            "techniqueName": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "techniqueId": "T1562.003",
            "confidence": "2.1",
            "techniqueName": "Impair Command History Logging"
        }
    ]
}
