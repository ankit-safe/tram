{
    "title": "An issue was discovered on D-Link DCS-1100 and DCS-1130 devices. The device runs a custom daemon on UDP port 5978 which is called dldps2121 and listens for broadcast packets sent on 255.255.255.255. This daemon handles custom D-Link UDP based protocol that allows D-Link mobile applications and desktop applications to discover D-Link devices on the local network. The binary processes the received UDP packets sent from any device in main function. One path in the function traverses towards a block of code that processing of packets which does an unbounded copy operation which allows to overflow the buffer. The custom protocol created by Dlink follows the following pattern: Packetlen, Type of packet; M=MAC address of device or broadcast; D=Device Type;C=base64 encoded command string;test=1111 We can see at address function starting at address 0x0000DBF8 handles the entire UDP packet and performs an insecure copy using strcpy function at address 0x0000DC88. This results in overflowing the stack pointer after 1060 characters and thus allows to control the PC register and results in code execution. The same form of communication can be initiated by any process including an attacker process on the mobile phone or the desktop and this allows a third-party application on the device to execute commands on the device without any authentication by sending just 1 UDP packet with custom base64 encoding.",
    "score": 8.8,
    "severity": "HIGH",
    "cwe_id": "CWE-119",
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cpe_match": [
        "cpe:2.3:o:dlink:dcs-1130_firmware:-:*:*:*:*:*:*:*",
        "cpe:2.3:o:dlink:dcs-1100_firmware:-:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "technique_id": "T1003",
            "confidence": "2.4",
            "technique_name": "OS Credential Dumping"
        },
        {
            "technique_id": "T1057",
            "confidence": "2.2",
            "technique_name": "Process Discovery"
        },
        {
            "technique_id": "T1059",
            "confidence": "2.3",
            "technique_name": "Command and Scripting Interpreter"
        },
        {
            "technique_id": "T1068",
            "confidence": "2.5",
            "technique_name": "Exploitation for Privilege Escalation"
        },
        {
            "technique_id": "T1083",
            "confidence": "6.0",
            "technique_name": "File and Directory Discovery"
        },
        {
            "technique_id": "T1087",
            "confidence": "3.4",
            "technique_name": "Account Discovery"
        },
        {
            "technique_id": "T1123",
            "confidence": "4.2",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1204",
            "confidence": "4.9",
            "technique_name": "User Execution"
        },
        {
            "technique_id": "T1210",
            "confidence": "2.0",
            "technique_name": "Exploitation of Remote Services"
        },
        {
            "technique_id": "T1489",
            "confidence": "2.4",
            "technique_name": "Service Stop"
        },
        {
            "technique_id": "T1505.003",
            "confidence": "2.2",
            "technique_name": "Web Shell"
        },
        {
            "technique_id": "T1020",
            "confidence": "3.5",
            "technique_name": "Automated Exfiltration"
        },
        {
            "technique_id": "T1037",
            "confidence": "5.3",
            "technique_name": "Boot or Logon Initialization Scripts"
        },
        {
            "technique_id": "T1041",
            "confidence": "3.7",
            "technique_name": "Exfiltration Over C2 Channel"
        },
        {
            "technique_id": "T1048",
            "confidence": "4.8",
            "technique_name": "Exfiltration Over Alternative Protocol"
        },
        {
            "technique_id": "T1083",
            "confidence": "7.9",
            "technique_name": "File and Directory Discovery"
        },
        {
            "technique_id": "T1112",
            "confidence": "2.4",
            "technique_name": "Modify Registry"
        },
        {
            "technique_id": "T1123",
            "confidence": "3.8",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1125",
            "confidence": "5.4",
            "technique_name": "Video Capture"
        },
        {
            "technique_id": "T1203",
            "confidence": "4.0",
            "technique_name": "Exploitation for Client Execution"
        },
        {
            "technique_id": "T1210",
            "confidence": "2.8",
            "technique_name": "Exploitation of Remote Services"
        },
        {
            "technique_id": "T1486",
            "confidence": "11.3",
            "technique_name": "Data Encrypted for Impact"
        },
        {
            "technique_id": "T1489",
            "confidence": "3.5",
            "technique_name": "Service Stop"
        },
        {
            "technique_id": "T1498",
            "confidence": "2.5",
            "technique_name": "Network Denial of Service"
        },
        {
            "technique_id": "T1499",
            "confidence": "2.5",
            "technique_name": "Endpoint Denial of Service"
        },
        {
            "technique_id": "T1003",
            "confidence": "3.8",
            "technique_name": "OS Credential Dumping"
        },
        {
            "technique_id": "T1068",
            "confidence": "20.3",
            "technique_name": "Exploitation for Privilege Escalation"
        },
        {
            "technique_id": "T1123",
            "confidence": "19.6",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1210",
            "confidence": "34.6",
            "technique_name": "Exploitation of Remote Services"
        },
        {
            "technique_id": "T1489",
            "confidence": "3.5",
            "technique_name": "Service Stop"
        },
        {
            "technique_id": "T1105",
            "confidence": "23.4",
            "technique_name": "Ingress Tool Transfer"
        },
        {
            "technique_id": "T1115",
            "confidence": "4.0",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1129",
            "confidence": "3.2",
            "technique_name": "Shared Modules"
        },
        {
            "technique_id": "T1140",
            "confidence": "31.7",
            "technique_name": "Deobfuscate/Decode Files or Information"
        },
        {
            "technique_id": "T1219",
            "confidence": "7.1",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "2.7",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1007",
            "confidence": "2.2",
            "technique_name": "System Service Discovery"
        },
        {
            "technique_id": "T1021.002",
            "confidence": "2.1",
            "technique_name": "SMB/Windows Admin Shares"
        },
        {
            "technique_id": "T1033",
            "confidence": "2.1",
            "technique_name": "System Owner/User Discovery"
        },
        {
            "technique_id": "T1037",
            "confidence": "3.1",
            "technique_name": "Boot or Logon Initialization Scripts"
        },
        {
            "technique_id": "T1055",
            "confidence": "3.3",
            "technique_name": "Process Injection"
        },
        {
            "technique_id": "T1059",
            "confidence": "3.0",
            "technique_name": "Command and Scripting Interpreter"
        },
        {
            "technique_id": "T1133",
            "confidence": "2.3",
            "technique_name": "External Remote Services"
        },
        {
            "technique_id": "T1189",
            "confidence": "2.8",
            "technique_name": "Drive-by Compromise"
        },
        {
            "technique_id": "T1485",
            "confidence": "2.5",
            "technique_name": "Data Destruction"
        },
        {
            "technique_id": "T1489",
            "confidence": "2.1",
            "technique_name": "Service Stop"
        },
        {
            "technique_id": "T1574.002",
            "confidence": "2.6",
            "technique_name": "DLL Side-Loading"
        },
        {
            "technique_id": "T1608.002",
            "confidence": "2.2",
            "technique_name": "Upload Tool"
        },
        {
            "technique_id": "T1016",
            "confidence": "99.0",
            "technique_name": "System Network Configuration Discovery"
        },
        {
            "technique_id": "T1125",
            "confidence": "2.1",
            "technique_name": "Video Capture"
        },
        {
            "technique_id": "T1485",
            "confidence": "2.0",
            "technique_name": "Data Destruction"
        },
        {
            "technique_id": "T1489",
            "confidence": "2.0",
            "technique_name": "Service Stop"
        },
        {
            "technique_id": "T1003",
            "confidence": "2.9",
            "technique_name": "OS Credential Dumping"
        },
        {
            "technique_id": "T1007",
            "confidence": "3.5",
            "technique_name": "System Service Discovery"
        },
        {
            "technique_id": "T1033",
            "confidence": "3.1",
            "technique_name": "System Owner/User Discovery"
        },
        {
            "technique_id": "T1055",
            "confidence": "3.1",
            "technique_name": "Process Injection"
        },
        {
            "technique_id": "T1057",
            "confidence": "2.8",
            "technique_name": "Process Discovery"
        },
        {
            "technique_id": "T1082",
            "confidence": "2.3",
            "technique_name": "System Information Discovery"
        },
        {
            "technique_id": "T1125",
            "confidence": "2.8",
            "technique_name": "Video Capture"
        },
        {
            "technique_id": "T1134",
            "confidence": "4.7",
            "technique_name": "Access Token Manipulation"
        },
        {
            "technique_id": "T1485",
            "confidence": "2.7",
            "technique_name": "Data Destruction"
        },
        {
            "technique_id": "T1496",
            "confidence": "2.8",
            "technique_name": "Resource Hijacking"
        },
        {
            "technique_id": "T1499.004",
            "confidence": "3.3",
            "technique_name": "Application or System Exploitation"
        },
        {
            "technique_id": "T1552",
            "confidence": "3.1",
            "technique_name": "Unsecured Credentials"
        },
        {
            "technique_id": "T1554",
            "confidence": "2.5",
            "technique_name": "Compromise Client Software Binary"
        },
        {
            "technique_id": "T1556",
            "confidence": "2.1",
            "technique_name": "Modify Authentication Process"
        },
        {
            "technique_id": "T1561",
            "confidence": "2.3",
            "technique_name": "Disk Wipe"
        },
        {
            "technique_id": "T1563",
            "confidence": "3.0",
            "technique_name": "Remote Service Session Hijacking"
        },
        {
            "technique_id": "T1574.002",
            "confidence": "2.6",
            "technique_name": "DLL Side-Loading"
        },
        {
            "technique_id": "T1608.001",
            "confidence": "2.3",
            "technique_name": "Upload Malware"
        }
    ]
}
