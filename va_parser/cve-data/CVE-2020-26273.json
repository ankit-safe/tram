{
    "title": "osquery is a SQL powered operating system instrumentation, monitoring, and analytics framework. In osquery before version 4.6.0, by using sqlites ATTACH verb, someone with administrative access to osquery can cause reads and writes to arbitrary sqlite databases on disk. This _does_ allow arbitrary files to be created, but they will be sqlite databases. It does not appear to allow existing non-sqlite files to be overwritten. This has been patched in osquery 4.6.0. There are several mitigating factors and possible workarounds. In some deployments, the people with access to these interfaces may be considered administrators. In some deployments, configuration is managed by a central tool. This tool can filter for the `ATTACH` keyword. osquery can be run as non-root user. Because this also limits the desired access levels, this requires deployment specific testing and configuration.",
    "score": 5.2,
    "severity": "MEDIUM",
    "cwe_id": "CWE-77",
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N",
    "cpe_match": [
        "cpe:2.3:a:linuxfoundation:osquery:*:*:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "techniqueId": "T1106",
            "confidence": "10.2",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1123",
            "confidence": "14.1",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "2.2",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1190",
            "confidence": "6.2",
            "techniqueName": "Exploit Public-Facing Application"
        },
        {
            "techniqueId": "T1219",
            "confidence": "21.7",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "3.0",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.8",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1542.003",
            "confidence": "2.7",
            "techniqueName": "Bootkit"
        },
        {
            "techniqueId": "T1033",
            "confidence": "3.3",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "5.3",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.1",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1082",
            "confidence": "3.4",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.3",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.4",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.0",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "3.4",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.5",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1033",
            "confidence": "9.7",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1056",
            "confidence": "5.6",
            "techniqueName": "Input Capture"
        },
        {
            "techniqueId": "T1059",
            "confidence": "3.6",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1083",
            "confidence": "4.6",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1115",
            "confidence": "4.4",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "3.4",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1219",
            "confidence": "3.1",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "2.1",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1489",
            "confidence": "3.6",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1057",
            "confidence": "6.2",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "2.2",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "9.0",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "4.2",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "3.3",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "4.9",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "2.6",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1213",
            "confidence": "5.2",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1219",
            "confidence": "4.6",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "3.7",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.5",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1056.004",
            "confidence": "2.2",
            "techniqueName": "Credential API Hooking"
        },
        {
            "techniqueId": "T1057",
            "confidence": "4.7",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1069",
            "confidence": "2.3",
            "techniqueName": "Permission Groups Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "6.4",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "3.8",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "9.8",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "5.0",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1129",
            "confidence": "3.5",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1213",
            "confidence": "4.6",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1218",
            "confidence": "2.0",
            "techniqueName": "System Binary Proxy Execution"
        },
        {
            "techniqueId": "T1219",
            "confidence": "9.5",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "10.8",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.8",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "2.1",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1562.003",
            "confidence": "2.1",
            "techniqueName": "Impair Command History Logging"
        },
        {
            "techniqueId": "T1057",
            "confidence": "3.8",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "4.3",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "2.5",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "3.5",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.3",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "3.4",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1219",
            "confidence": "3.2",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "3.2",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1003",
            "confidence": "3.4",
            "techniqueName": "OS Credential Dumping"
        },
        {
            "techniqueId": "T1016",
            "confidence": "2.1",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "22.1",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.5",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "2.9",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.1",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "3.7",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "30.5",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1016",
            "confidence": "5.1",
            "techniqueName": "System Network Configuration Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "8.9",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "3.5",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "6.7",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "3.1",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1129",
            "confidence": "3.2",
            "techniqueName": "Shared Modules"
        },
        {
            "techniqueId": "T1201",
            "confidence": "3.4",
            "techniqueName": "Password Policy Discovery"
        },
        {
            "techniqueId": "T1219",
            "confidence": "6.2",
            "techniqueName": "Remote Access Software"
        },
        {
            "techniqueId": "T1482",
            "confidence": "5.3",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1518.001",
            "confidence": "9.0",
            "techniqueName": "Security Software Discovery"
        },
        {
            "techniqueId": "T1546.004",
            "confidence": "6.0",
            "techniqueName": "Unix Shell Configuration Modification"
        },
        {
            "techniqueId": "T1546.009",
            "confidence": "2.1",
            "techniqueName": "AppCert DLLs"
        },
        {
            "techniqueId": "T1033",
            "confidence": "8.3",
            "techniqueName": "System Owner/User Discovery"
        },
        {
            "techniqueId": "T1057",
            "confidence": "3.4",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1082",
            "confidence": "4.1",
            "techniqueName": "System Information Discovery"
        },
        {
            "techniqueId": "T1083",
            "confidence": "4.1",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1087",
            "confidence": "6.3",
            "techniqueName": "Account Discovery"
        },
        {
            "techniqueId": "T1106",
            "confidence": "3.7",
            "techniqueName": "Native API"
        },
        {
            "techniqueId": "T1115",
            "confidence": "2.8",
            "techniqueName": "Clipboard Data"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.4",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1482",
            "confidence": "2.2",
            "techniqueName": "Domain Trust Discovery"
        },
        {
            "techniqueId": "T1543",
            "confidence": "2.2",
            "techniqueName": "Create or Modify System Process"
        },
        {
            "techniqueId": "T1036",
            "confidence": "3.6",
            "techniqueName": "Masquerading"
        },
        {
            "techniqueId": "T1057",
            "confidence": "2.2",
            "techniqueName": "Process Discovery"
        },
        {
            "techniqueId": "T1059",
            "confidence": "2.7",
            "techniqueName": "Command and Scripting Interpreter"
        },
        {
            "techniqueId": "T1083",
            "confidence": "2.3",
            "techniqueName": "File and Directory Discovery"
        },
        {
            "techniqueId": "T1123",
            "confidence": "2.3",
            "techniqueName": "Audio Capture"
        },
        {
            "techniqueId": "T1213",
            "confidence": "6.2",
            "techniqueName": "Data from Information Repositories"
        },
        {
            "techniqueId": "T1222",
            "confidence": "3.1",
            "techniqueName": "File and Directory Permissions Modification"
        },
        {
            "techniqueId": "T1489",
            "confidence": "2.0",
            "techniqueName": "Service Stop"
        },
        {
            "techniqueId": "T1505.003",
            "confidence": "2.9",
            "techniqueName": "Web Shell"
        },
        {
            "techniqueId": "T1553.002",
            "confidence": "2.1",
            "techniqueName": "Code Signing"
        },
        {
            "techniqueId": "T1566.001",
            "confidence": "2.1",
            "techniqueName": "Spearphishing Attachment"
        }
    ]
}
