{
    "title": "On Juniper Networks PTX and QFX Series devices with packet sampling configured using tunnel-observation mpls-over-udp, sampling of a malformed packet can cause the Kernel Routing Table (KRT) queue to become stuck. KRT is the module within the Routing Process Daemon (RPD) that synchronized the routing tables with the forwarding tables in the kernel. This table is then synchronized to the Packet Forwarding Engine (PFE) via the KRT queue. Thus, when KRT queue become stuck, it can lead to unexpected packet forwarding issues. An administrator can monitor the following command to check if there is the KRT queue is stuck: user@device > show krt state ... Number of async queue entries: 65007 <--- this value keep on increasing. When this issue occurs, the following message might appear in the /var/log/messages: DATE DEVICE kernel: %KERN-3: rt_pfe_veto: Too many delayed route/nexthop unrefs. Op 2 err 55, rtsm_id 5:-1, msg type 2 DATE DEVICE kernel: %KERN-3: rt_pfe_veto: Memory usage of M_RTNEXTHOP type = (0) Max size possible for M_RTNEXTHOP type = (7297134592) Current delayed unref = (60000), Current unique delayed unref = (18420), Max delayed unref on this platform = (40000) Current delayed weight unref = (60000) Max delayed weight unref on this platform= (400000) curproc = rpd This issue affects Juniper Networks Junos OS on PTX/QFX Series: 17.2X75 versions prior to 17.2X75-D105; 18.1 versions prior to 18.1R3-S11; 18.2 versions prior to 18.2R3-S5; 18.2X75 versions prior to 18.2X75-D420, 18.2X75-D53, 18.2X75-D65; 18.3 versions prior to 18.3R2-S4, 18.3R3-S3; 18.4 versions prior to 18.4R1-S7, 18.4R2-S5, 18.4R3-S4; 19.1 versions prior to 19.1R2-S2, 19.1R3-S2; 19.2 versions prior to 19.2R1-S5, 19.2R3; 19.3 versions prior to 19.3R2-S3, 19.3R3; 19.4 versions prior to 19.4R1-S2, 19.4R2-S1, 19.4R3; 20.1 versions prior to 20.1R1-S2, 20.1R2. This issue does not affect Juniper Networks Junos OS prior to 18.1R1.",
    "score": 7.5,
    "severity": "HIGH",
    "cwe_id": "NVD-CWE-noinfo",
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cpe_match": [
        "cpe:2.3:o:juniper:junos:17.2x75:*:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:17.2x75:d50:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:17.2x75:d70:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:17.2x75:d102:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:17.2x75:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:17.2x75:d92:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r2-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r2-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r2-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r1-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2x75:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2x75:d20:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r1-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s6:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s7:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r1:-:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r1-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r1-s5:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2-s5:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r2-s6:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r3-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2x75:d40:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r1-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r1-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r1-s5:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r2-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r2-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r1-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r1-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r1-s5:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r2-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r1-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r1-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r1-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.2:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.2:r1-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.2:r1-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.3:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.3:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s10:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s8:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.1:r3-s9:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r3-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r3-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2:r3-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2x75:d12:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2x75:d30:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2x75:d411:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.2x75:d51:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r1-s6:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r2-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r3-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.3:r3-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r1-s6:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r2-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r2-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r2-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r3-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r3-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:18.4:r3-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r1-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r2-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.1:r3-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.2:-:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.2:r1-s3:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.2:r1-s4:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.3:r1-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.3:r2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.3:r2-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.3:r2-s2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.4:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.4:r1-s1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:19.4:r2:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:20.1:r1:*:*:*:*:*:*",
        "cpe:2.3:o:juniper:junos:20.1:r1-s1:*:*:*:*:*:*"
    ],
    "cve_source": [
        "NVD"
    ],
    "ttpMapping": [
        {
            "technique_id": "T1041",
            "confidence": "2.0",
            "technique_name": "Exfiltration Over C2 Channel"
        },
        {
            "technique_id": "T1048",
            "confidence": "2.5",
            "technique_name": "Exfiltration Over Alternative Protocol"
        },
        {
            "technique_id": "T1055",
            "confidence": "6.0",
            "technique_name": "Process Injection"
        },
        {
            "technique_id": "T1059",
            "confidence": "2.9",
            "technique_name": "Command and Scripting Interpreter"
        },
        {
            "technique_id": "T1113",
            "confidence": "2.9",
            "technique_name": "Screen Capture"
        },
        {
            "technique_id": "T1123",
            "confidence": "10.0",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1190",
            "confidence": "10.9",
            "technique_name": "Exploit Public-Facing Application"
        },
        {
            "technique_id": "T1204",
            "confidence": "2.1",
            "technique_name": "User Execution"
        },
        {
            "technique_id": "T1210",
            "confidence": "5.4",
            "technique_name": "Exploitation of Remote Services"
        },
        {
            "technique_id": "T1489",
            "confidence": "4.2",
            "technique_name": "Service Stop"
        },
        {
            "technique_id": "T1505.003",
            "confidence": "9.9",
            "technique_name": "Web Shell"
        },
        {
            "technique_id": "T1055",
            "confidence": "2.2",
            "technique_name": "Process Injection"
        },
        {
            "technique_id": "T1056.004",
            "confidence": "2.5",
            "technique_name": "Credential API Hooking"
        },
        {
            "technique_id": "T1057",
            "confidence": "17.8",
            "technique_name": "Process Discovery"
        },
        {
            "technique_id": "T1106",
            "confidence": "8.1",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1115",
            "confidence": "4.9",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1123",
            "confidence": "4.3",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1129",
            "confidence": "12.4",
            "technique_name": "Shared Modules"
        },
        {
            "technique_id": "T1219",
            "confidence": "6.4",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "2.9",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1546.010",
            "confidence": "2.6",
            "technique_name": "AppInit DLLs"
        },
        {
            "technique_id": "T1557.001",
            "confidence": "2.3",
            "technique_name": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "technique_id": "T1016",
            "confidence": "11.9",
            "technique_name": "System Network Configuration Discovery"
        },
        {
            "technique_id": "T1056",
            "confidence": "2.3",
            "technique_name": "Input Capture"
        },
        {
            "technique_id": "T1056.004",
            "confidence": "2.1",
            "technique_name": "Credential API Hooking"
        },
        {
            "technique_id": "T1069",
            "confidence": "2.2",
            "technique_name": "Permission Groups Discovery"
        },
        {
            "technique_id": "T1106",
            "confidence": "8.0",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1115",
            "confidence": "7.2",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1129",
            "confidence": "2.6",
            "technique_name": "Shared Modules"
        },
        {
            "technique_id": "T1201",
            "confidence": "3.6",
            "technique_name": "Password Policy Discovery"
        },
        {
            "technique_id": "T1218",
            "confidence": "2.6",
            "technique_name": "System Binary Proxy Execution"
        },
        {
            "technique_id": "T1219",
            "confidence": "19.4",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "6.6",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1542.003",
            "confidence": "2.4",
            "technique_name": "Bootkit"
        },
        {
            "technique_id": "T1546.004",
            "confidence": "3.4",
            "technique_name": "Unix Shell Configuration Modification"
        },
        {
            "technique_id": "T1546.006",
            "confidence": "3.1",
            "technique_name": "LC_LOAD_DYLIB Addition"
        },
        {
            "technique_id": "T1557.001",
            "confidence": "2.7",
            "technique_name": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "technique_id": "T1562.003",
            "confidence": "2.9",
            "technique_name": "Impair Command History Logging"
        },
        {
            "technique_id": "T1056",
            "confidence": "2.0",
            "technique_name": "Input Capture"
        },
        {
            "technique_id": "T1056.004",
            "confidence": "2.3",
            "technique_name": "Credential API Hooking"
        },
        {
            "technique_id": "T1057",
            "confidence": "2.1",
            "technique_name": "Process Discovery"
        },
        {
            "technique_id": "T1069",
            "confidence": "2.7",
            "technique_name": "Permission Groups Discovery"
        },
        {
            "technique_id": "T1087",
            "confidence": "2.5",
            "technique_name": "Account Discovery"
        },
        {
            "technique_id": "T1106",
            "confidence": "2.3",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1115",
            "confidence": "6.9",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1123",
            "confidence": "4.5",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1129",
            "confidence": "3.1",
            "technique_name": "Shared Modules"
        },
        {
            "technique_id": "T1201",
            "confidence": "2.8",
            "technique_name": "Password Policy Discovery"
        },
        {
            "technique_id": "T1218",
            "confidence": "2.8",
            "technique_name": "System Binary Proxy Execution"
        },
        {
            "technique_id": "T1219",
            "confidence": "6.9",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "5.4",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1489",
            "confidence": "2.5",
            "technique_name": "Service Stop"
        },
        {
            "technique_id": "T1542.003",
            "confidence": "2.5",
            "technique_name": "Bootkit"
        },
        {
            "technique_id": "T1546.004",
            "confidence": "2.6",
            "technique_name": "Unix Shell Configuration Modification"
        },
        {
            "technique_id": "T1546.006",
            "confidence": "2.3",
            "technique_name": "LC_LOAD_DYLIB Addition"
        },
        {
            "technique_id": "T1546.009",
            "confidence": "2.2",
            "technique_name": "AppCert DLLs"
        },
        {
            "technique_id": "T1546.010",
            "confidence": "2.6",
            "technique_name": "AppInit DLLs"
        },
        {
            "technique_id": "T1562.003",
            "confidence": "2.8",
            "technique_name": "Impair Command History Logging"
        },
        {
            "technique_id": "T1033",
            "confidence": "4.4",
            "technique_name": "System Owner/User Discovery"
        },
        {
            "technique_id": "T1057",
            "confidence": "2.8",
            "technique_name": "Process Discovery"
        },
        {
            "technique_id": "T1082",
            "confidence": "8.4",
            "technique_name": "System Information Discovery"
        },
        {
            "technique_id": "T1083",
            "confidence": "2.8",
            "technique_name": "File and Directory Discovery"
        },
        {
            "technique_id": "T1087",
            "confidence": "2.8",
            "technique_name": "Account Discovery"
        },
        {
            "technique_id": "T1106",
            "confidence": "3.9",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1115",
            "confidence": "2.3",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1219",
            "confidence": "2.7",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "2.1",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1557.001",
            "confidence": "3.1",
            "technique_name": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "technique_id": "T1056.004",
            "confidence": "2.3",
            "technique_name": "Credential API Hooking"
        },
        {
            "technique_id": "T1057",
            "confidence": "3.2",
            "technique_name": "Process Discovery"
        },
        {
            "technique_id": "T1069",
            "confidence": "2.9",
            "technique_name": "Permission Groups Discovery"
        },
        {
            "technique_id": "T1106",
            "confidence": "5.5",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1115",
            "confidence": "4.8",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1129",
            "confidence": "7.0",
            "technique_name": "Shared Modules"
        },
        {
            "technique_id": "T1201",
            "confidence": "2.9",
            "technique_name": "Password Policy Discovery"
        },
        {
            "technique_id": "T1218",
            "confidence": "3.1",
            "technique_name": "System Binary Proxy Execution"
        },
        {
            "technique_id": "T1219",
            "confidence": "8.8",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "5.8",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1542.003",
            "confidence": "2.7",
            "technique_name": "Bootkit"
        },
        {
            "technique_id": "T1546.004",
            "confidence": "2.5",
            "technique_name": "Unix Shell Configuration Modification"
        },
        {
            "technique_id": "T1546.006",
            "confidence": "2.7",
            "technique_name": "LC_LOAD_DYLIB Addition"
        },
        {
            "technique_id": "T1546.009",
            "confidence": "2.2",
            "technique_name": "AppCert DLLs"
        },
        {
            "technique_id": "T1546.010",
            "confidence": "3.0",
            "technique_name": "AppInit DLLs"
        },
        {
            "technique_id": "T1557.001",
            "confidence": "2.3",
            "technique_name": "LLMNR/NBT-NS Poisoning and SMB Relay"
        },
        {
            "technique_id": "T1562.003",
            "confidence": "2.4",
            "technique_name": "Impair Command History Logging"
        },
        {
            "technique_id": "T1106",
            "confidence": "5.6",
            "technique_name": "Native API"
        },
        {
            "technique_id": "T1113",
            "confidence": "2.1",
            "technique_name": "Screen Capture"
        },
        {
            "technique_id": "T1115",
            "confidence": "3.3",
            "technique_name": "Clipboard Data"
        },
        {
            "technique_id": "T1123",
            "confidence": "3.9",
            "technique_name": "Audio Capture"
        },
        {
            "technique_id": "T1219",
            "confidence": "3.4",
            "technique_name": "Remote Access Software"
        },
        {
            "technique_id": "T1482",
            "confidence": "3.2",
            "technique_name": "Domain Trust Discovery"
        },
        {
            "technique_id": "T1489",
            "confidence": "3.1",
            "technique_name": "Service Stop"
        },
        {
            "technique_id": "T1505.003",
            "confidence": "2.1",
            "technique_name": "Web Shell"
        },
        {
            "technique_id": "T1546.004",
            "confidence": "3.0",
            "technique_name": "Unix Shell Configuration Modification"
        }
    ]
}
